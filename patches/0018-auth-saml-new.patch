From 75f459060da29a3f1f44a923d8823c0f036ebf8b Mon Sep 17 00:00:00 2001
From: Nadav Kavalerchik <nadavkav@gmail.com>
Date: Wed, 11 Oct 2017 16:45:53 +0300
Subject: [PATCH 18/95] auth/saml (new)

---
 auth/saml/DBNewConnection.php                      |  17 +
 auth/saml/README.txt                               |  35 ++
 auth/saml/auth.php                                 | 652 +++++++++++++++++++++
 auth/saml/cli/sync_users.php                       | 118 ++++
 auth/saml/config.php                               | 436 ++++++++++++++
 auth/saml/course_mapping.php                       |  51 ++
 auth/saml/courses.php                              | 195 ++++++
 auth/saml/custom_hook.php                          | 179 ++++++
 auth/saml/error.php                                |  89 +++
 auth/saml/index.php                                | 240 ++++++++
 auth/saml/lang/en/auth_saml.php                    | 130 ++++
 auth/saml/lang/es/auth_saml.php                    | 122 ++++
 auth/saml/lang/es_es/auth_saml.php                 | 120 ++++
 auth/saml/lang/he/auth_saml.php                    | 130 ++++
 auth/saml/login.php                                | 193 ++++++
 auth/saml/logo.gif                                 | Bin 0 -> 5240 bytes
 auth/saml/moodle_auth_saml.txt                     | 154 +++++
 auth/saml/portal-login.jpg                         | Bin 0 -> 12940 bytes
 .../images/ui-bg_flat_0_aaaaaa_40x100.png          | Bin 0 -> 180 bytes
 .../images/ui-bg_flat_75_ffffff_40x100.png         | Bin 0 -> 178 bytes
 .../images/ui-bg_glass_55_fbf9ee_1x400.png         | Bin 0 -> 120 bytes
 .../images/ui-bg_glass_65_ffffff_1x400.png         | Bin 0 -> 105 bytes
 .../images/ui-bg_glass_75_dadada_1x400.png         | Bin 0 -> 111 bytes
 .../images/ui-bg_glass_75_e6e6e6_1x400.png         | Bin 0 -> 110 bytes
 .../images/ui-bg_glass_75_ffffff_1x400.png         | Bin 0 -> 107 bytes
 .../ui-bg_highlight-soft_75_cccccc_1x100.png       | Bin 0 -> 101 bytes
 .../images/ui-bg_inset-soft_95_fef1ec_1x100.png    | Bin 0 -> 123 bytes
 .../resources/images/ui-icons_222222_256x240.png   | Bin 0 -> 4369 bytes
 .../resources/images/ui-icons_2e83ff_256x240.png   | Bin 0 -> 4369 bytes
 .../resources/images/ui-icons_454545_256x240.png   | Bin 0 -> 4369 bytes
 .../resources/images/ui-icons_888888_256x240.png   | Bin 0 -> 4369 bytes
 .../resources/images/ui-icons_cd0a0a_256x240.png   | Bin 0 -> 4369 bytes
 auth/saml/resources/jquery-1.3.2.min.js            |  19 +
 auth/saml/resources/jquery-ui-1.7.2.custom.min.js  |  22 +
 auth/saml/resources/moodle_saml.css                |   7 +
 auth/saml/resources/moodle_saml.js                 |  70 +++
 auth/saml/resources/ui.core.css                    |  37 ++
 auth/saml/resources/ui.tabs.css                    |  11 +
 auth/saml/resources/ui.theme.css                   | 243 ++++++++
 auth/saml/roles.php                                | 170 ++++++
 auth/saml/saml_config.php                          |   1 +
 auth/saml/utils.php                                |  22 +
 auth/saml/version.php                              |   7 +
 43 files changed, 3470 insertions(+)
 create mode 100755 auth/saml/DBNewConnection.php
 create mode 100755 auth/saml/README.txt
 create mode 100755 auth/saml/auth.php
 create mode 100755 auth/saml/cli/sync_users.php
 create mode 100755 auth/saml/config.php
 create mode 100755 auth/saml/course_mapping.php
 create mode 100755 auth/saml/courses.php
 create mode 100755 auth/saml/custom_hook.php
 create mode 100755 auth/saml/error.php
 create mode 100755 auth/saml/index.php
 create mode 100755 auth/saml/lang/en/auth_saml.php
 create mode 100755 auth/saml/lang/es/auth_saml.php
 create mode 100755 auth/saml/lang/es_es/auth_saml.php
 create mode 100755 auth/saml/lang/he/auth_saml.php
 create mode 100755 auth/saml/login.php
 create mode 100755 auth/saml/logo.gif
 create mode 100755 auth/saml/moodle_auth_saml.txt
 create mode 100755 auth/saml/portal-login.jpg
 create mode 100755 auth/saml/resources/images/ui-bg_flat_0_aaaaaa_40x100.png
 create mode 100755 auth/saml/resources/images/ui-bg_flat_75_ffffff_40x100.png
 create mode 100755 auth/saml/resources/images/ui-bg_glass_55_fbf9ee_1x400.png
 create mode 100755 auth/saml/resources/images/ui-bg_glass_65_ffffff_1x400.png
 create mode 100755 auth/saml/resources/images/ui-bg_glass_75_dadada_1x400.png
 create mode 100755 auth/saml/resources/images/ui-bg_glass_75_e6e6e6_1x400.png
 create mode 100755 auth/saml/resources/images/ui-bg_glass_75_ffffff_1x400.png
 create mode 100755 auth/saml/resources/images/ui-bg_highlight-soft_75_cccccc_1x100.png
 create mode 100755 auth/saml/resources/images/ui-bg_inset-soft_95_fef1ec_1x100.png
 create mode 100755 auth/saml/resources/images/ui-icons_222222_256x240.png
 create mode 100755 auth/saml/resources/images/ui-icons_2e83ff_256x240.png
 create mode 100755 auth/saml/resources/images/ui-icons_454545_256x240.png
 create mode 100755 auth/saml/resources/images/ui-icons_888888_256x240.png
 create mode 100755 auth/saml/resources/images/ui-icons_cd0a0a_256x240.png
 create mode 100755 auth/saml/resources/jquery-1.3.2.min.js
 create mode 100755 auth/saml/resources/jquery-ui-1.7.2.custom.min.js
 create mode 100755 auth/saml/resources/moodle_saml.css
 create mode 100755 auth/saml/resources/moodle_saml.js
 create mode 100755 auth/saml/resources/ui.core.css
 create mode 100755 auth/saml/resources/ui.tabs.css
 create mode 100755 auth/saml/resources/ui.theme.css
 create mode 100755 auth/saml/roles.php
 create mode 100755 auth/saml/saml_config.php
 create mode 100755 auth/saml/utils.php
 create mode 100755 auth/saml/version.php

diff --git a/auth/saml/DBNewConnection.php b/auth/saml/DBNewConnection.php
new file mode 100755
index 0000000..014d6fe
--- /dev/null
+++ b/auth/saml/DBNewConnection.php
@@ -0,0 +1,17 @@
+<?php
+function DBNewConnection($dsn) {
+    global $CFG;
+    require_once ($CFG->libdir.'/adodb/adodb.inc.php');
+
+    $cdata = explode('://', $dsn);
+    $scheme = $cdata[0];
+
+    if ($scheme === 'sqlite') {
+        $path = $cdata[1];
+        $mapping_db = ADONewConnection('sqlite');
+        $conn = $mapping_db->PConnect($path);
+    } else {
+        $mapping_db = ADONewConnection($dsn);
+    }
+    return $mapping_db;
+}
diff --git a/auth/saml/README.txt b/auth/saml/README.txt
new file mode 100755
index 0000000..5d6c3a1
--- /dev/null
+++ b/auth/saml/README.txt
@@ -0,0 +1,35 @@
+SAML Authentication for Moodle
+-------------------------------------------------------------------------------
+license: http://www.gnu.org/copyleft/gpl.html GNU Public License
+
+Changes:
+- 2008-10    : Created by Ny Media AS
+- 2008-11-03 : Updated by Ny Media AS
+- 2009-07-29 : added configuration options for sslib path and config path
+               tightened up the session switching between ss and moodle
+               Piers Harding <piers@catalyst.net.nz>
+- 2010-11    : Rewrited by Yaco Sistemas.
+- 2011-17    : Maintained by Sixto Martin Garcia <sixto.martin.garcia@gmail.com>
+
+Requirements:
+- simpleSAMLphp (http://rnd.feide.no/simplesamlphp).
+
+Optional:
+- SAML Enrollment for Moodle module (if want to support enrolment on course based on SAML attributes)
+
+
+Notes:
+- This plugin add SAML support to Moodle enabling a Service Provider using simpleSAMLphp endpoints.
+- Uses IdP attribute "eduPersonPrincipalName" as username by default
+
+Install instructions:
+
+Check moodle_auth_saml.txt
+
+
+Important for enrollment!!
+==========================
+
+This plugin suppose that the IdP send the courses data of the user in a attribute that can be configured but the pattern of the expected data is defined per the [RFC](https://tools.ietf.org/html/rfc6338)
+urn:mace:terena.org:schac:userStatus:<country>:<domain>:<course_id>:<period>:<role>:<status>
+You can change this pattern editing the saml_hook_get_course_info method from the custom_hook.php file.
diff --git a/auth/saml/auth.php b/auth/saml/auth.php
new file mode 100755
index 0000000..11c0e58
--- /dev/null
+++ b/auth/saml/auth.php
@@ -0,0 +1,652 @@
+<?php
+/**
+ * @author Erlend Strømsvik - Ny Media AS
+ * @license http://www.gnu.org/copyleft/gpl.html GNU Public License
+ * @package auth/saml
+ * @version 1.0
+ *
+ * Authentication Plugin: SAML based SSO Authentication
+ *
+ * Authentication using SAML2 with SimpleSAMLphp.
+ *
+ * Based on plugins made by Sergio Gómez (moodle_ssp) and Martin Dougiamas (Shibboleth).
+ *
+ * 2008-10  Created
+ * 2009-07  added new configuration options.  Tightened up the session handling
+**/
+
+if (!defined('MOODLE_INTERNAL')) {
+    die('Direct access to this script is forbidden.'); //  It must be included from a Moodle page
+}
+
+require_once($CFG->libdir.'/authlib.php');
+
+/**
+ * SimpleSAML authentication plugin.
+**/
+class auth_plugin_saml extends auth_plugin_base {
+
+    /**
+    * Constructor.
+    */
+    function __construct() {
+		$this->authtype = 'saml';
+		$this->config = get_config('auth/saml');
+    }
+
+    /**
+    * Returns true if the username and password work and false if they are
+    * wrong or don't exist.
+    *
+    * @param string $username The username (with system magic quotes)
+    * @param string $password The password (with system magic quotes)
+    * @return bool Authentication success or failure.
+    */
+    function user_login($username, $password) {
+        global $SESSION;
+	    // if true, user_login was initiated by saml/index.php
+	    if(isset($SESSION->auth_saml_login) && $SESSION->auth_saml_login) {
+	        unset($SESSION->auth_saml_login);
+	        return TRUE;
+	    }
+
+	    return FALSE;
+    }
+
+
+    /**
+    * Returns the user information for 'external' users. In this case the
+    * attributes provided by Identity Provider
+    *
+    * @return array $result Associative array of user data
+    */
+    function get_userinfo($username) {
+        global $SESSION;
+	    if($login_attributes = $SESSION->auth_saml_login_attributes) {
+	        $attributemap = $this->get_attributes();
+	        $result = array();
+
+	        foreach ($attributemap as $key => $value) {
+		        if(isset($login_attributes[$value]) && $attribute = $login_attributes[$value][0]) {
+		            $result[$key] = $attribute;
+		        } else {
+		            $result[$key] = '';
+		        }
+	        }
+
+	        unset($SESSION->auth_saml_login_attributes);
+
+	        $result["username"] = $username;
+	        return $result;
+	    }
+
+	    return FALSE;
+    }
+
+    /*
+    * Returns array containg attribute mappings between Moodle and Identity Provider.
+    */
+    function get_attributes() {
+        $configarray = (array) $this->config;
+
+        if(isset($this->userfields)) {
+            $fields = $this->userfields;
+        }
+        else {
+            $fields = array("firstname", "lastname", "email", "phone1", "phone2",
+			    "department", "address", "city", "country", "description",
+			    "idnumber", "lang", "guid", "web", "skype", "yahoo", "msn",
+                            "aim", "icq");
+        }
+
+        $fields = array_merge($fields, $this->get_custom_user_profile_fields());
+
+        $moodleattributes = array();
+        foreach ($fields as $field) {
+            if (isset($configarray["field_map_$field"])) {
+	        $moodleattributes[$field] = $configarray["field_map_$field"];
+            }
+        }
+
+        return $moodleattributes;
+    }
+
+    /**
+    * Returns true if this authentication plugin is 'internal'.
+    *
+    * @return bool
+    */
+    function is_internal() {
+	    return false;
+    }
+
+    /**
+    * Returns true if this authentication plugin can change the user's
+    * password.
+    *
+    * @return bool
+    */
+    function can_change_password() {
+	    return false;
+    }
+
+    function pre_loginpage_hook() {
+        // If Force Login is on then we can safely jump directly to the SAML IdP
+        if (isset($this->config->autologin) && $this->config->autologin) {
+            global $CFG, $SESSION;
+            $samlurl = $CFG->wwwroot.'/auth/saml/index.php?wantsurl=' . urlencode($SESSION->wantsurl);
+            redirect($samlurl);
+        }
+    }
+
+    function loginpage_hook() {
+	    global $CFG;
+
+        if (empty($CFG->alternateloginurl) && !(isset($_GET['saml']) && $_GET['saml'] === 'false')) {
+            $CFG->alternateloginurl = $CFG->wwwroot.'/auth/saml/login.php';
+        }
+
+	    // Prevent username from being shown on login page after logout
+	    $CFG->nolastloggedin = true;
+    }
+
+    function logoutpage_hook() {
+        global $CFG;
+
+	    if(isset($this->config->dosinglelogout) && $this->config->dosinglelogout) {
+	        set_moodle_cookie('nobody');
+	        require_logout();
+	        redirect($CFG->wwwroot.'/auth/saml/index.php?logout=1');
+	    }
+    }
+
+    /**
+    * Prints a form for configuring this authentication plugin.
+    *
+    * This function is called from admin/auth.php, and outputs a full page with
+    * a form for configuring this plugin.
+    *
+    * @param array $page An object containing all the data for this page.
+    */
+
+    function config_form($config, $err, $user_fields) {
+	    global $CFG, $DB;
+
+        $dbman = $DB->get_manager();
+
+        $table_course_mapping = $this->get_course_mapping_xmldb();
+        $table_role_mapping = $this->get_role_mapping_xmldb();        
+
+	    if(isset($config->supportcourses) &&  $config->supportcourses == 'internal') {
+	        if(!$dbman->table_exists($table_course_mapping)) {
+		        $this->create_course_mapping_db($DB, $err);
+	        }
+	        if(!$dbman->table_exists($table_role_mapping)) {
+		        $this->create_role_mapping_db($DB, $err);
+	        }
+	    }
+
+	    $course_mapping = array();
+	    $role_mapping = array();
+	    if($dbman->table_exists($table_course_mapping)) {
+	        require_once ($CFG->dirroot . "/auth/saml/courses.php");
+	        $course_mapping = get_course_mapping($DB, $err);
+	    }
+	    if($dbman->table_exists($table_role_mapping)) {
+	        require_once ($CFG->dirroot . "/auth/saml/roles.php");
+	        $role_mapping = get_role_mapping($DB, $err);
+	    }
+	    require_once ($CFG->dirroot . "/auth/saml/config.php");
+    }
+
+    /**
+     * A chance to validate form data, and last chance to
+     * do stuff before it is inserted in config_plugin
+     */
+    function validate_form($form, &$err) {
+
+	    if(!isset($form->auth_saml_db_reset) && !isset($form->initialize_roles)) {
+	        if (!isset ($form->samllib) || !file_exists($form->samllib.'/_autoload.php')) {
+		        $err['samllib'] = get_string('auth_saml_errorbadlib', 'auth_saml', $form->samllib);
+	        }
+
+            include_once("utils.php");
+            if (isset($form->samlhookfile) && $form->samlhookfile != '' && !file_exists(resolve_samlhookfile($form->samlhookfile))) {
+		        $err['samlhookerror'] = get_string('auth_saml_errorbadhook', 'auth_saml', resolve_samlhookfile($form->samlhookfile));
+	        }
+
+	        if ($form->supportcourses == 'external') {
+		        if ($form->externalcoursemappingdsn == '' || $form->externalcoursemappingsql == '' || $form->externalrolemappingdsn == '' || $form->externalrolemappingsql == '') {   
+		            $err['samlexternal'] = get_string('auth_saml_errorsamlexternal', 'auth_saml', $form->samllib);
+		        }		 
+	        }
+	        else if($form->supportcourses == 'internal') {
+
+		        if(!isset($form->deletecourses)) {
+		            $lms_course_form_id = array();
+		            $saml_course_form_id = array();
+		            if (isset($form->update_courses_id)) {
+			            foreach ($form->update_courses_id as $course_id) {
+			                $course = $form->{'course_' . $course_id};
+			                if (!empty($course[1]) && !empty($course[2])) {			    
+				                $lms_course_form_id[$course_id] = $course[0];
+				                $saml_course_form_id[$course_id] = $course[1] . '_' . $course[2];
+			                }
+			                else {
+				                $err['missed_course_mapping'][$course_id] = $course[0];
+			                }
+			            }
+		            }
+		            if (isset($form->new_courses_total)) {
+			            for ($i = 0; $i <= $form->new_courses_total; $i++) {
+			                $new_course = $form->{'new_course' . $i};
+			                if (!empty($new_course[1]) && !empty($new_course[2])) {
+				                $lms_course_form_id[$i] = $new_course[0];
+				                $saml_course_form_id[$i] = $new_course[1] . '_' . $new_course[2];
+			                }
+			            }		 
+		            }
+		            //Comment the next line if you want let duplicate lms mapping
+		            $err['course_mapping']['lms'] = array_diff_key($lms_course_form_id, array_unique($lms_course_form_id));
+
+		            $err['course_mapping']['saml'] = array_diff_key($saml_course_form_id, array_unique($saml_course_form_id));
+		            if (empty($err['course_mapping']['lms']) && empty($err['course_mapping']['saml'])) {
+			            unset($err['course_mapping']);
+		            }
+		        }
+
+		        if(!isset($form->deleteroles)) {
+		            $lms_role_form_id = array();
+		            $saml_role_form_id = array();
+		            if (isset($form->update_roles_id)) {
+			        foreach ($form->update_roles_id as $role_id) {
+			            $role = $form->{'role_' . $role_id};
+			            if (!empty($role[0]) && !empty($role[1])) {
+				            $lms_role_form_id[] = $role[0];
+				            $saml_role_form_id[] = $role[1];
+			            }
+			            else {
+				            if(!isset($form->deleteroles)) {
+				                $err['missed_role_mapping'][$role_id] = $role[0];
+				            }
+			            }
+			        }
+		            }
+		            if (isset($form->new_roles_total)) {
+			            for ($i=0; $i <= $form->new_roles_total; $i++) {
+			                $new_course = $form->{'new_role' . $i};
+			                if (!empty($new_role[1])) {
+				                $lms_role_form_id[] = $new_role[0];
+				                $saml_role_form_id[] = $new_role[1];
+			                }
+			            }
+		            }
+		            //$err['role_mapping']['lms'] = array_diff_key($lms_role_form_id, array_unique($lms_role_form_id));
+		            $err['role_mapping']['saml'] = array_diff_key($saml_role_form_id, array_unique($saml_role_form_id));
+		        }
+
+		        if (empty($err['role_mapping']['lms']) && empty($err['role_mapping']['saml'])) {
+		            unset($err['role_mapping']);
+		        }
+            }
+	    }
+    }
+
+    /**
+    * Processes and stores configuration data for this authentication plugin.
+    *
+    *
+    * @param object $config Configuration object
+    */
+    function process_config($config) {
+        global $err, $DB, $CFG;
+
+        $dbman = $DB->get_manager();
+
+	    if(isset($config->auth_saml_db_reset)) {
+	        $sql = "DELETE FROM ".$CFG->prefix."config_plugins WHERE plugin = 'auth/saml'";
+            try {
+	            $DB->execute($sql);
+            }
+            catch (Exception $e) {
+                $err['reset'] = get_string("auth_saml_db_reset_error", "auth_saml");
+		        return false;
+	        }
+	        header('Location: ' . $CFG->wwwroot . '/admin/auth_config.php?auth=saml');
+	        exit();
+	    }
+
+	    if(isset($config->initialize_roles)) {
+	        global $CFG;
+	        $this->initialize_roles($DB, $err);
+	        header('Location: ' . $CFG->wwwroot . '/admin/auth_config.php?auth=saml#rolemapping');
+	        exit();
+	    }
+
+        // SAML parameters are in the config variable due all form data is there.
+        // We create a new variable and set the values there.
+        $saml_param = new stdClass();
+
+	    if (!isset ($config->samllib)) {
+	        $saml_param->samllib = '';
+	    }
+        else {
+            $saml_param->samllib = $config->samllib;
+        }
+	    if (!isset ($config->sp_source)) {
+	        $saml_param->sp_source = 'saml';
+	    }
+        else {
+            $saml_param->sp_source = $config->sp_source;
+        }
+	    if (!isset ($config->dosinglelogout)) {
+	        $saml_param->dosinglelogout = false;
+	    }
+        else {
+            $saml_param->dosinglelogout = $config->dosinglelogout;
+        }
+
+	    // set to defaults if undefined
+	    if (!isset ($config->username)) {
+	        $config->username = 'eduPersonPrincipalName';
+	    }
+        if (!isset ($config->supportcourses)) {
+	        $config->supportcourses = 'nosupport';
+	    }
+	    if (!isset ($config->syncusersfrom)) {
+	        $config->syncusersfrom = '';
+	    }
+	    if (!isset ($config->samlcourses)) {
+	        $config->samlcourses = 'schacUserStatus';
+	    }
+	    if (!isset ($config->samllogoimage) || $config->samllogoimage == NULL) {
+	        //$config->samllogoimage = 'logo.gif';
+	        $config->samllogoimage = 'portal-login.jpg';
+	    }
+	    if (!isset ($config->samllogoinfo)) {
+	        $config->samllogoinfo = '';//'SAML login';
+	    }
+	    if (!isset ($config->autologin)) { 
+            $config->autologin = false; 
+        }
+	    if (!isset ($config->samllogfile)) {
+	        $config->samllogfile = '';
+	    }
+        if (!isset ($config->samlhookfile)) {
+            $config->samlhookfile = $CFG->dirroot . '/auth/saml/custom_hook.php';
+        }
+	    if (!isset ($config->moodlecoursefieldid)) {
+	        $config->moodlecoursefieldid = 'shortname';
+	    }
+	    if (!isset ($config->ignoreinactivecourses)) {
+	        $config->ignoreinactivecourses = '';
+	    }
+	    if (!isset ($config->externalcoursemappingdsn)) {
+	        $config->externalcoursemappingdsn = ''; 
+	    }
+	    if (!isset ($config->externalrolemappingdsn)) {
+	        $config->externalrolemappingdsn = ''; 
+	    }
+	    if (!isset ($config->externalcoursemappingsql)) {
+	        $config->externalcoursemappingsql = ''; 
+	    }
+	    if (!isset ($config->externalrolemappingsql)) {
+	        $config->externalrolemappingsql = ''; 
+	    }
+            if (!isset ($config->disablejit)) {
+                $config->disablejit = false;
+            }
+
+        // Save saml settings in a file
+    	$saml_param_encoded = json_encode($saml_param);
+        file_put_contents($CFG->dataroot.'/saml_config.php', $saml_param_encoded);
+
+        // Also adding this parameters in database but no need it really.
+	    set_config('samllib',	      $saml_param->samllib,	'auth/saml');
+	    set_config('sp_source',  $saml_param->sp_source,	'auth/saml');
+	    set_config('dosinglelogout',  $saml_param->dosinglelogout,	'auth/saml');
+
+        // Save plugin settings
+	    set_config('username',	      $config->username,	'auth/saml');
+	    set_config('supportcourses',  $config->supportcourses,	'auth/saml');
+	    set_config('syncusersfrom',   $config->syncusersfrom,	'auth/saml');
+	    set_config('samlcourses',     $config->samlcourses,	'auth/saml');
+	    set_config('samllogoimage',   $config->samllogoimage,	'auth/saml');
+	    set_config('samllogoinfo',    $config->samllogoinfo,	'auth/saml');
+	    set_config('autologin',       $config->autologin,  'auth/saml');
+	    set_config('samllogfile',         $config->samllogfile,	'auth/saml');
+	    set_config('samlhookfile',        $config->samlhookfile,	'auth/saml');
+	    set_config('moodlecoursefieldid',   $config->moodlecoursefieldid,   'auth/saml');
+	    set_config('ignoreinactivecourses', $config->ignoreinactivecourses, 'auth/saml');
+            set_config('disablejit', $config->disablejit, 'auth/saml');
+
+	    if($config->supportcourses == 'external') {
+	        set_config('externalcoursemappingdsn',  $config->externalcoursemappingdsn,	'auth/saml');
+	        set_config('externalrolemappingdsn',    $config->externalrolemappingdsn,	'auth/saml');
+	        set_config('externalcoursemappingsql',  $config->externalcoursemappingsql,	'auth/saml');
+	        set_config('externalrolemappingsql',    $config->externalrolemappingsql,	'auth/saml');
+	    }
+	    else if($config->supportcourses == 'internal') {
+
+            $table_course_mapping = $this->get_course_mapping_xmldb();
+            $table_role_mapping = $this->get_role_mapping_xmldb();
+
+	        if(!$dbman->table_exists($table_course_mapping)) {
+                $this->create_course_mapping_db($DB, $err);
+		    }
+	        if(!$dbman->table_exists($table_role_mapping)) {
+                $this->create_role_mapping_db($DB, $err);
+		    }
+
+		    //COURSE MAPPINGS
+		    //Delete mappings
+		    if (isset($config->deletecourses)) {
+		        if(isset($config->course_mapping_id)) {
+			        foreach ($config->course_mapping_id as $course => $value) {
+			            $sql = "DELETE FROM ".$DB->get_prefix() ."course_mapping WHERE course_mapping_id='". $value ."'";
+			            try {
+                            $DB->execute($sql);
+                        }
+                        catch (Exception $e) {
+				            $err['course_mapping_db'][] = get_string("auth_saml_error_executing", "auth_saml").$sql;
+			            }
+			        }
+		        }
+		    } else {
+		        //Update mappings
+		        if (isset($config->update_courses_id) && empty($err['course_mapping'])) {
+			        foreach($config->update_courses_id as $course_id) {
+			            $course = $config->{'course_' . $course_id};
+			            $sql = "UPDATE ".$DB->get_prefix() ."course_mapping SET lms_course_id='".$course[0]."', saml_course_id='".$course[1]."', saml_course_period='".$course[2]."' where course_mapping_id='". $course_id ."'";
+                        try {
+    			            $DB->execute($sql);
+                        }
+                        catch (Exception $e) {
+				            $err['course_mapping_db'][] = get_string("auth_saml_error_executing", "auth_saml").$sql;
+			            }
+			        }
+		        }
+
+		        //New courses mapping
+		        if (isset($config->new_courses_total) && empty($err['course_mapping'])) {
+			        for ($i = 0; $i <= $config->new_courses_total; $i++) {
+			            $new_course = $config->{'new_course' . $i};
+			            if (!empty($new_course[1]) && !empty($new_course[2])) {
+				            $sql = "INSERT INTO ".$DB->get_prefix() ."course_mapping (lms_course_id, saml_course_id, saml_course_period) values('".$new_course[0]."', '".$new_course[1]."', '".$new_course[2]."')";
+                            try {
+        			            $DB->execute($sql);
+                            }
+                            catch (Exception $e) {
+				                $err['course_mapping_db'][] = get_string("auth_saml_error_executing", "auth_saml").$sql;
+				            }
+			            }
+			        }
+		        }
+		    }
+		    //END-COURSE MAPPINGS
+
+		    //ROLE MAPPINGS
+		    //Deleting roles
+		    if (isset($config->deleteroles)) {
+		        if(isset($config->role_mapping_id)) {
+     		        foreach ($config->role_mapping_id as $role => $value) {
+			            $sql = "DELETE FROM ".$DB->get_prefix() ."role_mapping WHERE saml_role='" . $value . "'";
+                        try {
+    			            $DB->execute($sql);
+                        }
+                        catch (Exception $e) {
+			                $err['role_mapping_db'][] = get_string("auth_saml_error_executing", "auth_saml").$sql;
+			            }
+			        }
+		        }
+		    } 
+            else {
+		        //Updating roles
+		        if (isset($config->update_roles_id) && empty($err['roles_mapping'])) {
+			        foreach($config->update_roles_id as $role_id) {
+			            $role = $config->{'role_' . $role_id};
+			            $sql = "UPDATE ".$DB->get_prefix() ."role_mapping SET lms_role='" . $role[0] . "', saml_role='" . $role[1] . "' where saml_role='" . $role_id . "'"; 
+                        try {
+    			            $DB->execute($sql);
+                        }
+                        catch (Exception $e) {
+				            $err['role_mapping_db'][] = get_string("auth_saml_error_executing", "auth_saml").$sql;
+			            }
+			        }
+		        }
+		        //New roles mapping
+		        if (isset($config->new_roles_total) && empty($err['roles_mapping'])) {
+			        for ($i = 0; $i <= $config->new_roles_total; $i++) {
+			            $new_role = $config->{'new_role' . $i};
+			            if (!empty($new_role[0]) && !empty($new_role[1])) {
+				            $sql = "INSERT INTO ".$DB->get_prefix() ."role_mapping (lms_role, saml_role) values('".$new_role[0]."', '".$new_role[1]."')";
+                            try {
+        			            $DB->execute($sql);
+                            }
+                            catch (Exception $e) {
+				                $err['role_mapping_db'][] = get_string("auth_saml_error_executing", "auth_saml").$sql;
+				            }
+			            }
+			        }
+		        }
+		    }
+
+		    if(isset($err['role_mapping_db']) || isset($err['course_mapping_db'])) {
+		        return false;
+		    }
+	
+		    //END-COURSE MAPPINGS
+	    }
+	    return true;
+    }
+
+    /**
+    * Cleans and returns first of potential many values (multi-valued attributes)
+    *
+    * @param string $string Possibly multi-valued attribute from Identity Provider
+    */
+    function get_first_string($string) {
+	    $list = split( ';', $string);
+	    $clean_string = trim($list[0]);
+
+	    return $clean_string;
+    }
+
+
+  /**
+    * Create course_mapping table in Moodle database.
+    *
+    */
+    function create_course_mapping_db($DB, &$err) {
+
+        $table = $this->get_course_mapping_xmldb();
+
+        $sucess = false;
+        try {
+            $dbman = $DB->get_manager();
+            $dbman->create_table($table);
+	        echo '<span class="notifysuccess">';
+	        print_string("auth_saml_sucess_creating_course_mapping", "auth_saml");
+	        echo '</span><br>';
+            $sucess = true;
+        }
+        catch (Exception $e) {
+            $err['course_mapping_db'][] = get_string("auth_saml_error_creating_course_mapping", "auth_saml");
+        }
+        return $sucess;
+    }
+
+    /**
+    * Create role_mapping table in Moodle database.
+    *
+    */
+    function create_role_mapping_db($DB, &$err) {
+
+        $table = $this->get_role_mapping_xmldb();
+
+        $sucess = false;
+        try {
+            $dbman = $DB->get_manager();
+            $dbman->create_table($table);
+	        echo '<span class="notifysuccess">';
+	        print_string("auth_saml_sucess_creating_role_mapping", "auth_saml");
+	        echo '</span><br>';	
+        }
+        catch (Exception $e) {
+	        $err['role_mapping_db'][] = get_string("auth_saml_error_creating_role_mapping", "auth_saml");
+        }
+        return $sucess;
+    }
+
+    function get_course_mapping_xmldb() {
+
+        $table = new xmldb_table('course_mapping');   
+
+        $table->add_field('course_mapping_id', XMLDB_TYPE_INTEGER, '10', XMLDB_UNSIGNED, XMLDB_NOTNULL, XMLDB_SEQUENCE, null, null);
+		$table->add_field('saml_course_id', XMLDB_TYPE_CHAR, '100', null, XMLDB_NOTNULL, null, null, null);
+		$table->add_field('saml_course_period', XMLDB_TYPE_CHAR, '20', null, XMLDB_NOTNULL, null, null, null);
+		$table->add_field('lms_course_id', XMLDB_TYPE_CHAR, '100', null, XMLDB_NOTNULL, null, null, null);
+
+        $table->add_key('primary', XMLDB_KEY_PRIMARY, array('course_mapping_id'));
+
+        return $table;
+    }
+
+    function get_role_mapping_xmldb() {
+        $table = new xmldb_table('role_mapping');
+
+		$table->add_field('saml_role', XMLDB_TYPE_CHAR, '50', null, XMLDB_NOTNULL, null, null, null);
+		$table->add_field('lms_role', XMLDB_TYPE_CHAR, '50', null, XMLDB_NOTNULL, null, null, null);
+
+        $table->add_key('primary', XMLDB_KEY_PRIMARY, array('saml_role'));
+
+        return $table;
+    }
+
+
+    function initialize_roles($DB, &$err) {
+
+	    $sqls = array();
+	    $sqls[] = "DELETE FROM role_mapping;";
+	    $sqls[] = "INSERT INTO role_mapping (lms_role, saml_role) values ('editingteacher','teacher')";
+	    $sqls[] = "INSERT INTO role_mapping (lms_role, saml_role) values ('editingteacher','instructor')";
+	    $sqls[] = "INSERT INTO role_mapping (lms_role, saml_role) values ('editingteacher','mentor')";
+	    $sqls[] = "INSERT INTO role_mapping (lms_role, saml_role) values ('student','student')";
+	    $sqls[] = "INSERT INTO role_mapping (lms_role, saml_role) values ('student','learner')";
+	    $sqls[] = "INSERT INTO role_mapping (lms_role, saml_role) values ('user','member')";
+	    $sqls[] = "INSERT INTO role_mapping (lms_role, saml_role) values ('admin','admin')";
+
+        $sucess = true;
+	    foreach($sqls as $sql) {
+            try {
+	            $DB->execute($sql);
+            }
+            catch (Exception $e) {
+    		    $err['role_mapping_db'][] = get_string("auth_saml_error_creating_role_mapping", "auth_saml");
+                $sucess = false;
+    		    break;
+	        }
+	    }
+	    return $sucess;
+    }	   
+}
diff --git a/auth/saml/cli/sync_users.php b/auth/saml/cli/sync_users.php
new file mode 100755
index 0000000..d3ca46f
--- /dev/null
+++ b/auth/saml/cli/sync_users.php
@@ -0,0 +1,118 @@
+<?php
+// This file is part of Moodle - http://moodle.org/
+//
+// Moodle is free software: you can redistribute it and/or modify
+// it under the terms of the GNU General Public License as published by
+// the Free Software Foundation, either version 3 of the License, or
+// (at your option) any later version.
+//
+// Moodle is distributed in the hope that it will be useful,
+// but WITHOUT ANY WARRANTY; without even the implied warranty of
+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+// GNU General Public License for more details.
+//
+// You should have received a copy of the GNU General Public License
+// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
+
+/**
+ * SAML user sync script.
+ *
+ * This script is meant to be called from a cronjob to sync moodle with a
+ * selected. Users cannot be synced from SAML, but can be synched from 
+ * for example an external database or from LDAP. By using this script,
+ * user data will be fetched from the external source, but users will
+ * be authenticated by SAML. Remember to enable the external module, and 
+ * enter all required settings in that module.
+ *
+ * Sample cron entry:
+ * # 5 minutes past 4am
+ * 5 4 * * * $sudo -u www-data /usr/bin/php /var/www/moodle/auth/saml/cli/sync_users.php
+ *
+ * Notes:
+ *   - it is required to use the web server account when executing PHP CLI scripts
+ *   - you need to change the "www-data" to match the apache user account
+ *   - use "su" if "sudo" not available
+ *   - If you have a large number of users, you may want to raise the memory limits
+ *     by passing -d momory_limit=256M
+ *   - For debugging & better logging, you are encouraged to use in the command line:
+ *     -d log_errors=1 -d error_reporting=E_ALL -d display_errors=0 -d html_errors=0
+ *   - If you have a large number of users, you may want to raise the memory limits
+ *     by passing -d momory_limit=256M
+ *   - For debugging & better logging, you are encouraged to use in the command line:
+ *     -d log_errors=1 -d error_reporting=E_ALL -d display_errors=0 -d html_errors=0
+ *
+ * @package    auth_saml
+ * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
+ */
+
+define('CLI_SCRIPT', true);
+
+require(dirname(dirname(dirname(dirname(__FILE__)))).'/config.php'); // global moodle config file.
+require_once("$CFG->libdir/clilib.php");
+
+if (!is_enabled_auth('saml')) {
+    error_log('[AUTH SAML] '. get_string('pluginnotenabled', 'auth_saml'));
+    die;
+}
+
+list($options, $unrecognized) = cli_get_params(array('noupdate'=>false, 'verbose'=>false, 'help'=>false), array('n'=>'noupdate', 'v'=>'verbose', 'h'=>'help'));
+
+if ($unrecognized) {
+    $unrecognized = implode("\n  ", $unrecognized);
+    cli_error(get_string('cliunknowoption', 'admin', $unrecognized));
+}
+
+// Ensure errors are well explained
+set_debugging(DEBUG_DEVELOPER, true);
+
+
+if ($options['help']) {
+    $help =
+"Execute user account sync via another auth module. The users are fetched from an external source such as LDAP or an external DB, and authenticate via SAML.
+
+Options:
+-n, --noupdate        Skip update of existing users
+-v, --verbose         Print verbose progress information
+-h, --help            Print out this help
+
+Example:
+\$ sudo -u www-data /usr/bin/php auth/saml/cli/sync_users.php
+
+Sample cron entry:
+# 5 minutes past 4am
+5 4 * * * sudo -u www-data /usr/bin/php /var/www/moodle/auth/saml/cli/sync_users.php
+";
+
+    echo $help;
+    die;
+}
+
+$do_update = empty($options['noupdate']);
+
+$config = get_config('auth/saml');
+if (!empty($config->syncusersfrom)) {
+	$otherauth = get_auth_plugin($config->syncusersfrom);
+	$otherauth->authtype = 'saml';
+
+	$method = new ReflectionMethod($otherauth, 'sync_users');
+
+	switch ($method->getNumberOfParameters()) {
+		case 1:
+			// LDAP takes one arg
+			$otherauth->sync_users($do_update);
+			break;	
+		case 2:
+			// DB takes two
+			if (empty($options['verbose'])) {
+			    $trace = new null_progress_trace();
+			} else {
+			    $trace = new text_progress_trace();
+			}
+			$otherauth->sync_users($trace, $do_update);
+			break;
+		default:
+			error_log('[AUTH SAML] '. get_string('unknownplugin', 'auth_saml') . $config->syncusersfrom);
+	}	
+} else {
+	error_log('[AUTH SAML] '. get_string('syncfromnotenabled', 'auth_saml'));
+}
diff --git a/auth/saml/config.php b/auth/saml/config.php
new file mode 100755
index 0000000..91ee63d
--- /dev/null
+++ b/auth/saml/config.php
@@ -0,0 +1,436 @@
+<script src="../auth/saml/resources/moodle_saml.js" type="text/javascript"></script>
+
+<link rel="stylesheet" type="text/css" href="../auth/saml/resources/ui.theme.css" />
+<link rel="stylesheet" type="text/css" href="../auth/saml/resources/ui.core.css" />
+<link rel="stylesheet" type="text/css" href="../auth/saml/resources/ui.tabs.css" />
+<link rel="stylesheet" type="text/css" href="../auth/saml/resources/moodle_saml.css" />
+
+<script type="text/javascript" src="../auth/saml/resources/jquery-1.3.2.min.js"></script>
+<script type="text/javascript" src="../auth/saml/resources/jquery-ui-1.7.2.custom.min.js"></script>
+
+
+<?php
+/**
+ * @author Erlend Strømsvik - Ny Media AS
+ * @author Piers Harding - made quite a number of changes
+ * @license http://www.gnu.org/copyleft/gpl.html GNU Public License
+ * @package auth/saml
+ *
+ * Authentication Plugin: SAML based SSO Authentication
+ *
+ * Authentication using SAML2 with SimpleSAMLphp.
+ *
+ * Based on plugins made by Sergio Gómez (moodle_ssp) and Martin Dougiamas (Shibboleth).
+ *
+ * 2008-10  Created
+ * 2009-07  Added new configuration options
+**/
+
+    global $CFG, $OUTPUT;
+
+    require_once("courses.php");
+    require_once("roles.php");
+
+    // Get saml paramters stored in the saml_config.php
+    if(file_exists($CFG->dataroot.'/saml_config.php')) {
+        $contentfile = file_get_contents($CFG->dataroot.'/saml_config.php');
+        $saml_param = json_decode($contentfile);
+    } else if (file_exists('saml_config.php')) {
+        $contentfile = file_get_contents('saml_config.php');
+        $saml_param = json_decode($contentfile);
+    } else {
+        $saml_param = new stdClass();
+    }
+
+    // Set to defaults if undefined
+    if (!isset ($saml_param->samllib)) {
+        if(isset ($config->samllib)) {
+            $saml_param->samllib = $config->samllib;
+        }
+        else {
+            $saml_param->samllib = '/var/www/sp/simplesamlphp/lib';
+        }
+    }
+    if (!isset ($saml_param->sp_source)) {
+        if(isset ($config->sp_source)) {
+            $saml_param->sp_source = $config->sp_source;
+        }
+        else {
+            $saml_param->sp_source = 'saml';
+        }
+    }
+    if (!isset ($saml_param->dosinglelogout)) {
+        if(isset ($config->dosinglelogout)) {
+            $saml_param->dosinglelogout = $config->dosinglelogout;
+        }
+        else {
+            $saml_param->dosinglelogout = false;
+        }
+    }
+    if (!isset ($config->username)) {
+        $config->username = 'eduPersonPrincipalName';
+    }
+    if (!isset ($config->notshowusername)) {
+        $config->notshowusername = 'none';
+    }
+    if (!isset ($config->supportcourses)) {
+        $config->supportcourses = 'nosupport';
+    }
+    if (!isset ($config->syncusersfrom)) {
+        $config->syncusersfrom = '';
+    }
+    if (!isset ($config->samlcourses)) {
+        $config->samlcourses = 'schacUserStatus';
+    }
+    if (!isset ($config->samllogoimage)) {
+        //$config->samllogoimage = 'logo.gif';
+        $config->samllogoimage = 'portal-login.jpg';
+    }
+    if (!isset ($config->samllogoinfo)) {
+        $config->samllogoinfo = 'SAML login';
+    }
+    if (!isset ($config->autologin)) {
+        $config->autologin = false;
+    }
+    if (!isset ($config->samllogfile)) {
+        $config->samllogfile = '';
+    }
+    if (!isset ($config->samlhookfile)) {
+        $config->samlhookfile = $CFG->dirroot . '/auth/saml/custom_hook.php';
+    }
+    if (!isset ($config->moodlecoursefieldid)) {
+        $config->moodlecoursefieldid = 'shortname';
+    }
+    if (!isset ($config->ignoreinactivecourses)) {
+        $config->ignoreinactivecourses = true;
+    }
+    if (!isset ($config->externalcoursemappingdsn)) { 
+        $config->externalcoursemappingdsn = ''; 
+    }
+    if (!isset ($config->externalrolemappingdsn)) { 
+        $config->externalrolemappingdsn = ''; 
+    }
+    if (!isset ($config->externalcoursemappingsql)) { 
+        $config->externalcoursemappingsql = ''; 
+    }
+    if (!isset ($config->externalrolemappingsql)) { 
+        $config->externalrolemappingsql = ''; 
+    }
+
+    if (!isset ($config->disablejit)) {
+        $config->disablejit = false;
+    }
+
+?>
+
+<div align="right">
+    <input type="submit" name="auth_saml_db_reset" value="<?php print_string('auth_saml_db_reset_button', 'auth_saml'); ?>" />
+</div>
+
+<table cellspacing="0" cellpadding="5" border="0">
+
+<?php
+if (isset($err) && !empty($err)) {
+
+    require_once('error.php');
+    auth_saml_error($err, false, $config->samllogfile);
+
+    echo '
+    <tr>
+        <td class="center" colspan="4" style="background-color: red; color: white;text-">
+    ';
+    if(isset($err['reset'])) {
+        echo $err['reset'];
+    }
+    else {
+        print_string("auth_saml_form_error", "auth_saml");
+    }
+    echo '
+        </td>
+    </tr>
+    ';
+}
+?>
+
+<tr valign="top" class="required">
+    <td class="right"><?php print_string("auth_saml_samllib", "auth_saml"); ?>:</td>
+    <td>
+        <input name="samllib" type="text" size="30" value="<?php echo $saml_param->samllib; ?>" />
+        <?php
+        if (isset($err['samllib'])) {
+            echo $OUTPUT->error_text($err['samllib']);
+        }
+        ?>
+    </td>
+    <td><?php print_string("auth_saml_samllib_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top" class="required">
+    <td class="right"><?php print_string("auth_saml_sp_source", "auth_saml"); ?>:</td>
+    <td>
+        <input name="sp_source" type="text" size="10" value="<?php echo $saml_param->sp_source; ?>" />
+        <?php
+        if (isset($err['sp_source'])) {
+            echo $OUTPUT->error_text($err['sp_source']);
+        }
+        ?>
+    </td>
+    <td><?php print_string("auth_saml_sp_source_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top" class="required">
+    <td class="right"><?php print_string("auth_saml_username", "auth_saml"); ?>:</td>
+    <td>
+        <input name="username" type="text" size="30" value="<?php echo $config->username; ?>" />
+    </td>
+    <td><?php print_string("auth_saml_username_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_dosinglelogout", "auth_saml"); ?>:</td>
+    <td>
+        <input name="dosinglelogout" type="checkbox" <?php if($saml_param->dosinglelogout) echo 'checked="CHECKED"'; ?> />
+    </td>
+    <td><?php print_string("auth_saml_dosinglelogout_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_logo_path", "auth_saml"); ?>:</td>
+    <td>
+       <input name="samllogoimage" type="text" size="30" value="<?php echo $config->samllogoimage; ?>" />
+    </td>
+    <td><?php print_string("auth_saml_logo_path_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_logo_info", "auth_saml"); ?>:</td>
+    <td>
+       <textarea name="samllogoinfo" type="text" size="30" rows="5" cols="30"><?php echo $config->samllogoinfo; ?></textarea>
+    </td>
+    <td><?php print_string("auth_saml_logo_info_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_autologin", "auth_saml"); ?>:</td>
+    <td>
+        <input name="autologin" type="checkbox" <?php if($config->autologin) echo 'checked="CHECKED"'; ?> />
+    </td>
+    <td><?php print_string("auth_saml_autologin_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_logfile", "auth_saml"); ?>:</td>
+    <td>
+       <input name="samllogfile" type="text" size="30" value="<?php echo $config->samllogfile; ?>" />
+    </td>
+    <td><?php print_string("auth_saml_logfile_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_samlhookfile", "auth_saml"); ?>:</td>
+    <td>
+       <input name="samlhookfile" type="text" size="30" value="<?php echo $config->samlhookfile; ?>" />
+       <?php
+            if (isset($err['samlhookerror'])) {
+                echo $OUTPUT->error_text('<p>' . $err['samlhookerror'] . '</p>');
+            }
+       ?>
+
+    </td>
+    <td><?php print_string("auth_saml_samlhookfile_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_supportcourses", "auth_saml"); ?>:</td>
+    <td>
+       <select name="supportcourses" onchange="javascript:{
+    document.getElementById('coursemapping_li').style.display = (this.value == 'internal') ? 'inline' : 'none';
+    document.getElementById('rolemapping_li').style.display = (this.value == 'internal') ? 'inline' : 'none';
+    document.getElementById('externalmapping_li').style.display = (this.value == 'external') ? 'inline' : 'none';
+    document.getElementById('samlcourses_tr').style.display = (this.value == 'nosupport') ? 'none' : '';
+    document.getElementById('moodlecoursefieldid_tr').style.display = (this.value == 'nosupport') ? 'none' : '';
+    document.getElementById('ignoreinactivecourses_tr').style.display = (this.value == 'nosupport') ? 'none' : '';
+
+    $('#tabdiv').tabs('select', 0);}" >
+            <option name="nosupport" value="nosupport" <?php if($config->supportcourses == 'nosupport') echo 'selected="selected"'; ?> >No Support</option>
+            <option name="internal" value="internal" <?php if($config->supportcourses == 'internal') echo 'selected="selected"'; ?> >Internal</option>
+            <option name="external" value="external" <?php if($config->supportcourses == 'external') echo 'selected="selected"'; ?> >External</option>
+        </select>
+    </td>
+    <td><?php print_string("auth_saml_supportcourses_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string("auth_saml_disablejit", "auth_saml"); ?>:</td>
+    <td>
+        <input name="disablejit" type="checkbox" <?php if($config->disablejit) echo 'checked="CHECKED"'; ?> />
+    </td>
+    <td><?php print_string("auth_saml_disablejit_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top">
+    <td class="right"><?php print_string('auth_saml_syncusersfrom', 'auth_saml'); ?>:</td>
+    <td>
+        <select name="syncusersfrom">
+        <option name="none" value="">Disabled</option>
+        <?php
+            foreach (get_enabled_auth_plugins() as $name) {
+                $plugin = get_auth_plugin($name);
+                if (method_exists($plugin, 'sync_users')) {
+                    print '<option name="' . $name . '" value ="' . $name . '" ' . (($config->syncusersfrom == $name) ? 'selected="selected"' : '') . '>' . $name . '</option>';
+                }
+            }
+        ?>
+        </select>
+    </td>
+    <td><?php print_string("auth_saml_syncusersfrom_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top" class="required" id="samlcourses_tr" <?php echo ($config->supportcourses == 'nosupport'? 'style="display:none;"' : '') ?> >
+    <td class="right"><?php print_string("auth_saml_courses", "auth_saml"); ?>:</td>
+    <td>
+       <input name="samlcourses" type="text" size="30" value="<?php echo $config->samlcourses; ?>" />
+    </td>
+    <td><?php print_string("auth_saml_courses_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top" id="moodlecoursefieldid_tr" <?php echo ($config->supportcourses == 'nosupport' ? 'style="display:none;"' : '') ; ?> >
+    <td class="right"><?php print_string("auth_saml_course_field_id", "auth_saml"); ?>:</td>
+    <td>
+       <select name="moodlecoursefieldid">
+            <option name="shortname" value="shortname" <?php if($config->moodlecoursefieldid == 'shortname') echo 'selected="selected"'; ?> >Short Name</option>
+            <option name="idnumber" value="idnumber" <?php if($config->moodlecoursefieldid == 'idnumber') echo 'selected="selected"'; ?> >Number ID</option>
+       </select>
+    </td>
+    <td><?php print_string("auth_saml_course_field_id_description", "auth_saml"); ?></td>
+</tr>
+
+<tr valign="top" id="ignoreinactivecourses_tr" <?php echo ($config->supportcourses == 'nosupport' ? 'style="display:none;"' : '') ; ?> >
+    <td class="right"><?php print_string("auth_saml_ignoreinactivecourses", "auth_saml"); ?>:</td>
+    <td>
+        <input name="ignoreinactivecourses" type="checkbox" <?php if($config->ignoreinactivecourses) echo 'checked="checked"'; ?>/>
+    </td>
+    <td><?php print_string("auth_saml_ignoreinactivecourses_description", "auth_saml"); ?></td>
+</tr>
+
+</table>
+
+<script type="text/javascript">
+
+$(document).ready(function() {
+    $("#tabdiv").tabs();
+});
+
+
+</script>
+
+<div id="mapping_container">
+<div id="tabdiv">
+<ul>
+    <li><a href="#datamapping">User Data Mapping</a></li>
+    <li id="coursemapping_li" <?php if($config->supportcourses != 'internal') echo 'style="display:none;"'; ?> ><a <?php echo (isset($err['course_mapping'])  || isset($err['missed_course_mapping']) || isset($err['course_mapping_db']) ? 'style="color:red;"' : ''); ?> href="#coursemapping">Course Mapping</a></li>
+    <li id="rolemapping_li" <?php if($config->supportcourses  != 'internal') echo 'style="display:none;"' ?> ><a <?php echo (isset($err['role_mapping'])  || isset($err['missed_role_mapping']) || isset($err['role_mapping_db']) ? 'style="color:red;"' : ''); ?> href="#rolemapping">Role Mapping</a></li>
+    <li id="externalmapping_li" <?php if($config->supportcourses  != 'external') echo 'style="display:none;"'; ?> ><a <?php echo ($config->supportcourses  == 'external' && isset($err['samlexternal']) ? 'style="color:red;"' : ''); ?> href="#externalmapping">External Mapping Info</a></li>
+</ul>
+
+<div id="datamapping">
+    <table class="center">
+    <?php
+    print_auth_lock_options('saml', $user_fields, '<!-- empty help -->', true, false, $this->get_custom_user_profile_fields());
+    ?>
+    </table>
+</div>
+
+<div id="coursemapping">
+
+<?php 
+
+if(isset($err['course_mapping_db']) && in_array("error_creating_course_mapping", $err['course_mapping_db'])) {
+    echo '<span class="error">';
+    print_string("auth_saml_error_creating_course_mapping", "auth_saml");
+    echo '</span>';
+}
+else {
+    echo '<table id="newcourses" class="center">';
+        print_course_mapping_options($course_mapping, $config, $err);
+    echo '
+        </table>
+        <div style="padding-left: 44%;"><input type="submit" name="deletecourses" value="Delete selected" /></div>
+         ';
+}
+?>
+</div>
+
+<div id="rolemapping">
+<?php
+if(isset($err['role_mapping_db']) && in_array("error_creating_role_mapping", $err['role_mapping_db'])) {
+    echo '<span class="error">';
+    print_string("auth_saml_error_creating_role_mapping", "auth_saml");
+    echo '</span>';
+}
+else {
+    echo '<table id="newroles" class="center">';
+          print_role_mapping_options($role_mapping, $config, $err);
+    echo '</table>
+          <div style="padding-top: 10px; padding-left: 44%;"><input type="submit" name="deleteroles" value="Delete selected" /></div>';
+
+    if($config->supportcourses == 'internal') {
+        echo  '<div align="left">
+                <input type="submit" name="initialize_roles" value="';
+                print_string('auth_saml_initialize_roles', 'auth_saml');
+        echo '" />
+              </div>
+             ';
+    }
+}
+?>
+</div>
+
+<div id="externalmapping">
+    <?php
+        if (isset($err['samlexternal'])) {
+            echo $OUTPUT->error_text($err['samlexternal']);
+        }
+    ?>
+    <table id="externalmappinginfo" class="center">
+        <tr valign="top">
+            <td colspan="2"><?php print_string("auth_saml_mapping_dsn_description", "auth_saml"); ?></td>
+        </tr>
+        <tr valign="top" class="required">
+            <td class="right"><?php print_string("auth_saml_course_mapping_dsn", "auth_saml"); ?>:</td>
+            <td>
+               <input name="externalcoursemappingdsn" type="text" size="55" value="<?php echo $config->externalcoursemappingdsn; ?>" />
+            </td>
+        </tr>
+        <tr class="required">    
+            <td class="right" valign="top"><?php print_string("auth_saml_course_mapping_sql", "auth_saml"); ?>:</td>
+            <td>
+               <textarea name="externalcoursemappingsql" type="text" size="55" rows="3" cols="55"><?php echo $config->externalcoursemappingsql; ?></textarea>            
+            </td>
+        </tr>
+        <tr valign="top">
+            <td colspan="2"></td>
+        </tr>
+        <tr class="required">    
+            <td class="right"><?php print_string("auth_saml_role_mapping_dsn", "auth_saml"); ?>:</td>
+            <td>
+               <input name="externalrolemappingdsn" type="text" size="55" value="<?php echo $config->externalrolemappingdsn; ?>" />
+            </td>
+        </tr>
+        <tr class="required">    
+            <td class="right" valign="top"><?php print_string("auth_saml_role_mapping_sql", "auth_saml"); ?>:</td>
+            <td>
+               <textarea name="externalrolemappingsql" type="text" size="55" rows="3" cols="55"><?php echo htmlspecialchars($config->externalrolemappingsql); ?></textarea>
+            </td>
+        </tr>
+    </table>
+    <p>DSN and SQL examples:</p> 
+<?php
+    echo "<p>" . htmlspecialchars(get_string("auth_saml_mapping_dsn_examples", "auth_saml")) . "</p>";
+    echo "<p>" . htmlspecialchars(get_string("auth_saml_mapping_sql_examples", "auth_saml")) . "</p>";
+    echo "<p>" . htmlspecialchars(get_string("auth_saml_mapping_external_warning", "auth_saml")) . "</p>";
+?>
+</div>
+
+</div>
+</div>
diff --git a/auth/saml/course_mapping.php b/auth/saml/course_mapping.php
new file mode 100755
index 0000000..41389c7
--- /dev/null
+++ b/auth/saml/course_mapping.php
@@ -0,0 +1,51 @@
+<?php
+
+    $role_mapping = array();
+    $course_mapping = array();
+    try {
+        $config = get_config('auth/saml');
+        require_once ("roles.php");
+        require_once ("courses.php");
+        $role_mapping = get_role_mapping_for_sync($err, $config);
+        $course_mapping = get_course_mapping_for_sync($err, $config);
+    }
+    catch(Exception $e) {
+        print_error('Caught exception while mapping: '.  $e->getMessage(). "\n");
+    }
+
+    $mapped_roles = array_unique(array_values($role_mapping));
+    $mapped_courses = array();
+
+    foreach($saml_courses as $key => $course) {
+        if (function_exists('saml_hook_get_course_info')) {
+             $regs = saml_hook_get_course_info($course);
+             if ($regs) {
+
+                list($match, $country, $domain, $course_id, $period, $role, $status) = $regs;
+            
+                if(isset($role_mapping[$role]) && isset($course_mapping[$course_id][$period])) {
+                    $mapped_role = $role_mapping[$role];
+                    $mapped_course_id = $course_mapping[$course_id][$period];
+                    $mapped_courses[$mapped_role][$status][$mapped_course_id] = array( 'country' => $country,
+                                                            'domain' => $domain,
+                                                            'course_id' => $mapped_course_id,
+                                                            'period' => $period,
+                                                            'role' => $mapped_role,
+                                                            'status' => $status,
+                    );
+                    if(!$any_course_active && $status == 'active') {
+                          $any_course_active = true;                  
+                    }
+                }
+                else {
+                    $str_obj = new stdClass();
+                    $str_obj->course = '('.$course_id.' -- '.$period.')';
+                    $str_obj->user = $saml_user_identify; 
+                    $err['course_enrollment'][] = get_string('auth_saml_course_not_found' , 'auth_saml', $str_obj);
+                }
+            }
+        }
+    }
+
+    unset($saml_courses);
+    unset($saml_user_identify);
diff --git a/auth/saml/courses.php b/auth/saml/courses.php
new file mode 100755
index 0000000..ec18140
--- /dev/null
+++ b/auth/saml/courses.php
@@ -0,0 +1,195 @@
+<?php
+function get_moodle_courses($config) {
+    $moodle_courses = array();
+    foreach(get_courses() as $course) {
+        if(isset($config->moodlecoursefieldid) && $config->moodlecoursefieldid == 'idnumber') {
+            $course_identify = $course->idnumber;
+        }
+        else {
+            $course_identify = $course->shortname;
+        }
+        $moodle_courses[] = $course_identify;
+    }
+    return $moodle_courses;
+}
+
+function get_course_mapping(&$DB, &$err) {
+
+    $course_mapping = array();
+    $fields = 'course_mapping_id, saml_course_id, saml_course_period , lms_course_id';
+    $rs = $DB->get_records_select('course_mapping', '', null, '', $fields, 0, 0);
+
+    if ($rs === false){
+        $err['course_mapping_db'][] = get_string("auth_saml_error_executing_course_mapping_query", "auth_saml");
+    } else {
+
+        //creating the courses mapping
+        foreach ($rs as $tuple){
+            $tuple = array_change_key_case((array)$tuple,CASE_LOWER);
+            $course_mapping[$tuple['lms_course_id']] = array(
+                'course_mapping_id' => $tuple['course_mapping_id'],
+                'saml_course_id' => $tuple['saml_course_id'],
+                'saml_course_period' => $tuple['saml_course_period'],
+            );
+        }
+		unset($rs);
+    }
+
+    return $course_mapping;
+}
+
+function get_course_mapping_for_sync(&$err, $config) {
+
+    $course_mapping = array();
+    if($config->supportcourses == 'external') {
+        require_once ("DBNewConnection.php"); 
+        $DB_mapping = DBNewConnection($config->externalcoursemappingdsn);
+        $rs = false;
+        if($DB_mapping) {
+            $DB_mapping->SetFetchMode(ADODB_FETCH_ASSOC);
+            $rs = $DB_mapping->Execute($config->externalcoursemappingsql);
+            if($rs !==false) {
+                $res_array = $rs->GetAll();
+            }            
+            $DB_mapping->Disconnect();
+        }
+    }
+    else {
+        global $DB;
+            $fields = 'course_mapping_id, saml_course_id, saml_course_period , lms_course_id';
+            $rs = $DB->get_records_select('course_mapping', '', null, '', $fields, 0, 0);
+            if($rs !==false) {
+                $res_array = $rs;
+            }
+    }
+    if ($rs === false){
+        $err['course_mapping_db'][] = get_string("auth_saml_error_executing_course_mapping_query", "auth_saml");
+    } else {
+        //creating the courses mapping
+        foreach ($res_array as $tuple) {
+            $tuple = array_change_key_case((array)$tuple,CASE_LOWER);
+            if(empty($tuple['saml_course_id']) || empty($tuple['saml_course_period']) || empty($tuple['lms_course_id']))  {
+                $err['role_mapping_db'][] = "<p>" . get_string("auth_saml_error_attribute_course_mapping", "auth_saml") . "</p><p>saml_course_id:" . $tuple['saml_course_id'] . " saml_course_period: " . $tuple['saml_course_period'] . " lms_course_id:" . $tuple['lms_course_id'] . "</p>";
+            }
+            else {
+                if(isset($course_mapping[$tuple['saml_course_id']][$tuple['saml_course_period']])) {
+                    $err['course_mapping_db'][] = get_string('auth_saml_duplicated_saml_data', "auth_saml").' saml_course_id:'.$tuple['saml_course_id'].' saml_course_period:'.$tuple['saml_course_period'];
+                }
+                else {
+            $course_mapping[$tuple['saml_course_id']][$tuple['saml_course_period']] = $tuple['lms_course_id']; 
+                }
+            }		
+        }
+	    unset($res_array);
+	    unset($rs);
+    }
+    return $course_mapping;
+}
+
+
+function print_course_mapping_options($course_mapping, $config, $err) {
+
+    if(isset($err['course_mapping_db'])) {
+        foreach ($err['course_maping_db'] as $value) {
+           echo '<tr><td colspan="4" style="color: red;text-align:center">';
+           echo $value;  
+           echo '</td></tr>';         
+        }
+    }
+
+    if (array_key_exists('course_mapping', $err)) {
+        echo '<tr><td colspan="4" style="color: red;text-align:center">';
+        if (!empty($err['course_mapping']['saml'])) {
+            echo "<p>" . get_string("auth_saml_duplicated_saml_data", "auth_saml") . implode(', ', $err['course_mapping']['saml']) . "</p>";
+        }
+        if (!empty($err['course_mapping']['lms'])) {
+            echo get_string("auth_saml_duplicated_lms_data", "auth_saml") . implode(', ', $err['course_mapping']['lms']);
+        }	
+        echo '</td></tr>';
+    }
+    if (array_key_exists('missed_course_mapping', $err)) {
+        echo '<tr><td colspan="4" style="color: red;text-align:center">';
+        echo get_string("auth_saml_missed_data", "auth_saml") . implode(', ', array_unique($err['missed_course_mapping']));
+        echo '</td></tr>';
+    }
+
+
+    if (empty($course_mapping)) {
+        echo '<p style="color:grey;font-size:90%;">';
+        print_string("auth_saml_moodle_course_id_field_warning", "auth_saml");
+        echo '</p>';
+    }
+
+    echo '<tr><td></td><td>Moodle Course Id</td><td>SAML Course Id</td><td>SAML Course Period</td></tr>';
+
+    //if this is a GET (no errors) read the values from the database
+
+    $new_courses_total = optional_param('new_courses_total', FALSE, PARAM_INT);
+    $read_from_db_only = ($new_courses_total === FALSE);
+
+    $moodle_courses = get_moodle_courses($config);
+
+    foreach ($moodle_courses as $mcourse) {
+        if (array_key_exists($mcourse, $course_mapping)) {
+            $course_mapping_id = $course_mapping[$mcourse]['course_mapping_id'];
+            $saml_course_id = $course_mapping[$mcourse]['saml_course_id'];
+            $saml_course_period = $course_mapping[$mcourse]['saml_course_period'];
+
+            $course_param = optional_param_array('course_' . $course_mapping_id, array(), PARAM_ALPHANUMEXT);
+
+	        echo '<tr '.((isset($err['course_mapping']['lms']) && in_array($course_param[0], $err['course_mapping']['lms']))
+            || (isset($err['course_mapping']['saml']) && in_array($course_param[1].'_'.$course_param[2], $err['course_mapping']['saml']))
+            || (isset($err['missed_course_mapping']) && array_key_exists($course_mapping_id, $err['missed_course_mapping']))
+            ? 'style="background:red;"' : '').'>';
+
+            echo '<td colspan="2"><input style="margin-right: 20px;" type="checkbox"';
+			echo 'name="course_mapping_id[]" value="'.$course_mapping_id.'">';
+            echo('<input type="hidden" name="update_courses_id[]" value="' . $course_mapping_id . '">');
+            echo '<select name="course_'. $course_mapping_id .'[]" >';
+            foreach ($moodle_courses as $mcourse2) {
+                echo '<option value="'. $mcourse2 .'" '.((!$read_from_db_only && $course_param[0] == $mcourse2) || ($read_from_db_only && $mcourse2 == $mcourse) ? 'selected="selected"' : '') .' >'.$mcourse2.'</option>';
+            }
+            echo '</select></td>';
+            $course_name = ($read_from_db_only ? $saml_course_id : $course_param[1]);
+            $course_period = ($read_from_db_only ? $saml_course_period : $course_param[2]);
+            echo '<td><input type="text" name="course_'. $course_mapping_id .'[]" value="' . $course_name . '" /></td>';
+            echo '<td><input type="text" name="course_'. $course_mapping_id .'[]" value="' . $course_period . '" /></td>';
+        	echo '</tr>';
+        }
+    }
+
+    //New mappings
+    echo '<tr><td colspan="4"><hr /></td></tr>';
+    $i = 0;
+    if ($read_from_db_only) {
+	    while ($i <= $new_courses_total) {
+
+                $new_course_param = optional_param_array('new_course_' . $i, array(), PARAM_ALPHANUMEXT);
+                if (!empty($new_course_param)) {
+
+		    echo '<tr '.((empty($new_course_param[1]) && empty($new_course_param[2]))? 'style="display:none;"' : ((isset($err['course_mapping']['lms']) && in_array($new_course_param[0], $err['course_mapping']['lms'])) 
+            || (isset($err['course_mapping']['saml']) && in_array($new_course_param[1].'_'.$new_course_param[2], $err['course_mapping']['saml'])) ? 'style="background:red;"' : '')) .' >';
+	            echo '<td colspan="2" style="padding-left: 38px;"><select id="newcourse_select_'.$i.'" name="new_course' . $i . '[]">';
+	            foreach ($moodle_courses as $mcourse) {
+                        $is_selected = $new_course_param[0] === $mcourse; 
+                        echo '<option value="'. $mcourse .'" ' . ($is_selected ? 'selected="selected"' : '') . ' >'.$mcourse.'</option>';
+	            }
+	            echo '</select>';
+	            echo '<td><input id="newcourse_saml_id_'.$i.'" type="text" name="new_course' . $i . '[]" value="' . $new_course_param[1] . '" /></td>';
+	            echo '<td><input id="newcourse_saml_period_'.$i.'" type="text" name="new_course' . $i . '[]" value="'. $new_course_param[2] . '" /></td>'; 
+	            echo '</tr>';
+               } 
+	    $i++;
+	    }
+    }
+
+    echo '<tr><td colspan="2" style="padding-left: 38px;"><select id="newcourse_select_'.$i.'" name="new_course' . $i . '[]">';
+    foreach ($moodle_courses as $mcourse) {
+        echo '<option value="' . $mcourse . '"  >' . $mcourse . '</option>';
+    }
+    echo '</select>';
+    echo '<input id="new_courses_total" type="hidden" name="new_courses_total" value="' . $i . '" /></td>';
+    echo '<td><input id="newcourse_saml_id_'.$i.'" type="text" name="new_course' . $i . '[]" value="" /></td>';
+    echo '<td><input id="newcourse_saml_period_'.$i.'" type="text" name="new_course' . $i . '[]" value="" />'; 
+    echo '<input type="button" name="new" value="+" onclick="addNewField(\'newcourses\',\'new_course\',\'course\')" /></td></tr>';
+}
diff --git a/auth/saml/custom_hook.php b/auth/saml/custom_hook.php
new file mode 100755
index 0000000..cb9d449
--- /dev/null
+++ b/auth/saml/custom_hook.php
@@ -0,0 +1,179 @@
+<?php
+/*
+SAML Authentication Plugin Custom Hook
+
+
+This file acts as a hook for the SAML Authentication plugin. The plugin will
+call the functions defined in this file in certain points in the plugin
+lifecycle.
+
+Use this sample file as a template. You should copy it and not modify it
+in place since you may lost your changes in future updates.
+
+To use this hook you have to go to the config form in the admin interface of
+Moodle and set the full path to this file. Please note that the default value
+for such a field is this custom_hook.php file itself.
+
+You should not change the name of the funcions since that's the API the plugin
+expect to exist and to use.
+
+Read the comments of each function to discover when they are called and what
+are they for.
+*/
+
+
+/*
+ name: saml_hook_attribute_filter
+ arguments:
+   - $saml_attributes: array of SAML attributes
+ return value:
+   - nothing
+ purpose: this function allows you to modify the array of SAML attributes.
+          You can change the values of them (e.g. removing the non desired
+          urn parts) or you can even remove or add attributes on the fly.
+*/
+function saml_hook_attribute_filter(&$saml_attributes) {
+
+    // Nos quedamos sólamente con el DNI dentro del schacPersonalUniqueID
+    if(isset($saml_attributes['schacPersonalUniqueID'])) {
+        foreach($saml_attributes['schacPersonalUniqueID'] as $key => $value) {
+            $data = array();
+            if(preg_match('/urn:mace:terena.org:schac:personalUniqueID:es:(.*):(.*)/', $value, $data)) {
+                $saml_attributes['schacPersonalUniqueID'][$key] = $data[2];
+                //DNI sin letra
+                //$saml_attributes['schacPersonalUniqueID'][$key] = substr($value[2], 0, 8);
+            }
+            else {
+                unset($saml_attributes['schacPersonalUniqueID'][$key]);
+            }
+        }
+    }
+
+    // Pasamos el irisMailMainAddress como mail si no existe
+    if(!isset($saml_attributes['mail'])) {
+        if(isset($saml_attributes['irisMailMainAddress'])) {
+            $saml_attributes['mail'] = $saml_attributes['irisMailMainAddress'];
+        }
+    }
+
+
+    // Pasamos el uid como eduPersonPrincipalName o como eduPersonTargetedID
+    if(!isset($saml_attributes['eduPersonPrincipalName'])) {
+        if(isset($saml_attributes['uid'])) {
+            $saml_attributes['eduPersonPrincipalName'] = $saml_attributes['uid'];
+        }
+        else if (isset($saml_attributes['eduPersonTargetedID'])) {
+            $saml_attributes['eduPersonPrincipalName'] = $saml_attributes['eduPersonTargetedID'];
+        }
+        else if (isset($saml_attributes['mail'])) {
+            $saml_attributes['eduPersonPrincipalName'] = $saml_attributes['mail'];
+        }
+    }
+
+
+    // Pasamos el uid como eduPersonPrincipalName
+
+    if(!isset($saml_attributes['eduPersonPrincipalName'])) {
+        if(isset($saml_attributes['uid'])) {
+            $saml_attributes['eduPersonPrincipalName'] = $saml_attributes['uid'];
+        }
+        else if (isset($saml_attributes['mail'])) {
+            $saml_attributes['eduPersonPrincipalName'] = $saml_attributes['mail'];
+        }
+    }
+
+}
+
+/*
+ name: saml_hook_user_exists
+ arguments:
+   - $username: candidate name of the current user
+   - $saml_attributes: array of SAML attributes
+   - $user_exists: true if the $username exists in Moodle database
+ return value:
+   - true if you consider that this username should exist, false otherwise.
+ purpose: this function let you change the logic by which the plugin thinks
+          the user exists in Moodle. You can even change the username if
+          the user exists but you want to recreate with another name.
+*/
+function saml_hook_user_exists(&$username, $saml_attributes, $user_exists) {
+    return true;
+}
+
+/*
+ name: saml_hook_authorize_user
+ arguments:
+    - $username: name of the current user
+    - $saml_attributes: array of SAML attributes
+    - $authorize_user: true if the plugin thinks this user should be allowed
+ return value:
+    - true if the user should be authorized or an error string explaining
+      why the user access should be denied.
+ purpose: use this function to deny the access to the current user based on
+          the value of its attributes or any other reason you want. It is
+	  very important that this function return either true or an error
+	  message.
+*/
+function saml_hook_authorize_user($username, $saml_attributes, $authorize_user) {
+    return true;
+}
+
+/*
+ name: saml_hook_post_user_created
+ arguments:
+   - $user: object containing the Moodle user
+   - $saml_attributes: array of SAML attributes
+ return value:
+   - nothing
+ purpose: use this function if you want to make changes to the user object
+          or update any external system for statistics or something similar.
+*/
+function saml_hook_post_user_created($user, $saml_attributes = array()) {
+
+}
+
+/*
+ name: saml_hook_get_course_info
+ arguments:
+   - $course: string that contains info about the course
+ 
+ return array with the following indexes:
+        0 - match      matched string   
+        1 - country    country info
+        2 - domain     domain info 
+        3 - course_id  the course id to be mapped with moodle course
+        4 - period     period of the course
+        5 - role       role to be mappend with moodle role
+        6 - status     'active' | 'inactive'
+
+  The auth/saml plugin save those data that will be available
+  for the enrol/saml plugin.
+
+  Right now only course_id, period, role and status are
+  required, so if your Identity Provider don't retrieve country or domain info, return
+  empy values for them Ex. alternative pattern
+  Info: 'courseData:math1:2016-17:student:active'
+  
+  $regex = '/courseData:(.+):(.+):(.+):(.+):(.+):(.+)/';
+  if (preg_match($regex, $course, $matches) {
+    $regs = array();
+    $regs[0] = $matches[0];
+    $regs[1] = null;          // country
+    $regs[2] = null;          // domain
+    $regs[3] = $matches[1];   // course_id
+    $regs[4] = $matches[2];   // period
+    $regs[5] = $matches[3];   // role
+    $regs[6] = $matches[4];   // status
+  }
+*/
+function saml_hook_get_course_info($course) {
+  $regs = null;
+
+  $regex = '/urn:mace:terena.org:schac:userStatus:(.+):(.+):(.+):(.+):(.+):(.+)/';
+
+  if (preg_match($regex, $course, $matches)) {
+    $regs = $matches;
+  }
+
+  return $regs;
+}
diff --git a/auth/saml/error.php b/auth/saml/error.php
new file mode 100755
index 0000000..bc6561e
--- /dev/null
+++ b/auth/saml/error.php
@@ -0,0 +1,89 @@
+<?php
+
+function auth_saml_error($err, $urltogo=false, $logfile='', $showerror=false) {
+    global $CFG, $PAGE, $OUTPUT;
+    
+    if((isset($CFG->debugdisplay) && !$CFG->debugdisplay) || $showerror) {
+        $debug = true;
+    }
+    else {
+        $debug = false;
+    }
+    
+    if($urltogo!=false) {
+        $site = get_site();
+        if($site === false || !isset($site->fullname)) {
+            $site_name = '';
+        }
+        else {
+            $site_name = $site->fullname;
+        }
+        $PAGE->set_title($site_name .':Error SAML Login');
+
+        echo $OUTPUT->header();
+
+
+        echo '<div style="margin:20px;font-weight: bold; color: red;">';
+    }
+    if(is_array($err)) {
+        foreach($err as $key => $messages) {
+            if(!is_array($messages)) {
+                if($urltogo!=false && ($debug || $key == 'course_enrollment')) {
+                    echo $messages;
+                }
+                $msg = 'Moodle SAML module: '.$key.': '.$messages;
+                auth_saml_log_error($msg, $logfile);
+            }
+            else {
+                foreach($messages as $message) {
+                    if($urltogo!=false && ($debug || $key == 'course_enrollment')) {
+                        echo $message.'<br>';
+                    }
+                    $msg = 'Moodle SAML module: '.$key.': '.$message;
+                    auth_saml_log_error($msg, $logfile);
+                }
+            }
+            echo '<br>';
+        }
+    }
+    else {
+        if($urltogo!=false) {
+            echo $err;
+        }
+        $msg = 'Moodle SAML module: login: '.$err;
+        auth_saml_log_error($msg, $logfile);
+    }
+    if($urltogo!=false) {
+        echo '</div>';
+        echo $OUTPUT->continue_button($urltogo);
+        if($debug && !$showerror) {
+            print_string("auth_saml_disable_debugdisplay", "auth_saml");
+        }
+        echo $OUTPUT->footer();
+        exit();
+    }
+}
+
+function auth_saml_log_error($msg, $logfile) {
+    global $CFG;
+    // 0 - message  is sent to PHP's system logger, using the Operating System's system logging mechanism or a file.
+    // 3 - message  is appended to the file destination
+    $destination = '';
+    $error_log_type = 0;
+    if(isset($logfile) && !empty($logfile)) {
+        if (substr($logfile, 0) == '/') {
+            $destination = $logfile;
+        }
+        else {
+            $destination = $CFG->dataroot . '/' . $logfile;
+        }
+        $error_log_type = 3;
+        $msg = auth_saml_decorate_log($msg);
+    }
+    error_log($msg, $error_log_type, $destination);
+}
+
+
+function auth_saml_decorate_log($msg) {
+    return $msg = date('D M d H:i:s  Y').' [client '.$_SERVER['REMOTE_ADDR'].'] [error] '.$msg."\r\n";
+}
diff --git a/auth/saml/index.php b/auth/saml/index.php
new file mode 100755
index 0000000..b402a45
--- /dev/null
+++ b/auth/saml/index.php
@@ -0,0 +1,240 @@
+<?php
+
+define('SAML_INTERNAL', 1);
+
+    try{
+
+        // In order to avoid session problems we first do the SAML issues and then
+        // we log in and register the attributes of user, but we need to read the value of the $CFG->dataroot
+        $dataroot = null;
+        if (file_exists('../../config.php')) {
+            $config_content =  file_get_contents('../../config.php');
+
+            $matches = array();
+            if (preg_match('/\$CFG->dataroot\s*=\s*["\'](.+)["\'];/i', $config_content, $matches)) {
+                $dataroot = $matches[1];
+            }
+        }
+
+        // We read saml parameters from a config file instead from the database
+        // due we can not operate with the moodle database without load all
+        // moodle session issue.
+        if(isset($dataroot) && file_exists($dataroot.'/saml_config.php')) {
+            $contentfile = file_get_contents($dataroot.'/saml_config.php');
+        }
+        else if (file_exists('saml_config.php')) {
+            $contentfile = file_get_contents('saml_config.php');
+        } else {
+            throw(new Exception('SAML config params are not set.'));
+        }
+
+    	$saml_param = json_decode($contentfile);
+
+        if(!file_exists($saml_param->samllib.'/_autoload.php')) {
+            throw(new Exception('simpleSAMLphp lib loader file does not exist: '.$saml_param->samllib.'/_autoload.php'));
+        }
+        include_once($saml_param->samllib.'/_autoload.php');
+        $as = new SimpleSAML_Auth_Simple($saml_param->sp_source);
+
+        if(isset($_GET["logout"])) {
+            if(isset($_SERVER['SCRIPT_URI'])) {
+                $urltogo = $_SERVER['SCRIPT_URI'];
+                $urltogo = str_replace('auth/saml/index.php', '', $urltogo);
+            }
+            else if(isset($_SERVER['HTTP_REFERER'])) {
+                $urltogo = $_SERVER['HTTP_REFERER'];
+            }
+            else{
+                $urltogo = '/';
+            }
+
+            if($saml_param->dosinglelogout) {
+                $as->logout($urltogo);
+                assert("FALSE"); // The previous line issues a redirect
+            } else {
+                header('Location: '.$urltogo);
+                exit();
+            }
+        }
+
+        $as->requireAuth();
+        $valid_saml_session = $as->isAuthenticated();
+        $saml_attributes = $as->getAttributes();
+    } catch (Exception $e) {
+        session_write_close();
+        require_once('../../config.php');
+        require_once('error.php');
+
+        global $err, $PAGE, $OUTPUT;
+        $PAGE->set_url('/auth/saml/index.php');
+        $PAGE->set_context(CONTEXT_SYSTEM::instance());
+
+        $pluginconfig = get_config('auth/saml');
+        $urltogo = $CFG->wwwroot;
+        if($CFG->wwwroot[strlen($CFG->wwwroot)-1] != '/') {
+            $urltogo .= '/';
+        }
+
+        $err['login'] = $e->getMessage();
+        auth_saml_log_error('Moodle SAML module:'. $err['login'], $pluginconfig->samllogfile);;
+        auth_saml_error($err['login'], $urltogo, $pluginconfig->samllogfile);
+    }
+
+    // Now we close simpleSAMLphp session
+    session_write_close();
+
+    // We load all moodle config and libs
+    require_once('../../config.php');
+    require_once('error.php');
+
+    global $CFG, $USER, $SAML_COURSE_INFO, $SESSION, $err, $DB, $PAGE;
+
+    $PAGE->set_url('/auth/saml/index.php');
+    $PAGE->set_context(CONTEXT_SYSTEM::instance());
+
+    $urltogo = $CFG->wwwroot;
+    if($CFG->wwwroot[strlen($CFG->wwwroot)-1] != '/') {
+        $urltogo .= '/';
+    }
+
+     // set return rul from wantsurl
+     if(isset($_REQUEST['wantsurl'])) {
+        $urltogo = $_REQUEST['wantsurl'];
+     }
+
+    // Get the plugin config for saml
+    $pluginconfig = get_config('auth/saml');
+
+    if (!$valid_saml_session) {
+	    // Not valid session. Ship user off to Identity Provider
+        unset($USER);
+        try {
+            $as = new SimpleSAML_Auth_Simple($saml_param->sp_source);
+            $as->requireAuth();
+        } catch (Exception $e) {
+            $err['login'] = $e->getMessage();
+            auth_saml_error($err['login'], $urltogo, $pluginconfig->samllogfile);
+        }
+    } else {
+        // Valid session. Register or update user in Moodle, log him on, and redirect to Moodle front
+        include_once("utils.php");
+        if (isset($pluginconfig->samlhookfile) && $pluginconfig->samlhookfile != '') {
+            include_once(resolve_samlhookfile($pluginconfig->samlhookfile));
+        }
+
+        if (function_exists('saml_hook_attribute_filter')) {
+            saml_hook_attribute_filter($saml_attributes);
+        }
+
+        // We require the plugin to know that we are now doing a saml login in hook puser_login
+        $SESSION->auth_saml_login = TRUE;
+
+        // Make variables accessible to saml->get_userinfo. Information will be
+        // requested from authenticate_user_login -> create_user_record / update_user_record
+        $SESSION->auth_saml_login_attributes = $saml_attributes;
+
+        if (isset($pluginconfig->username) && $pluginconfig->username != '') {
+            $username_field = $pluginconfig->username;
+        } else {
+            $username_field = 'eduPersonPrincipalName';
+        }
+
+        if(!isset($saml_attributes[$username_field])) {
+            $err['login'] = get_string("auth_saml_username_not_found", "auth_saml", $username_field);
+            auth_saml_error($err['login'], $CFG->wwwroot.'/auth/saml/login.php', $pluginconfig->samllogfile, true);
+        }
+        $username = $saml_attributes[$username_field][0];
+        $username = trim(strtolower($username));
+
+        $saml_courses = array();
+        if($pluginconfig->supportcourses != 'nosupport' && isset($pluginconfig->samlcourses)) {
+            if(!isset($saml_attributes[$pluginconfig->samlcourses])) {
+                $err['login'] = get_string("auth_saml_courses_not_found", "auth_saml", $pluginconfig->samlcourses);
+                auth_saml_error($err['login'], $CFG->wwwroot.'/auth/saml/login.php', $pluginconfig->samllogfile);
+            }
+            $saml_courses = $saml_attributes[$pluginconfig->samlcourses];
+        }
+
+        // Obtain the course_mapping. Now $USER->mapped_courses have the mapped courses and $USER->mapped_roles the roles
+        if($pluginconfig->supportcourses != 'nosupport' ) {
+            $any_course_active = false;
+            include_once('course_mapping.php');
+            if (!isset($SAML_COURSE_INFO)) {
+               $SAML_COURSE_INFO = new stdClass();
+            }
+            $SAML_COURSE_INFO->mapped_roles = $mapped_roles;
+            $SAML_COURSE_INFO->mapped_courses = $mapped_courses;
+        }
+
+        // Check if user exist
+        $user_exists = $DB->get_record("user", array("username" => $username));
+        
+        if (function_exists('saml_hook_user_exists')) {
+            $user_exists = $user_exists && saml_hook_user_exists($username, $saml_attributes, $user_exists);
+        }
+
+        if (!$user_exists && $pluginconfig->disablejit) {
+            $jit_not_active = get_string("auth_saml_jit_not_active", "auth_saml", $username);
+            $err['login'] = "<p>". $jit_not_active . "</p>";
+            auth_saml_error($err, $CFG->wwwroot.'/auth/saml/login.php', $pluginconfig->samllogfile, true);
+        }
+
+        $authorize_user = true;
+        $authorize_error = '';
+
+        // If user not exist in Moodle and not valid course active
+        if(!$user_exists && (isset($any_course_active) && !$any_course_active)) {
+            $authorize_error = get_string("auth_saml_not_authorize", "auth_saml", $username);
+            $authorize_user = false;
+        }
+
+        if (function_exists('saml_hook_authorize_user')) {
+            $result = saml_hook_authorize_user($username, $saml_attributes, $authorize_user);
+            if ($result !== true) {
+                $authorize_user = false;
+                $authorize_error = $result;
+            }
+        }
+
+        if (!$authorize_user) {
+            $err['login'] = "<p>" . $authorize_error . "</p>";
+            auth_saml_error($err, $CFG->wwwroot.'/auth/saml/login.php', $pluginconfig->samllogfile, true);
+        }
+        
+        // Just passes time as a password. User will never log in directly to moodle with this password anyway or so we hope?
+        $user = authenticate_user_login($username, time());
+        if ($user === false) {
+            $err['login'] = get_string("auth_saml_error_authentication_process", "auth_saml", $username);
+            auth_saml_error($err['login'], $CFG->wwwroot.'/auth/saml/login.php', $pluginconfig->samllogfile, true);
+        }
+
+        // Complete the user login sequence
+        $user = get_complete_user_data('id', $user->id);
+        if ($user === false) {
+            $err['login'] = get_string("auth_saml_error_complete_user_data", "auth_saml", $username);
+            auth_saml_error($err['login'], $CFG->wwwroot.'/auth/saml/login.php', $pluginconfig->samllogfile, true);
+        }
+
+        $USER = complete_user_login($user);
+
+        if (function_exists('saml_hook_post_user_created')) {
+            saml_hook_post_user_created($USER, $saml_attributes);
+        }
+
+        if (isset($SESSION->wantsurl) && !empty($SESSION->wantsurl)) {
+             $urltogo = $SESSION->wantsurl;
+        }
+
+        if (strpos($urltogo , 'auth/saml/index.php') !== false) {
+            $urltogo = $CFG->wwwroot;
+        }
+
+        $USER->loggedin = true;
+        $USER->site = $CFG->wwwroot;
+        set_moodle_cookie($USER->username);
+
+        if(isset($err) && !empty($err)) {
+            auth_saml_error($err, $urltogo, $pluginconfig->samllogfile);
+        }
+        redirect($urltogo);
+    }
diff --git a/auth/saml/lang/en/auth_saml.php b/auth/saml/lang/en/auth_saml.php
new file mode 100755
index 0000000..7ff6fcc
--- /dev/null
+++ b/auth/saml/lang/en/auth_saml.php
@@ -0,0 +1,130 @@
+<?php
+
+$string['auth_saml_loginusing'] = 'Login here using your username and password';
+
+$string['auth_samltitle']  = 'SAML Authentication';
+$string['auth_samldescription'] = 'Single sign-on using SimpleSAMLphp';
+
+$string['auth_saml_samllib'] = 'SimpleSAMLphp library path';
+$string['auth_saml_samllib_description'] = 'Library path for the SimpleSAMLphp environment you want to use, e.g.: /var/www/sp/simplesamlphp/lib.';
+$string['auth_saml_errorbadlib'] = "SimpleSAMLphp lib directory {\$a} is not correct.";
+
+$string['auth_saml_sp_source'] = 'SimpleSAMLphp SP source';
+$string['auth_saml_sp_source_description'] = 'Select the SP source you want to connect to Moodle. (Sources are in /config/authsources.php).';
+$string['auth_saml_errorsp_source'] = "SimpleSAMLphp SP source {\$a} is not correct";
+
+$string['auth_saml_db_reset_button'] = 'Reset values to factory settings';
+$string['auth_saml_db_reset_error'] = 'Error resetting the saml plugin values';
+
+$string['auth_saml_form_error'] = 'There are some errors in the form. Please, see below for correcting them';
+
+$string['auth_saml_dosinglelogout'] = 'Single logout';
+$string['auth_saml_dosinglelogout_description'] = 'Check it to enable the single logout. This will log out you from Moodle, the identity provider and all connected service providers.';
+
+$string['auth_saml_username'] = 'SAML username mapping';
+$string['auth_saml_username_description'] = 'SAML attribute that is mapped to Moodle username - this defaults to eduPersonPrincipalName.';
+$string['auth_saml_username_not_found'] = "IdP returned a set of data that no contain the SAML username mapping field ({\$a}). This field is required to login";
+
+$string['auth_saml_supportcourses'] = 'SAML support courses';
+$string['auth_saml_supportcourses_description'] = 'Select Internal or External to have Moodle auto-enrol users in courses by the enrol/saml plugin. (Use External if your course/role mapping is in an external DB).';
+
+
+$string['auth_saml_disablejit'] = "Disable Just-in-time provisioning";
+$string['auth_saml_disablejit_description'] = "Check it in order to disable the just-in-time provisioning. When JIT is disabled, account will be not created.";
+
+$string['auth_saml_syncusersfrom'] = 'Synchronize users from module';
+$string['auth_saml_syncusersfrom_description'] = 'Synchronize users into Moodle using another module. The users will be created with auth = \'saml\', even though they are actually synchronized by another module. 
+This allows you to create, update and delete users from for example LDAP, but log them in via SAML. Note that the module you wish to sync from must be enabled, and all sync settings should be controlled from that module, not from SAML. 
+To run the synchronization, add auth/saml/cli/sync_users.php to your cron.';
+
+$string['auth_saml_courses'] = 'SAML courses mapping';
+$string['auth_saml_courses_description'] = 'SAML attribute that contains courses data (default to schacUserStatus)';
+$string['auth_saml_courses_not_found'] = "IdP returned a set of data that no contain the SAML courses mapping field ({\$a}). This field is required to enrol the user";
+
+$string['auth_saml_course_field_id'] = 'Field used to identify a course';
+$string['auth_saml_course_field_id_description'] = 'We can map the SAML course with the Moodle Short name or with the Course ID number ';
+
+
+$string['auth_saml_logo_path'] = 'SAML image';
+$string['auth_saml_logo_path_description'] = 'Image path for the SAML login button.';
+
+$string['auth_saml_logo_info'] = 'SAML login description';
+$string['auth_saml_logo_info_description'] = 'Description that will be shown below the SAML login button.';
+
+$string['auth_saml_autologin'] = 'SAML automatic login';
+$string['auth_saml_autologin_description'] = 'Automatically redirect to SAML IdP without showing a login form.';
+
+$string['auth_saml_ignoreinactivecourses'] = 'Ignore Inactive';
+$string['auth_saml_ignoreinactivecourses_description'] = "If not checked the plugin will unenroll the 'inactive' users from courses";
+
+$string['auth_saml_jit_not_active'] = "User account {\$a} does not exists and just-in-time provisioning is disabled";
+
+$string['auth_saml_not_authorize'] = "{\$a} has no active CAV course. ";
+
+$string['auth_saml_error_executing'] = "Error executing ";
+
+$string['auth_saml_mapping_dsn_description'] = 'Data Source Name string for connecting to the course/role mapping database.
+(dsn must be an absolute path in case you are using SQLite)'; 
+
+$string['auth_saml_course_mapping_dsn'] = 'Course dsn'; 
+$string['auth_saml_role_mapping_dsn'] = 'Role dsn'; 
+
+$string['auth_saml_course_mapping_sql'] = 'Course sql'; 
+$string['auth_saml_role_mapping_sql'] = 'Role sql'; 
+
+$string['auth_saml_mapping_dsn_examples'] = 'mysql://moodleuser:moodlepass@localhost/saml_course_mapping
+sqlite:/<path-to-db>/mapping.sqlite3
+oci8://user:pwd@host/sid
+postgresql7://user:pwd@host/sid
+';
+
+$string['auth_saml_mapping_sql_examples'] = 'SELECT field1 as lms_course_id, field2 as saml_course_id, field3 as saml_course_period FROM course_mapping
+SELECT field1 as lms_role, field2 as saml_role from role_mapping';
+
+
+$string['auth_saml_mapping_external_warning'] = 'Note: When database of mappinng and moodle are of the same type, connection fail. So in this case better use the internal coursemapping mode and previously dump all data inside db manually';
+
+$string['auth_saml_errorsamlexternal'] = 'It states that the source mapping for the course and the role would be external and so you must specify all the parameters of the DSN and SQL queries.';
+
+$string['auth_saml_sucess_creating_course_mapping'] = 'Table course_mapping created in moodle database';
+$string['auth_saml_error_creating_course_mapping'] = 'Error creating course_mapping in moodle database';
+
+$string['auth_saml_sucess_creating_role_mapping'] = 'Table course_role created in moodle database';
+$string['auth_saml_error_creating_role_mapping'] = 'Error creating role_mapping in moodle database';
+
+$string['auth_saml_error_executing_course_mapping_query'] ='Error executing the course mapping query';
+$string['auth_saml_error_attribute_course_mapping'] = 'Error in attribute names (index) of course table mapping. Check externalcoursemappingsql syntax';
+
+$string['auth_saml_error_executing_role_mapping_query'] ='Error executing the role mapping query';
+$string['auth_saml_error_attribute_role_mapping'] = 'Error in attribute names (index) of role table mapping. Check externalrolemappingsql syntax';
+
+
+$string['auth_saml_error_role_not_found'] = "Error when enrolling. Role {\$a} not exist in Moodle";
+
+$string['auth_saml_initialize_roles'] = 'Initialize role';
+
+$string['auth_saml_missed_data'] = 'The following data contain missed attributes:  ';
+
+$string['auth_saml_duplicated_saml_data'] = 'The following saml data is duplicated: ';
+$string['auth_saml_duplicated_lms_data'] = 'The following lms data is duplicated: ';
+
+$string['auth_saml_moodle_course_id_field_warning'] = 'Before add any course maping, decide what id field (course shortname or number id) gonna be used to identify the moodle course. Once decided save the form and then short name or number id will appear at the Moodle Course Id select. Take in mind that numberid is by default not required at moodle but you should provide it if that is your selected option (or a blank option will appear for this course). If you switch the value of the field used to identify a course after providing some mappings, those mappings will be ignored (but still stored on the database)';
+
+$string['auth_saml_course_not_found'] = "Course saml {\$a->course} not found for the saml user {\$a->user}\n";
+
+$string['auth_saml_disable_debugdisplay'] = ' * Disable debugdisplay in order to hide errors in the login/enrollment process';
+$string['auth_saml_error_authentication_process'] = "Error in authentication process of {\$a}";
+$string['auth_saml_error_complete_user_data'] = "Failed to complete user data of {\$a}";
+$string['auth_saml_error_complete_user_login'] = "Failed to complete user login of {\$a}";
+
+$string['auth_saml_logfile'] = 'Log file path';
+$string['auth_saml_logfile_description'] = 'Set a filename if you want log the SAML plugin errors in a different file that the syslog. (Use an absolute path or Moodle will save this file in the moodledata folder).';
+
+$string['auth_saml_samlhookfile'] = 'Hook file path';
+$string['auth_saml_samlhookfile_description'] = 'Set a path if you want to use a hook file that contain your specific functions. The path can either be absolute or relative to your Moodle root directory.';
+$string['auth_saml_errorbadhook'] = "Incorrect SAML plugin hook file: {\$a}";
+
+$string['pluginname'] = 'SAML Authentication';
+$string['pluginnotenabled'] = 'Plugin not enabled!';
+$string['syncfromnotenabled'] = 'No external plugin selected. SAML cannot synchronize users on its own.';
+$string['unknownplugin'] = 'SAML does not know how to invoke the sync_users method of the specified plugin: ';
diff --git a/auth/saml/lang/es/auth_saml.php b/auth/saml/lang/es/auth_saml.php
new file mode 100755
index 0000000..2bd881a
--- /dev/null
+++ b/auth/saml/lang/es/auth_saml.php
@@ -0,0 +1,122 @@
+<?php
+
+$string['auth_saml_loginusing'] = 'Accede usando tu nombre de usuario y contraseña';
+
+$string['auth_samltitle']  = 'Autenticación SAML';
+$string['auth_samldescription'] = 'Autenticación SSO usando SimpleSAML';
+
+$string['auth_saml_samllib'] = 'Ruta de librería SimpleSAMLPHP';
+$string['auth_saml_samllib_description'] = 'Ruta de acceso a la librería para el entorno SimpleSAMLPHP que deseas, por ejemplo: /var/www/sp/simplesamlphp/lib';
+$string['auth_saml_errorbadlib'] = "El directorio de la librería SimpleSAMLPHP {\$a} no es correcta";
+
+$string['auth_saml_sp_source'] = 'Fuente SimpleSAMLPHP SP';
+$string['auth_saml_sp_source_description'] = 'Selecciona la fuente SP que quieres conectar a moodle. (Las fuentes están en /config/authsources.php).';
+$string['auth_saml_errorsp_source'] = "La fuente SimpleSAMLPHP {\$a} no es correcta";
+
+$string['auth_saml_db_reset_button'] = 'Pulse para restablecer los valores iniciales';
+$string['auth_saml_db_reset_error'] = 'Error al restablecer los valores del plugin saml';
+
+$string['auth_saml_form_error'] = 'Parece que hay algunos errores en el formulario. Por favor, reviselo para corregirlos';
+
+$string['auth_saml_dosinglelogout'] = 'Deslogue global. Single Log out';
+$string['auth_saml_dosinglelogout_description'] = 'Selecciona para habilitar el deslogueo global (single log out). Al desloguear de Moodle lo harás también del proveedor de identidad y de todos los proveedores de servicios conectados en los que estés logueado';
+
+$string['auth_saml_username'] = 'Correspondencia del nombre de usuario SAML';
+$string['auth_saml_username_description'] = 'Atributo SAML que se asigna como username de Moodle - el valor predeterminado es el eduPersonPrincipalName';
+$string['auth_saml_username_not_found'] = "El IdP ha devuelto un conjunto de datos del usuario que no contiene el campo ({\$a}) que se estableció en la configuración que se usase como username de Moodle. Este campo es obligatorio para loguearte";
+
+$string['auth_saml_supportcourses'] = 'Soportar matriculación SAML';
+$string['auth_saml_supportcourses_description'] = 'Selecciona Interna o Externa para que Moodle a través del plugin enrol/saml automatricule al usuario (Usa Externa si tu asignación de cursos y roles está en una base de datos externa';
+
+$string['auth_saml_courses'] = 'Correspondencia de cursos SAML';
+$string['auth_saml_courses_description'] = 'Atributo SAML que contiene los datos de los cursos (por defecto es schacUserStatus)';
+$string['auth_saml_courses_not_found'] = "El IdP ha devuelto un conjunto de datos que no contiene el campo donde Moodle espera encontrar los cursos ({\$a}). Este campo es obligatorio para automatricular al usuario.";
+
+$string['auth_saml_course_field_id'] = 'Campo utilizado para identificar un curso en Moodle';
+$string['auth_saml_course_field_id_description'] = 'Podemos asociar el curso SAML con el curso Moodle utilizando el nombre corto (shortname) o el  número ID (idnumber)';
+
+
+$string['auth_saml_logo_path'] = 'Imagen SAML';
+$string['auth_saml_logo_path_description'] = 'Ruta de la imagen para el botón de inicio de sesión de SAML';
+
+$string['auth_saml_logo_info'] = 'Descripción del login de SAML';
+$string['auth_saml_logo_info_description'] = 'Descripción que se muestra a continuación del botón de inicio de sesión del SAML';
+
+$string['auth_saml_autologin'] = 'SAML automatic login';
+$string['auth_saml_autologin_description'] = 'Automatically redirect to SAML idP without showing a login form';
+
+$string['auth_saml_ignoreinactivecourses'] = 'Ignorar Inactivos';
+$string['auth_saml_ignoreinactivecourses_description'] = "Si no está activado el plugin dará de baja de los cursos a los usuarios 'inactivos'";
+
+$string['auth_saml_not_authorize'] = "{\$a} no tiene activo ningún curso del Campus Andaluz Virtual";
+
+$string['auth_saml_jit_not_active'] = "La cuenta {\$a} no existe y la provisión automática de usuarios está inhabilitada";
+
+$string['auth_saml_disablejit'] = "Inhabilitar Provisiomiento automático";
+$string['auth_saml_disablejit_description'] = "Marcalo para inhabilitar el 'just-in-time provisioning', en cuyo caso las cuentas no serán creadas automáticamente";
+
+
+$string['auth_saml_error_executing'] = "Error al ejecutar ";
+
+$string['auth_saml_mapping_dsn_description'] = 'Cadena del Nombre del Origen de Datos (dsn) para conectar con la base de datos de la asignación de cursos/roles.
+(el dsn debe ser una ruta absoluta en caso de estar usando SQLite)'; 
+
+$string['auth_saml_course_mapping_dsn'] = 'Curso dsn'; 
+$string['auth_saml_role_mapping_dsn'] = 'Rol dsn'; 
+
+$string['auth_saml_course_mapping_sql'] = 'Curso sql'; 
+$string['auth_saml_role_mapping_sql'] = 'Rol sql'; 
+
+$string['auth_saml_mapping_dsn_examples'] = 'mysql://moodleuser:moodlepass@localhost/saml_course_mapping
+sqlite:/<path-to-db>/mapping.sqlite3
+oci8://user:pwd@host/sid
+postgresql7://user:pwd@host/sid
+';
+
+$string['auth_saml_mapping_sql_examples'] = 'SELECT field1 as lms_course_id, field2 as saml_course_id, field3 as saml_course_period FROM course_mapping
+SELECT field1 as lms_role, field2 as saml_role from role_mapping';
+
+
+$string['auth_saml_mapping_external_warning'] = 'Nota: Cuando la base de datos de las correspondencias y de Moodle son del mismo tipo, la conexión falla. Así que en este caso lo mejor es usar una correspondencia de cursos interno y previamente volcar todos los datos dentro de una base de datos manualmente';
+
+$string['auth_saml_errorsamlexternal'] = 'Establece que la asignación de fuente de las correspondencias para el curso y el rol debería ser externo y así podrás específicar todos los parámetros de consultas DSN y SQL.';
+
+$string['auth_saml_sucess_creating_course_mapping'] = 'Tabla de correspondencias de cursos creada en la basa de datos de moodle';
+$string['auth_saml_error_creating_course_mapping'] = 'Error creando correspondencias de cursos en la base de datos de moodle';
+
+$string['auth_saml_sucess_creating_role_mapping'] = 'Tabla de cursos de roles creada en la base de datos de moodle';
+$string['auth_saml_error_creating_role_mapping'] = 'Error creando correspondencias de roles en la base de datos de moodle';
+
+$string['auth_saml_error_executing_course_mapping_query'] ='Error ejecutando la consulta de las correspondencias de los cursos';
+$string['auth_saml_error_attribute_course_mapping'] = 'Error en los nombres de atributo (índices) de la tabla de correspondencias de los cursos. Comprueba la sintaxis de externalcoursemappingsql';
+
+$string['auth_saml_error_executing_role_mapping_query'] ='Error ejecutando la consulta de correspondencias de los roles';
+$string['auth_saml_error_attribute_role_mapping'] = 'Error en los nombres de atributos (índices) de la tabla de correspondencias de rol. Comprueba la sintaxis externalrolemappingsql';
+
+
+$string['auth_saml_error_role_not_found'] = "Error al inscribirse. El rol {\$a} no existe en Moodle";
+
+$string['auth_saml_initialize_roles'] = 'Inicializar roles';
+
+$string['auth_saml_missed_data'] = 'A los siguientes datos les faltan atributos: ';
+
+$string['auth_saml_duplicated_saml_data'] = 'El siguiente dato saml está duplicado: ';
+$string['auth_saml_duplicated_lms_data'] = 'El siguiente dato lms está duplicado: ';
+
+$string['auth_saml_moodle_course_id_field_warning'] = 'Antes de añadir mapeos de los cursos, decide que campo (shortname o numberid del curso) va a ser usado para identificar los cursos de moodle. Una vez decidido salva el formulario y entoncses los valores del shortname o numberid aparecerán en el selector del "Moodle Course Id". Ten en cuenta que el numberid es por defecto opcional en moodle pero debe de ser proporcionado si esta fue la opción elejida (o una opción en blanco aparecerá para ese curso). Si cambias el valor del campo para identificar los cursos despues de registrar mapeos, esos mapeos serán ignorados (pero seguirán almacenados en base de datos)'; 
+
+$string['auth_saml_course_not_found'] = "El curso saml2 {\$a->course} no fué encontrado para el usuario {\$a->user}\n";
+
+$string['auth_saml_disable_debugdisplay'] = ' * Inhabilita debugdisplay para no mostrar errores del proceso de login/matriculación';
+$string['auth_saml_error_authentication_process'] = "Error en el proceso de autenticación {\$a}";
+$string['auth_saml_error_complete_user_data'] = "Error al completar los datos del usuario {\$a}";
+$string['auth_saml_error_complete_user_login'] = "Error al completar el login del usuario {\$a}";
+
+$string['auth_saml_logfile'] = 'Ruta del fichero de log del plugin SAML';
+$string['auth_saml_logfile_description'] = 'Establece un nombre de fichero si tu quieres loggear los errores del plugin saml en un fichero diferente que el syslog (Establece una ruta absoluta o Moodle guardará este fichero dentro de la carpeta moodledata)';
+
+$string['auth_saml_samlhookfile'] = 'Ruta del fichero del hook del plugin SAML';
+$string['auth_saml_samlhookfile_description'] = 'Establece la ruta si quieres usar un fichero hook que contiene tus funciones específicas. La ruta puede ser absoluta o relativa al directorio raíz de Moodle.';
+$string['auth_saml_errorbadhook'] = "Incorrect SAML plugin hook file: {\$a}";
+
+$string['pluginname'] = 'Autenticación SAML';
diff --git a/auth/saml/lang/es_es/auth_saml.php b/auth/saml/lang/es_es/auth_saml.php
new file mode 100755
index 0000000..054f6df
--- /dev/null
+++ b/auth/saml/lang/es_es/auth_saml.php
@@ -0,0 +1,120 @@
+<?php
+
+$string['auth_saml_loginusing'] = 'Accede usando tu nombre de usuario y contraseña';
+
+$string['auth_samltitle']  = 'Autenticación SAML';
+$string['auth_samldescription'] = 'Autenticación SSO usando SimpleSAML';
+
+$string['auth_saml_samllib'] = 'Ruta de librería SimpleSAMLPHP';
+$string['auth_saml_samllib_description'] = 'Ruta de acceso a la librería para el entorno SimpleSAMLPHP que deseas, por ejemplo: /var/www/sp/simplesamlphp/lib';
+$string['auth_saml_errorbadlib'] = "El directorio de la librería SimpleSAMLPHP {\$a} no es correcta";
+
+$string['auth_saml_sp_source'] = 'Fuente SimpleSAMLPHP SP';
+$string['auth_saml_sp_source_description'] = 'Selecciona la fuente SP que quieres conectar a moodle. (Las fuentes están en /config/authsources.php).';
+$string['auth_saml_errorsp_source'] = "La fuente SimpleSAMLPHP {\$a} no es correcta";
+
+$string['auth_saml_db_reset_button'] = 'Pulse para restablecer los valores iniciales';
+$string['auth_saml_db_reset_error'] = 'Error al restablecer los valores del plugin saml';
+
+$string['auth_saml_form_error'] = 'Parece que hay algunos errores en el formulario. Por favor, reviselo para corregirlos';
+
+$string['auth_saml_dosinglelogout'] = 'Deslogue global. Single Log out';
+$string['auth_saml_dosinglelogout_description'] = 'Selecciona para habilitar el deslogueo global (single log out). Al desloguear de Moodle lo harás también del proveedor de identidad y de todos los proveedores de servicios conectados en los que estés logueado';
+
+$string['auth_saml_username'] = 'Correspondencia del nombre de usuario SAML';
+$string['auth_saml_username_description'] = 'Atributo SAML que se asigna como username de Moodle - el valor predeterminado es el eduPersonPrincipalName';
+$string['auth_saml_username_not_found'] = "El IdP ha devuelto un conjunto de datos del usuario que no contiene el campo ({\$a}) que se estableció en la configuración que se usase como username de Moodle. Este campo es obligatorio para loguearte";
+
+$string['auth_saml_supportcourses'] = 'Soportar matriculación SAML';
+$string['auth_saml_supportcourses_description'] = 'Selecciona Interna o Externa para que Moodle a través del plugin enrol/saml automatricule al usuario (Usa Externa si tu asignación de cursos y roles está en una base de datos externa';
+
+$string['auth_saml_courses'] = 'Correspondencia de cursos SAML';
+$string['auth_saml_courses_description'] = 'Atributo SAML que contiene los datos de los cursos (por defecto es schacUserStatus)';
+$string['auth_saml_courses_not_found'] = "El IdP ha devuelto un conjunto de datos que no contiene el campo donde Moodle espera encontrar los cursos ({\$a}). Este campo es obligatorio para automatricular al usuario.";
+
+$string['auth_saml_course_field_id'] = 'Campo utilizado para identificar un curso en Moodle';
+$string['auth_saml_course_field_id_description'] = 'Podemos asociar el curso SAML con el curso Moodle utilizando el nombre corto (shortname) o el  número ID (idnumber)';
+
+
+$string['auth_saml_logo_path'] = 'Imagen SAML';
+$string['auth_saml_logo_path_description'] = 'Ruta de la imagen para el botón de inicio de sesión de SAML';
+
+$string['auth_saml_logo_info'] = 'Descripción del login de SAML';
+$string['auth_saml_logo_info_description'] = 'Descripción que se muestra a continuación del botón de inicio de sesión del SAML';
+
+$string['auth_saml_autologin'] = 'SAML automatic login';
+$string['auth_saml_autologin_description'] = 'Automatically redirect to SAML idP without showing a login form';
+
+$string['auth_saml_ignoreinactivecourses'] = 'Ignorar Inactivos';
+$string['auth_saml_ignoreinactivecourses_description'] = "Si no está activado el plugin dará de baja de los cursos a los usuarios 'inactivos'";
+
+$string['auth_saml_not_authorize'] = "{\$a} no tiene activo ningún curso del Campus Andaluz Virtual";
+
+$string['auth_saml_jit_not_active'] = "La cuenta {\$a} no existe y la provisión automática de usuarios está inhabilitada";
+$string['auth_saml_disablejit'] = "Inhabilitar Provisiomiento automático";
+$string['auth_saml_disablejit_description'] = "Marcalo para inhabilitar el 'just-in-time provisioning', en cuyo caso las cuentas no serán creadas automáticamente";
+
+$string['auth_saml_error_executing'] = "Error al ejecutar ";
+
+$string['auth_saml_mapping_dsn_description'] = 'Cadena del Nombre del Origen de Datos (dsn) para conectar con la base de datos de la asignación de cursos/roles.
+(el dsn debe ser una ruta absoluta en caso de estar usando SQLite)'; 
+
+$string['auth_saml_course_mapping_dsn'] = 'Curso dsn'; 
+$string['auth_saml_role_mapping_dsn'] = 'Rol dsn'; 
+
+$string['auth_saml_course_mapping_sql'] = 'Curso sql'; 
+$string['auth_saml_role_mapping_sql'] = 'Rol sql'; 
+
+$string['auth_saml_mapping_dsn_examples'] = 'mysql://moodleuser:moodlepass@localhost/saml_course_mapping
+sqlite:/<path-to-db>/mapping.sqlite3
+oci8://user:pwd@host/sid
+postgresql7://user:pwd@host/sid
+';
+
+$string['auth_saml_mapping_sql_examples'] = 'SELECT field1 as lms_course_id, field2 as saml_course_id, field3 as saml_course_period FROM course_mapping
+SELECT field1 as lms_role, field2 as saml_role from role_mapping';
+
+
+$string['auth_saml_mapping_external_warning'] = 'Nota: Cuando la base de datos de las correspondencias y de Moodle son del mismo tipo, la conexión falla. Así que en este caso lo mejor es usar una correspondencia de cursos interno y previamente volcar todos los datos dentro de una base de datos manualmente';
+
+$string['auth_saml_errorsamlexternal'] = 'Establece que la asignación de fuente de las correspondencias para el curso y el rol debería ser externo y así podrás específicar todos los parámetros de consultas DSN y SQL.';
+
+$string['auth_saml_sucess_creating_course_mapping'] = 'Tabla de correspondencias de cursos creada en la basa de datos de moodle';
+$string['auth_saml_error_creating_course_mapping'] = 'Error creando correspondencias de cursos en la base de datos de moodle';
+
+$string['auth_saml_sucess_creating_role_mapping'] = 'Tabla de cursos de roles creada en la base de datos de moodle';
+$string['auth_saml_error_creating_role_mapping'] = 'Error creando correspondencias de roles en la base de datos de moodle';
+
+$string['auth_saml_error_executing_course_mapping_query'] ='Error ejecutando la consulta de las correspondencias de los cursos';
+$string['auth_saml_error_attribute_course_mapping'] = 'Error en los nombres de atributo (índices) de la tabla de correspondencias de los cursos. Comprueba la sintaxis de externalcoursemappingsql';
+
+$string['auth_saml_error_executing_role_mapping_query'] ='Error ejecutando la consulta de correspondencias de los roles';
+$string['auth_saml_error_attribute_role_mapping'] = 'Error en los nombres de atributos (índices) de la tabla de correspondencias de rol. Comprueba la sintaxis externalrolemappingsql';
+
+
+$string['auth_saml_error_role_not_found'] = "Error al inscribirse. El rol {\$a} no existe en Moodle";
+
+$string['auth_saml_initialize_roles'] = 'Inicializar roles';
+
+$string['auth_saml_missed_data'] = 'A los siguientes datos les faltan atributos: ';
+
+$string['auth_saml_duplicated_saml_data'] = 'El siguiente dato saml está duplicado: ';
+$string['auth_saml_duplicated_lms_data'] = 'El siguiente dato lms está duplicado: ';
+
+$string['auth_saml_moodle_course_id_field_warning'] = 'Antes de añadir mapeos de los cursos, decide que campo (shortname o numberid del curso) va a ser usado para identificar los cursos de moodle. Una vez decidido salva el formulario y entoncses los valores del shortname o numberid aparecerán en el selector del "Moodle Course Id". Ten en cuenta que el numberid es por defecto opcional en moodle pero debe de ser proporcionado si esta fue la opción elejida (o una opción en blanco aparecerá para ese curso). Si cambias el valor del campo para identificar los cursos despues de registrar mapeos, esos mapeos serán ignorados (pero seguirán almacenados en base de datos)'; 
+
+$string['auth_saml_course_not_found'] = "El curso saml2 {\$a->course} no fué encontrado para el usuario {\$a->user}\n";
+
+$string['auth_saml_disable_debugdisplay'] = ' * Inhabilita debugdisplay para no mostrar errores del proceso de login/matriculación';
+$string['auth_saml_error_authentication_process'] = "Error en el proceso de autenticación {\$a}";
+$string['auth_saml_error_complete_user_data'] = "Error al completar los datos del usuario {\$a}";
+$string['auth_saml_error_complete_user_login'] = "Error al completar el login del usuario {\$a}";
+
+$string['auth_saml_logfile'] = 'Ruta del fichero de log del plugin SAML';
+$string['auth_saml_logfile_description'] = 'Establece un nombre de fichero si tu quieres loggear los errores del plugin saml en un fichero diferente que el syslog (Establece una ruta absoluta o Moodle guardará este fichero dentro de la carpeta moodledata)';
+
+$string['auth_saml_samlhookfile'] = 'Ruta del fichero del hook del plugin SAML';
+$string['auth_saml_samlhookfile_description'] = 'Establece la ruta si quieres usar un fichero hook que contiene tus funciones específicas. La ruta puede ser absoluta o relativa al directorio raíz de Moodle.';
+$string['auth_saml_errorbadhook'] = "Incorrect SAML plugin hook file: {\$a}";
+
+$string['pluginname'] = 'Autenticación SAML';
diff --git a/auth/saml/lang/he/auth_saml.php b/auth/saml/lang/he/auth_saml.php
new file mode 100755
index 0000000..59f7aec
--- /dev/null
+++ b/auth/saml/lang/he/auth_saml.php
@@ -0,0 +1,130 @@
+<?php
+
+$string['auth_saml_loginusing'] = 'כניסת אורחים';
+
+$string['auth_samltitle']  = 'SAML Authentication';
+$string['auth_samldescription'] = 'Single sign-on using SimpleSAMLphp';
+
+$string['auth_saml_samllib'] = 'SimpleSAMLphp library path';
+$string['auth_saml_samllib_description'] = 'Library path for the SimpleSAMLphp environment you want to use, e.g.: /var/www/sp/simplesamlphp/lib.';
+$string['auth_saml_errorbadlib'] = "SimpleSAMLphp lib directory {\$a} is not correct.";
+
+$string['auth_saml_sp_source'] = 'SimpleSAMLphp SP source';
+$string['auth_saml_sp_source_description'] = 'Select the SP source you want to connect to Moodle. (Sources are in /config/authsources.php).';
+$string['auth_saml_errorsp_source'] = "SimpleSAMLphp SP source {\$a} is not correct";
+
+$string['auth_saml_db_reset_button'] = 'Reset values to factory settings';
+$string['auth_saml_db_reset_error'] = 'Error resetting the saml plugin values';
+
+$string['auth_saml_form_error'] = 'There are some errors in the form. Please, see below for correcting them';
+
+$string['auth_saml_dosinglelogout'] = 'Single logout';
+$string['auth_saml_dosinglelogout_description'] = 'Check it to enable the single logout. This will log out you from Moodle, the identity provider and all connected service providers.';
+
+$string['auth_saml_username'] = 'SAML username mapping';
+$string['auth_saml_username_description'] = 'SAML attribute that is mapped to Moodle username - this defaults to eduPersonPrincipalName.';
+$string['auth_saml_username_not_found'] = "IdP returned a set of data that no contain the SAML username mapping field ({\$a}). This field is required to login";
+
+$string['auth_saml_supportcourses'] = 'SAML support courses';
+$string['auth_saml_supportcourses_description'] = 'Select Internal or External to have Moodle auto-enrol users in courses by the enrol/saml plugin. (Use External if your course/role mapping is in an external DB).';
+
+
+$string['auth_saml_disablejit'] = "Disable Just-in-time provisioning";
+$string['auth_saml_disablejit_description'] = "Check it in order to disable the just-in-time provisioning. When JIT is disabled, account will be not created.";
+
+$string['auth_saml_syncusersfrom'] = 'Synchronize users from module';
+$string['auth_saml_syncusersfrom_description'] = 'Synchronize users into Moodle using another module. The users will be created with auth = \'saml\', even though they are actually synchronized by another module. 
+This allows you to create, update and delete users from for example LDAP, but log them in via SAML. Note that the module you wish to sync from must be enabled, and all sync settings should be controlled from that module, not from SAML. 
+To run the synchronization, add auth/saml/cli/sync_users.php to your cron.';
+
+$string['auth_saml_courses'] = 'SAML courses mapping';
+$string['auth_saml_courses_description'] = 'SAML attribute that contains courses data (default to schacUserStatus)';
+$string['auth_saml_courses_not_found'] = "IdP returned a set of data that no contain the SAML courses mapping field ({\$a}). This field is required to enrol the user";
+
+$string['auth_saml_course_field_id'] = 'Field used to identify a course';
+$string['auth_saml_course_field_id_description'] = 'We can map the SAML course with the Moodle Short name or with the Course ID number ';
+
+
+$string['auth_saml_logo_path'] = 'SAML image';
+$string['auth_saml_logo_path_description'] = 'Image path for the SAML login button.';
+
+$string['auth_saml_logo_info'] = 'SAML login description';
+$string['auth_saml_logo_info_description'] = 'Description that will be shown below the SAML login button.';
+
+$string['auth_saml_autologin'] = 'SAML automatic login';
+$string['auth_saml_autologin_description'] = 'Automatically redirect to SAML IdP without showing a login form.';
+
+$string['auth_saml_ignoreinactivecourses'] = 'Ignore Inactive';
+$string['auth_saml_ignoreinactivecourses_description'] = "If not checked the plugin will unenroll the 'inactive' users from courses";
+
+$string['auth_saml_jit_not_active'] = "User account {\$a} does not exists and just-in-time provisioning is disabled";
+
+$string['auth_saml_not_authorize'] = "{\$a} has no active CAV course. ";
+
+$string['auth_saml_error_executing'] = "Error executing ";
+
+$string['auth_saml_mapping_dsn_description'] = 'Data Source Name string for connecting to the course/role mapping database.
+(dsn must be an absolute path in case you are using SQLite)'; 
+
+$string['auth_saml_course_mapping_dsn'] = 'Course dsn'; 
+$string['auth_saml_role_mapping_dsn'] = 'Role dsn'; 
+
+$string['auth_saml_course_mapping_sql'] = 'Course sql'; 
+$string['auth_saml_role_mapping_sql'] = 'Role sql'; 
+
+$string['auth_saml_mapping_dsn_examples'] = 'mysql://moodleuser:moodlepass@localhost/saml_course_mapping
+sqlite:/<path-to-db>/mapping.sqlite3
+oci8://user:pwd@host/sid
+postgresql7://user:pwd@host/sid
+';
+
+$string['auth_saml_mapping_sql_examples'] = 'SELECT field1 as lms_course_id, field2 as saml_course_id, field3 as saml_course_period FROM course_mapping
+SELECT field1 as lms_role, field2 as saml_role from role_mapping';
+
+
+$string['auth_saml_mapping_external_warning'] = 'Note: When database of mappinng and moodle are of the same type, connection fail. So in this case better use the internal coursemapping mode and previously dump all data inside db manually';
+
+$string['auth_saml_errorsamlexternal'] = 'It states that the source mapping for the course and the role would be external and so you must specify all the parameters of the DSN and SQL queries.';
+
+$string['auth_saml_sucess_creating_course_mapping'] = 'Table course_mapping created in moodle database';
+$string['auth_saml_error_creating_course_mapping'] = 'Error creating course_mapping in moodle database';
+
+$string['auth_saml_sucess_creating_role_mapping'] = 'Table course_role created in moodle database';
+$string['auth_saml_error_creating_role_mapping'] = 'Error creating role_mapping in moodle database';
+
+$string['auth_saml_error_executing_course_mapping_query'] ='Error executing the course mapping query';
+$string['auth_saml_error_attribute_course_mapping'] = 'Error in attribute names (index) of course table mapping. Check externalcoursemappingsql syntax';
+
+$string['auth_saml_error_executing_role_mapping_query'] ='Error executing the role mapping query';
+$string['auth_saml_error_attribute_role_mapping'] = 'Error in attribute names (index) of role table mapping. Check externalrolemappingsql syntax';
+
+
+$string['auth_saml_error_role_not_found'] = "Error when enrolling. Role {\$a} not exist in Moodle";
+
+$string['auth_saml_initialize_roles'] = 'Initialize role';
+
+$string['auth_saml_missed_data'] = 'The following data contain missed attributes:  ';
+
+$string['auth_saml_duplicated_saml_data'] = 'The following saml data is duplicated: ';
+$string['auth_saml_duplicated_lms_data'] = 'The following lms data is duplicated: ';
+
+$string['auth_saml_moodle_course_id_field_warning'] = 'Before add any course maping, decide what id field (course shortname or number id) gonna be used to identify the moodle course. Once decided save the form and then short name or number id will appear at the Moodle Course Id select. Take in mind that numberid is by default not required at moodle but you should provide it if that is your selected option (or a blank option will appear for this course). If you switch the value of the field used to identify a course after providing some mappings, those mappings will be ignored (but still stored on the database)';
+
+$string['auth_saml_course_not_found'] = "Course saml {\$a->course} not found for the saml user {\$a->user}\n";
+
+$string['auth_saml_disable_debugdisplay'] = ' * Disable debugdisplay in order to hide errors in the login/enrollment process';
+$string['auth_saml_error_authentication_process'] = "Error in authentication process of {\$a}";
+$string['auth_saml_error_complete_user_data'] = "Failed to complete user data of {\$a}";
+$string['auth_saml_error_complete_user_login'] = "Failed to complete user login of {\$a}";
+
+$string['auth_saml_logfile'] = 'Log file path';
+$string['auth_saml_logfile_description'] = 'Set a filename if you want log the SAML plugin errors in a different file that the syslog. (Use an absolute path or Moodle will save this file in the moodledata folder).';
+
+$string['auth_saml_samlhookfile'] = 'Hook file path';
+$string['auth_saml_samlhookfile_description'] = 'Set a path if you want to use a hook file that contain your specific functions. The path can either be absolute or relative to your Moodle root directory.';
+$string['auth_saml_errorbadhook'] = "Incorrect SAML plugin hook file: {\$a}";
+
+$string['pluginname'] = 'SAML Authentication';
+$string['pluginnotenabled'] = 'Plugin not enabled!';
+$string['syncfromnotenabled'] = 'No external plugin selected. SAML cannot synchronize users on its own.';
+$string['unknownplugin'] = 'SAML does not know how to invoke the sync_users method of the specified plugin: ';
diff --git a/auth/saml/login.php b/auth/saml/login.php
new file mode 100755
index 0000000..b769b60
--- /dev/null
+++ b/auth/saml/login.php
@@ -0,0 +1,193 @@
+<?php
+
+include_once("../../config.php");
+
+global $CFG, $PAGE, $OUTPUT;
+
+//HTTPS is required in this page when $CFG->loginhttps enabled
+$PAGE->https_required();
+
+// get wantsurl from session and pass to the samlUrl
+$samlUrl = "index.php";
+if(isset($SESSION->wantsurl)) {
+    $samlUrl = $samlUrl . "?wantsurl=" . urlencode($SESSION->wantsurl);
+}
+
+// if autologin is enabled redirect to the idp without showing the login form
+$saml_config = get_config('auth/saml');
+if(isset($saml_config->autologin)  && $saml_config->autologin)
+{
+       header('Location: '.$samlUrl);
+       exit;
+}
+
+$context = CONTEXT_SYSTEM::instance();
+$PAGE->set_url("$CFG->httpswwwroot/auth/saml/login.php");
+$PAGE->set_context($context);
+$PAGE->set_pagelayout('login');
+
+
+/// Define variables used in page
+$site = get_site();
+
+if (!empty($CFG->registerauth) or is_enabled_auth('none') or !empty($CFG->auth_instructions)) {
+    $show_instructions = true;
+} else {
+    $show_instructions = false;
+}
+
+$loginsite = get_string("loginsite");
+$PAGE->navbar->add($loginsite);
+
+$PAGE->set_title("$site->fullname: $loginsite");
+$PAGE->set_heading("$site->fullname");
+
+echo $OUTPUT->header();
+
+if ($show_instructions) {
+    $columns = 'twocolumns';
+} else {
+    $columns = 'onecolumn';
+}
+
+if (empty($CFG->xmlstrictheaders) and !empty($CFG->loginpasswordautocomplete)) {
+    $autocomplete = 'autocomplete="off"';
+} else {
+    $autocomplete = '';
+}
+?>
+<div class="loginbox clearfix <?php echo $columns ?>">
+  <div class="loginpanel">
+<?php
+  if (($CFG->registerauth == 'email') || !empty($CFG->registerauth)) { ?>
+      <div class="skiplinks"><a class="skip" href="<?php echo $CFG->httpswwwroot; ?>/login/signup.php"><?php print_string("tocreatenewaccount"); ?></a></div>
+<?php
+  } ?>
+    <h2><?php print_string("returningtosite") ?></h2>
+
+<?php
+
+$saml_config = get_config('auth/saml');
+$authsequence = get_enabled_auth_plugins(true);
+
+$frm = data_submitted();
+
+echo '<center>';
+
+if (in_array('saml', $authsequence)){
+    if (isset($saml_config->samllogoimage) && $saml_config->samllogoimage != NULL) {
+        echo '<a href="' . $samlUrl . '"><img src="'.$saml_config->samllogoimage.'" border="0" alt="SAML login" ></a>';
+    }
+    if (isset($saml_config->samllogoinfo)) {
+        echo "<div class='desc'>$saml_config->samllogoinfo</div>";
+    }
+}
+echo '</center>';
+
+?>
+      <div class="subcontent loginsub">
+        <div class="desc">
+          <?php
+            print_string("auth_saml_loginusing", "auth_saml");
+            echo '<br/>';
+            //echo '('.get_string("cookiesenabled").')';
+            //echo $OUTPUT->help_icon('cookiesenabled');
+           ?>
+        </div>
+        <?php
+          if (!empty($errormsg)) {
+              echo '<div class="loginerrors">';
+              echo $OUTPUT->error_text($errormsg);
+              echo '</div>';
+          }
+        ?>
+        <form action="<?php echo $CFG->httpswwwroot; ?>/login/index.php" method="post" id="login" <?php echo $autocomplete; ?> >
+          <div class="loginform">
+            <div class="form-label"><label for="username"><?php print_string("username") ?></label></div>
+            <div class="form-input">
+              <input type="text" name="username" id="username" size="15" value="<?php echo isset($frm->username)? $frm->username: ''; ?>" />
+            </div>
+            <div class="clearer"><!-- --></div>
+            <div class="form-label"><label for="password"><?php print_string("password") ?></label></div>
+            <div class="form-input">
+              <input type="password" name="password" id="password" size="15" value="" <?php echo $autocomplete; ?> />
+              <input type="submit" id="loginbtn" value="<?php print_string("login") ?>" />
+            </div>
+          </div>
+            <div class="clearer"><!-- --></div>
+              <?php if (isset($CFG->rememberusername) and $CFG->rememberusername == 2) { ?>
+              <div class="rememberpass">
+                  <input type="checkbox" name="rememberusername" id="rememberusername" value="1" <?php if (isset($frm->username)) {echo 'checked="checked"';} ?> />
+                  <label for="rememberusername"><?php print_string('rememberusername', 'admin') ?></label>
+              </div>
+              <?php } ?>
+          <div class="clearer"><!-- --></div>
+          <div class="forgetpass"><a href="<?php echo $CFG->httpswwwroot; ?>/login/forgot_password.php"><?php print_string("forgotten") ?></a></div>
+        </form>
+      </div>
+
+<?php if ($CFG->guestloginbutton and !isguestuser()) {  ?>
+      <div class="subcontent guestsub">
+        <div class="desc">
+          <?php print_string("someallowguest") ?>
+        </div>
+        <form action="<?php echo $CFG->httpswwwroot; ?>/login/index.php" method="post" id="guestlogin">
+          <div class="guestform">
+            <input type="hidden" name="username" value="guest" />
+            <input type="hidden" name="password" value="guest" />
+            <input type="submit" value="<?php print_string("loginguest") ?>" />
+          </div>
+        </form>
+      </div>
+<?php } ?>
+     </div>
+<?php if ($show_instructions) { ?>
+    <div class="signuppanel">
+      <h2><?php print_string("firsttime") ?></h2>
+      <div class="subcontent">
+<?php     if (is_enabled_auth('none')) { // instructions override the rest for security reasons
+              print_string("loginstepsnone");
+          } else if ($CFG->registerauth == 'email') {
+              if (!empty($CFG->auth_instructions)) {
+                  echo format_text($CFG->auth_instructions);
+              } else {
+                  print_string("loginsteps", "", "signup.php");
+              } ?>
+                 <div class="signupform">
+                   <form action="<?php echo $CFG->httpswwwroot; ?>/login/signup.php" method="get" id="signup">
+                   <div><input type="submit" value="<?php print_string("startsignup") ?>" /></div>
+                   </form>
+                 </div>
+<?php     } else if (!empty($CFG->registerauth)) {
+              echo format_text($CFG->auth_instructions); ?>
+              <div class="signupform">
+                <form action="<?php echo $CFG->httpswwwroot; ?>/login/signup.php" method="get" id="signup">
+                <div><input type="submit" value="<?php print_string("startsignup") ?>" /></div>
+                </form>
+              </div>
+<?php     } else {
+              echo format_text($CFG->auth_instructions);
+          } ?>
+      </div>
+    </div>
+<?php } ?>
+<?php if (!empty($potentialidps)) { ?>
+    <div class="subcontent potentialidps">
+        <h6><?php print_string('potentialidps', 'auth'); ?></h6>
+        <div class="potentialidplist">
+<?php foreach ($potentialidps as $idp) {
+    echo  '<div class="potentialidp"><a href="' . $idp['url']->out() . '" title="' . $idp['name'] . '">' . $OUTPUT->render($idp['icon'], $idp['name']) . '&nbsp;' . $idp['name'] . '</a></div>';
+} ?>
+        </div>
+    </div>
+<?php } ?>
+</div>
+
+<?php
+
+if (!empty($CFG->loginpageautofocus)) {
+    //focus username or password
+    $PAGE->requires->js_init_call('M.util.focus_login_form', null, true);
+}
+
+echo $OUTPUT->footer();
diff --git a/auth/saml/logo.gif b/auth/saml/logo.gif
new file mode 100755
index 0000000000000000000000000000000000000000..a4e6a1a2af8a974b1b5ebd4ed97d2c1ee67606ed
GIT binary patch
literal 5240
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

literal 0
HcmV?d00001

diff --git a/auth/saml/moodle_auth_saml.txt b/auth/saml/moodle_auth_saml.txt
new file mode 100755
index 0000000..26d57d8
--- /dev/null
+++ b/auth/saml/moodle_auth_saml.txt
@@ -0,0 +1,154 @@
+SAML Authentication for Moodle
+------------------------------
+
+SAML for Moodle is an open-source implementation for federated identity-based authentication infrastructure based on Security Assertion Markup Language (SAML) that allows the Moodle users log in through simpleSAMLphp.
+
+This plugin add SAML support to Moodle (SP) and require a [simpleSAMLphp instance to be configured as SP](https://simplesamlphp.org/docs/stable/simplesamlphp-sp)
+
+It works with Moodle 2.X and it was tested with 3.1.3
+
+Install Instruction
+-------------------
+
+  1. Unpack this directory into a /auth/saml directory as you would for any Moodle auth module
+     (http://docs.moodle.org/en/Installing_contributed_modules_or_plugins).
+
+  2. Login to Moodle as an administrator, and activate the module by navigating 
+     Site administration->Plugins->Manage authentication->SAML Authentication     
+
+
+  3. Let priivileges to the server user to write over the auth/saml/saml_config.php
+     file.
+
+Configuration
+-------------
+After the installation we must configure the saml plugin, so go to "Settings"
+if you are in "Manage Authentication" page, or you can also go to
+Users > Authentication > SAML Authentication. These are the fields of thi
+form:
+
+     - simpleSAMLphp Path: it will not work unless you specify the saml library
+     path. This refers to the library path for the simpleSAMLphp environment
+     you want to use. For example: /var/simplesamlphp/lib
+
+     - SAML username mapping: it is a SAML attribute that will be mapped to
+     the Moodle username. By default, this attribute will be set to 'mail'.
+
+     - Single Log out: Enable/disable the single logout. This will log out you
+     from moodle, identity provider and all conected service providers
+
+     - SAML Image: when you enable the SAML authentication plugin, a new
+     button will be shown in the login Moodle page that allows to authenticate
+     via SAML. By default, the simpleSAMLphp image (something like a fish) will
+     be shown, but you can specify another one you want to use.
+     Note: this image needs to exist in the server as it is not possible to
+     upload an image through the form right now.
+
+     - SAML login description: you can also specify a description text for the
+     previous button. This description will be shown below the SAML image in
+     the login Moodle page.
+
+     - Log file path: this is the absolute path of a file where the
+     plugin will log information about its actions. It is optional.
+
+     - Hook file path: this is the absolute path of a file with php functions
+     that will be called to alter the default behaviour of this plugin. See
+     the file custom_hook.php for more information.
+
+     - SAML support Courses: You will need to configure the Curse and Role mapping if you plan to use the enrol/saml plugin. This select has three options:
+        - No suport (default value): the plugin will not define course/role mapping (enrol/saml plugin not installed, support for enrolling the user into courses automatically not required).
+        - Internal: the plugin will use an internal database table to map
+        the courses in the next field with Moodle courses
+        - External: the plugin will use a tabla in an external database
+        to map the courses in the next field with Moodle courses.
+
+     - Synchronize users from module: The SAML module does not have direct support for synchronizing users, because SAML does not allow querying for all users at once. However, your underlying identify provider might support it (LDAP does for example). This option lists all enabled plugins which have a `sync_users` function. This means that we will use that plugin's code to fetch the user data, but the users will be created with auth='saml'
+
+     - SAML courses mapping: it is a SAML attribute that is mapped to Moodle
+     courses data. By default, it is set to 'schacUserStatus'.
+
+     - Field used to identify a course: this can be the Short Name or the
+     Number ID and referes to the Moodle field used to identify a course
+     during the matching phase of the plugin.
+
+     - Ignore inactive courses: if this field is checked the user will stay
+     in previous enrolled courses even if the status of the course is
+     inactive in the SAML attribute.
+
+     - Data Mapping section:
+    ........................
+    The Identity Provider (IdP) provides some user's data such as the first
+    name, surname, email address, etc. In this section, you can specify the
+    correspondence with the same data in Moodle. By default, the configuration
+    is set as is shown below:
+
+        First name    = cn
+        Surname       = sn
+        Email Address = mail
+
+    - Course Mapping section:
+    .........................
+    The course mapping section allows the administrator to link saml courses
+    and moodle courses. To make it working we need to create an intermediate
+    database on where we can store this data. This database will have the
+    following internal structure:
+
+    +--------------------+-------------+------+-----+---------+----------------+
+    | Field              | Type        | Null | Key | Default | Extra          |
+    +--------------------+-------------+------+-----+---------+----------------+
+    | course_mapping_id  | int(11)     | NO   | PRI | NULL    | auto_increment |
+    | saml_course_id     | varchar(20) | NO   |     | NULL    |                |
+    | saml_course_period | int(4)      | NO   |     | NULL    |                |
+    | lms_course_id      | text        | NO   |     | NULL    |                |
+    +--------------------+-------------+------+-----+---------+----------------+
+
+    Once we already have created the database, we need to specify the DSN (Data
+    Source Name) that has the following syntax:
+
+        MySQL
+        -----
+        mysql://user:password@host/database_name
+
+        SQLite
+        ------
+        sqlite:///path/to/database/file
+
+        PostgresSQL
+        -----------
+        postgres://user:password@host/database_name
+
+
+    Below the database DSN field we can start introducing course mappings
+    between Moodle and SAML courses.
+    No field can be null, if you try to introduce a null course mapping, this
+    data will be ignored and it will not be saved in the database.
+    If you try to introduce a duplicate course mapping this data will not be
+    saved in the database and you will be redirected to the form showing an
+    error.
+    If you want to delete a course mapping you must only check the
+    corresponding checkbox to the left and clicking to 'delete' button.
+    Also, you can update the previous introduced course mappings in every
+    moment if the new data doesn't conflicts with none of the previous
+    course mappings.
+    Is possible to introduce several course mappings at the same time, you can
+    add a new row by clicking in '+' button to the right. It no errors happen
+    while introducing the course mappings, you will be redirected to the
+    'Manage Authentication' page as with any other field of the form.
+
+
+Internal Changes
+----------------
+
+- The 'config.html' file was renamed to 'config.php' because it now has PHP
+  code.
+- Two new files was created in SAML plugin directory:
+    - 'courses.php': this file contains the needed PHP code for showing the new
+    'Course mapping' table.
+    - 'DBNewDatabase.php': this file contains a tiny function for creating a
+    database connection, because it seems there is a bug when you try to open
+    a SQLite database connection using a DSN.
+
+- In 'auth.php' we have used 'validate_form' for validating the form and store
+the errors, and 'process_config' for saving the data into the database if
+there are no errors. Also, 'sync_roles' function have been modified for
+mapping roles and courses.
\ No newline at end of file
diff --git a/auth/saml/portal-login.jpg b/auth/saml/portal-login.jpg
new file mode 100755
index 0000000000000000000000000000000000000000..27713f59a810b57fa82e11c58f4d7136ca4ed826
GIT binary patch
literal 12940
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
Ze-=i66<LIG2?S88?!1t@T7FM+{|gB#m&yPD

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_flat_0_aaaaaa_40x100.png b/auth/saml/resources/images/ui-bg_flat_0_aaaaaa_40x100.png
new file mode 100755
index 0000000000000000000000000000000000000000..5b5dab2ab7b1c50dea9cfe73dc5a269a92d2d4b4
GIT binary patch
literal 180
zcmeAS@N?(olHy`uVBq!ia0vp^8bF-F!3HG1q!d*FscKIb$B>N1x91EQ4=4yQ7#`R^
z$vje}<irI&an_s0pV!D+$FtuP31JO&3=I&aE+u|=5A)Hv$*VMh&S3C#^>bP0l+XkK
DSH>_4

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_flat_75_ffffff_40x100.png b/auth/saml/resources/images/ui-bg_flat_75_ffffff_40x100.png
new file mode 100755
index 0000000000000000000000000000000000000000..ac8b229af950c29356abf64a6c4aa894575445f0
GIT binary patch
literal 178
zcmeAS@N?(olHy`uVBq!ia0vp^8bF-F!3HG1q!d*FsY*{5$B>N1x91EQ4=4yQYz+E8
zPo9&<{J;c_6SHRil>2s{Zw^OT)6@jj2u|u!(plXsM>LJD`vD!n;OXk;vd$@?2>^GI
BH@yG=

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_glass_55_fbf9ee_1x400.png b/auth/saml/resources/images/ui-bg_glass_55_fbf9ee_1x400.png
new file mode 100755
index 0000000000000000000000000000000000000000..ad3d6346e00f246102f72f2e026ed0491988b394
GIT binary patch
literal 120
zcmeAS@N?(olHy`uVBq!ia0vp^j6gJjgAK^akKnour0hLi978O6-<~(*I$*%ybaDOn
z{W;e!B}_MSUQoPXhYd^Y6RUoS1yepnPx`2Kz)7OXQG!!=-jY=F+d2OOy?#DnJ32>z
UEim$g7SJdLPgg&ebxsLQ09~*s;{X5v

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_glass_65_ffffff_1x400.png b/auth/saml/resources/images/ui-bg_glass_65_ffffff_1x400.png
new file mode 100755
index 0000000000000000000000000000000000000000..42ccba269b6e91bef12ad0fa18be651b5ef0ee68
GIT binary patch
literal 105
zcmeAS@N?(olHy`uVBq!ia0vp^j6gJjgAK^akKnouqzpV=978O6-=0?FV^9z|eBtf=
z|7WztIJ;WT>{+tN>ySr~=F{k$>;_x^_y?afmf9pRKH0)6?eSP?3s5hEr>mdKI;Vst
E0O<Z9>;M1&

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_glass_75_dadada_1x400.png b/auth/saml/resources/images/ui-bg_glass_75_dadada_1x400.png
new file mode 100755
index 0000000000000000000000000000000000000000..5a46b47cb16631068aee9e0bd61269fc4e95e5cd
GIT binary patch
literal 111
zcmeAS@N?(olHy`uVBq!ia0vp^j6gJjgAK^akKnouq|7{B978O6lPf+wIa#m9#>Unb
zm^4K~wN3Zq+uP<E-4iDYHYX${Ii)G?xY5!0{fvg8SC7yQ4u<2&oOc%dd<Zm-fx*+&
K&t;ucLK6Ud-y?JY

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_glass_75_e6e6e6_1x400.png b/auth/saml/resources/images/ui-bg_glass_75_e6e6e6_1x400.png
new file mode 100755
index 0000000000000000000000000000000000000000..86c2baa655eac8539db34f8d9adb69ec1226201c
GIT binary patch
literal 110
zcmeAS@N?(olHy`uVBq!ia0vp^j6gJjgAK^akKnouq)a_s978O6-<~$)Vo(rZKDhVK
z|J9WTLT^QIG;Q^ml{ow8HvtEZhta#LLqp$|vO7%bGjI7IBizcw`SFI!bT^;@44$rj
JF6*2UngEbSBdP!Z

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_glass_75_ffffff_1x400.png b/auth/saml/resources/images/ui-bg_glass_75_ffffff_1x400.png
new file mode 100755
index 0000000000000000000000000000000000000000..e65ca1297c7b0fca6d0d10c4c5475b8c20cf0e62
GIT binary patch
literal 107
zcmeAS@N?(olHy`uVBq!ia0vp^j6gJjgAK^akKnouq>MaW978O6-<~?i$)F&>d~nX+
z>vO)oJQ&&FVaKefeOt$qOR>f~^ebnN_=~%qdHEa<EzM*v3QM<K=@A9$X7F_Nb6Mw<
G&;$VN7$B1X

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_highlight-soft_75_cccccc_1x100.png b/auth/saml/resources/images/ui-bg_highlight-soft_75_cccccc_1x100.png
new file mode 100755
index 0000000000000000000000000000000000000000..7c9fa6c6edcfcdd3e5b77e6f547b719e6fc66e30
GIT binary patch
literal 101
zcmeAS@N?(olHy`uVBq!ia0vp^j6j^i!3HGVb)pi0l#Zv1V~E7m<ccpZF4n8Dv9Yx&
zy8QY7U*2m$;l+;n|NjK_PainIAnKgVYt6(keT9{lbLSy{pgsmqS3j3^P6<r_2PGZu

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-bg_inset-soft_95_fef1ec_1x100.png b/auth/saml/resources/images/ui-bg_inset-soft_95_fef1ec_1x100.png
new file mode 100755
index 0000000000000000000000000000000000000000..0e05810fffe0b6b8ac320e55d1eb4ba259b89d92
GIT binary patch
literal 123
zcmeAS@N?(olHy`uVBq!ia0vp^j6j^i!3HGVb)pi0l#{26V~E7myXUR>S{Ou}E*`%9
zKPdOkfrN+ZlHSt7(uY{3{#;wiJb&Ugx1>W4qtrSDm(4hFaaY-$3p3x|sIU3`%J?Qj
YcLn#R=pC)AfTl5cy85}Sb4q9e0MP_2(*OVf

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-icons_222222_256x240.png b/auth/saml/resources/images/ui-icons_222222_256x240.png
new file mode 100755
index 0000000000000000000000000000000000000000..ee039dc096a38a3753f92519546eee94bcfbeffa
GIT binary patch
literal 4369
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

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-icons_2e83ff_256x240.png b/auth/saml/resources/images/ui-icons_2e83ff_256x240.png
new file mode 100755
index 0000000000000000000000000000000000000000..45e8928e5284adacea3f9ec07b9b50667d2ac65f
GIT binary patch
literal 4369
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

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-icons_454545_256x240.png b/auth/saml/resources/images/ui-icons_454545_256x240.png
new file mode 100755
index 0000000000000000000000000000000000000000..7ec70d11bfb2f77374dfd00ef61ba0c3647b5a0c
GIT binary patch
literal 4369
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

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-icons_888888_256x240.png b/auth/saml/resources/images/ui-icons_888888_256x240.png
new file mode 100755
index 0000000000000000000000000000000000000000..5ba708c39172a69e069136bd1309c4322c61f571
GIT binary patch
literal 4369
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

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/images/ui-icons_cd0a0a_256x240.png b/auth/saml/resources/images/ui-icons_cd0a0a_256x240.png
new file mode 100755
index 0000000000000000000000000000000000000000..7930a558099bc8d92b4264eb67a0f040460f4a4f
GIT binary patch
literal 4369
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

literal 0
HcmV?d00001

diff --git a/auth/saml/resources/jquery-1.3.2.min.js b/auth/saml/resources/jquery-1.3.2.min.js
new file mode 100755
index 0000000..b1ae21d
--- /dev/null
+++ b/auth/saml/resources/jquery-1.3.2.min.js
@@ -0,0 +1,19 @@
+/*
+ * jQuery JavaScript Library v1.3.2
+ * http://jquery.com/
+ *
+ * Copyright (c) 2009 John Resig
+ * Dual licensed under the MIT and GPL licenses.
+ * http://docs.jquery.com/License
+ *
+ * Date: 2009-02-19 17:34:21 -0500 (Thu, 19 Feb 2009)
+ * Revision: 6246
+ */
+(function(){var l=this,g,y=l.jQuery,p=l.$,o=l.jQuery=l.$=function(E,F){return new o.fn.init(E,F)},D=/^[^<]*(<(.|\s)+>)[^>]*$|^#([\w-]+)$/,f=/^.[^:#\[\.,]*$/;o.fn=o.prototype={init:function(E,H){E=E||document;if(E.nodeType){this[0]=E;this.length=1;this.context=E;return this}if(typeof E==="string"){var G=D.exec(E);if(G&&(G[1]||!H)){if(G[1]){E=o.clean([G[1]],H)}else{var I=document.getElementById(G[3]);if(I&&I.id!=G[3]){return o().find(E)}var F=o(I||[]);F.context=document;F.selector=E;return F}}else{return o(H).find(E)}}else{if(o.isFunction(E)){return o(document).ready(E)}}if(E.selector&&E.context){this.selector=E.selector;this.context=E.context}return this.setArray(o.isArray(E)?E:o.makeArray(E))},selector:"",jquery:"1.3.2",size:function(){return this.length},get:function(E){return E===g?Array.prototype.slice.call(this):this[E]},pushStack:function(F,H,E){var G=o(F);G.prevObject=this;G.context=this.context;if(H==="find"){G.selector=this.selector+(this.selector?" ":"")+E}else{if(H){G.selector=this.selector+"."+H+"("+E+")"}}return G},setArray:function(E){this.length=0;Array.prototype.push.apply(this,E);return this},each:function(F,E){return o.each(this,F,E)},index:function(E){return o.inArray(E&&E.jquery?E[0]:E,this)},attr:function(F,H,G){var E=F;if(typeof F==="string"){if(H===g){return this[0]&&o[G||"attr"](this[0],F)}else{E={};E[F]=H}}return this.each(function(I){for(F in E){o.attr(G?this.style:this,F,o.prop(this,E[F],G,I,F))}})},css:function(E,F){if((E=="width"||E=="height")&&parseFloat(F)<0){F=g}return this.attr(E,F,"curCSS")},text:function(F){if(typeof F!=="object"&&F!=null){return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(F))}var E="";o.each(F||this,function(){o.each(this.childNodes,function(){if(this.nodeType!=8){E+=this.nodeType!=1?this.nodeValue:o.fn.text([this])}})});return E},wrapAll:function(E){if(this[0]){var F=o(E,this[0].ownerDocument).clone();if(this[0].parentNode){F.insertBefore(this[0])}F.map(function(){var G=this;while(G.firstChild){G=G.firstChild}return G}).append(this)}return this},wrapInner:function(E){return this.each(function(){o(this).contents().wrapAll(E)})},wrap:function(E){return this.each(function(){o(this).wrapAll(E)})},append:function(){return this.domManip(arguments,true,function(E){if(this.nodeType==1){this.appendChild(E)}})},prepend:function(){return this.domManip(arguments,true,function(E){if(this.nodeType==1){this.insertBefore(E,this.firstChild)}})},before:function(){return this.domManip(arguments,false,function(E){this.parentNode.insertBefore(E,this)})},after:function(){return this.domManip(arguments,false,function(E){this.parentNode.insertBefore(E,this.nextSibling)})},end:function(){return this.prevObject||o([])},push:[].push,sort:[].sort,splice:[].splice,find:function(E){if(this.length===1){var F=this.pushStack([],"find",E);F.length=0;o.find(E,this[0],F);return F}else{return this.pushStack(o.unique(o.map(this,function(G){return o.find(E,G)})),"find",E)}},clone:function(G){var E=this.map(function(){if(!o.support.noCloneEvent&&!o.isXMLDoc(this)){var I=this.outerHTML;if(!I){var J=this.ownerDocument.createElement("div");J.appendChild(this.cloneNode(true));I=J.innerHTML}return o.clean([I.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/^\s*/,"")])[0]}else{return this.cloneNode(true)}});if(G===true){var H=this.find("*").andSelf(),F=0;E.find("*").andSelf().each(function(){if(this.nodeName!==H[F].nodeName){return}var I=o.data(H[F],"events");for(var K in I){for(var J in I[K]){o.event.add(this,K,I[K][J],I[K][J].data)}}F++})}return E},filter:function(E){return this.pushStack(o.isFunction(E)&&o.grep(this,function(G,F){return E.call(G,F)})||o.multiFilter(E,o.grep(this,function(F){return F.nodeType===1})),"filter",E)},closest:function(E){var G=o.expr.match.POS.test(E)?o(E):null,F=0;return this.map(function(){var H=this;while(H&&H.ownerDocument){if(G?G.index(H)>-1:o(H).is(E)){o.data(H,"closest",F);return H}H=H.parentNode;F++}})},not:function(E){if(typeof E==="string"){if(f.test(E)){return this.pushStack(o.multiFilter(E,this,true),"not",E)}else{E=o.multiFilter(E,this)}}var F=E.length&&E[E.length-1]!==g&&!E.nodeType;return this.filter(function(){return F?o.inArray(this,E)<0:this!=E})},add:function(E){return this.pushStack(o.unique(o.merge(this.get(),typeof E==="string"?o(E):o.makeArray(E))))},is:function(E){return !!E&&o.multiFilter(E,this).length>0},hasClass:function(E){return !!E&&this.is("."+E)},val:function(K){if(K===g){var E=this[0];if(E){if(o.nodeName(E,"option")){return(E.attributes.value||{}).specified?E.value:E.text}if(o.nodeName(E,"select")){var I=E.selectedIndex,L=[],M=E.options,H=E.type=="select-one";if(I<0){return null}for(var F=H?I:0,J=H?I+1:M.length;F<J;F++){var G=M[F];if(G.selected){K=o(G).val();if(H){return K}L.push(K)}}return L}return(E.value||"").replace(/\r/g,"")}return g}if(typeof K==="number"){K+=""}return this.each(function(){if(this.nodeType!=1){return}if(o.isArray(K)&&/radio|checkbox/.test(this.type)){this.checked=(o.inArray(this.value,K)>=0||o.inArray(this.name,K)>=0)}else{if(o.nodeName(this,"select")){var N=o.makeArray(K);o("option",this).each(function(){this.selected=(o.inArray(this.value,N)>=0||o.inArray(this.text,N)>=0)});if(!N.length){this.selectedIndex=-1}}else{this.value=K}}})},html:function(E){return E===g?(this[0]?this[0].innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,""):null):this.empty().append(E)},replaceWith:function(E){return this.after(E).remove()},eq:function(E){return this.slice(E,+E+1)},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments),"slice",Array.prototype.slice.call(arguments).join(","))},map:function(E){return this.pushStack(o.map(this,function(G,F){return E.call(G,F,G)}))},andSelf:function(){return this.add(this.prevObject)},domManip:function(J,M,L){if(this[0]){var I=(this[0].ownerDocument||this[0]).createDocumentFragment(),F=o.clean(J,(this[0].ownerDocument||this[0]),I),H=I.firstChild;if(H){for(var G=0,E=this.length;G<E;G++){L.call(K(this[G],H),this.length>1||G>0?I.cloneNode(true):I)}}if(F){o.each(F,z)}}return this;function K(N,O){return M&&o.nodeName(N,"table")&&o.nodeName(O,"tr")?(N.getElementsByTagName("tbody")[0]||N.appendChild(N.ownerDocument.createElement("tbody"))):N}}};o.fn.init.prototype=o.fn;function z(E,F){if(F.src){o.ajax({url:F.src,async:false,dataType:"script"})}else{o.globalEval(F.text||F.textContent||F.innerHTML||"")}if(F.parentNode){F.parentNode.removeChild(F)}}function e(){return +new Date}o.extend=o.fn.extend=function(){var J=arguments[0]||{},H=1,I=arguments.length,E=false,G;if(typeof J==="boolean"){E=J;J=arguments[1]||{};H=2}if(typeof J!=="object"&&!o.isFunction(J)){J={}}if(I==H){J=this;--H}for(;H<I;H++){if((G=arguments[H])!=null){for(var F in G){var K=J[F],L=G[F];if(J===L){continue}if(E&&L&&typeof L==="object"&&!L.nodeType){J[F]=o.extend(E,K||(L.length!=null?[]:{}),L)}else{if(L!==g){J[F]=L}}}}}return J};var b=/z-?index|font-?weight|opacity|zoom|line-?height/i,q=document.defaultView||{},s=Object.prototype.toString;o.extend({noConflict:function(E){l.$=p;if(E){l.jQuery=y}return o},isFunction:function(E){return s.call(E)==="[object Function]"},isArray:function(E){return s.call(E)==="[object Array]"},isXMLDoc:function(E){return E.nodeType===9&&E.documentElement.nodeName!=="HTML"||!!E.ownerDocument&&o.isXMLDoc(E.ownerDocument)},globalEval:function(G){if(G&&/\S/.test(G)){var F=document.getElementsByTagName("head")[0]||document.documentElement,E=document.createElement("script");E.type="text/javascript";if(o.support.scriptEval){E.appendChild(document.createTextNode(G))}else{E.text=G}F.insertBefore(E,F.firstChild);F.removeChild(E)}},nodeName:function(F,E){return F.nodeName&&F.nodeName.toUpperCase()==E.toUpperCase()},each:function(G,K,F){var E,H=0,I=G.length;if(F){if(I===g){for(E in G){if(K.apply(G[E],F)===false){break}}}else{for(;H<I;){if(K.apply(G[H++],F)===false){break}}}}else{if(I===g){for(E in G){if(K.call(G[E],E,G[E])===false){break}}}else{for(var J=G[0];H<I&&K.call(J,H,J)!==false;J=G[++H]){}}}return G},prop:function(H,I,G,F,E){if(o.isFunction(I)){I=I.call(H,F)}return typeof I==="number"&&G=="curCSS"&&!b.test(E)?I+"px":I},className:{add:function(E,F){o.each((F||"").split(/\s+/),function(G,H){if(E.nodeType==1&&!o.className.has(E.className,H)){E.className+=(E.className?" ":"")+H}})},remove:function(E,F){if(E.nodeType==1){E.className=F!==g?o.grep(E.className.split(/\s+/),function(G){return !o.className.has(F,G)}).join(" "):""}},has:function(F,E){return F&&o.inArray(E,(F.className||F).toString().split(/\s+/))>-1}},swap:function(H,G,I){var E={};for(var F in G){E[F]=H.style[F];H.style[F]=G[F]}I.call(H);for(var F in G){H.style[F]=E[F]}},css:function(H,F,J,E){if(F=="width"||F=="height"){var L,G={position:"absolute",visibility:"hidden",display:"block"},K=F=="width"?["Left","Right"]:["Top","Bottom"];function I(){L=F=="width"?H.offsetWidth:H.offsetHeight;if(E==="border"){return}o.each(K,function(){if(!E){L-=parseFloat(o.curCSS(H,"padding"+this,true))||0}if(E==="margin"){L+=parseFloat(o.curCSS(H,"margin"+this,true))||0}else{L-=parseFloat(o.curCSS(H,"border"+this+"Width",true))||0}})}if(H.offsetWidth!==0){I()}else{o.swap(H,G,I)}return Math.max(0,Math.round(L))}return o.curCSS(H,F,J)},curCSS:function(I,F,G){var L,E=I.style;if(F=="opacity"&&!o.support.opacity){L=o.attr(E,"opacity");return L==""?"1":L}if(F.match(/float/i)){F=w}if(!G&&E&&E[F]){L=E[F]}else{if(q.getComputedStyle){if(F.match(/float/i)){F="float"}F=F.replace(/([A-Z])/g,"-$1").toLowerCase();var M=q.getComputedStyle(I,null);if(M){L=M.getPropertyValue(F)}if(F=="opacity"&&L==""){L="1"}}else{if(I.currentStyle){var J=F.replace(/\-(\w)/g,function(N,O){return O.toUpperCase()});L=I.currentStyle[F]||I.currentStyle[J];if(!/^\d+(px)?$/i.test(L)&&/^\d/.test(L)){var H=E.left,K=I.runtimeStyle.left;I.runtimeStyle.left=I.currentStyle.left;E.left=L||0;L=E.pixelLeft+"px";E.left=H;I.runtimeStyle.left=K}}}}return L},clean:function(F,K,I){K=K||document;if(typeof K.createElement==="undefined"){K=K.ownerDocument||K[0]&&K[0].ownerDocument||document}if(!I&&F.length===1&&typeof F[0]==="string"){var H=/^<(\w+)\s*\/?>$/.exec(F[0]);if(H){return[K.createElement(H[1])]}}var G=[],E=[],L=K.createElement("div");o.each(F,function(P,S){if(typeof S==="number"){S+=""}if(!S){return}if(typeof S==="string"){S=S.replace(/(<(\w+)[^>]*?)\/>/g,function(U,V,T){return T.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i)?U:V+"></"+T+">"});var O=S.replace(/^\s+/,"").substring(0,10).toLowerCase();var Q=!O.indexOf("<opt")&&[1,"<select multiple='multiple'>","</select>"]||!O.indexOf("<leg")&&[1,"<fieldset>","</fieldset>"]||O.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,"<table>","</table>"]||!O.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!O.indexOf("<td")||!O.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||!O.indexOf("<col")&&[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]||!o.support.htmlSerialize&&[1,"div<div>","</div>"]||[0,"",""];L.innerHTML=Q[1]+S+Q[2];while(Q[0]--){L=L.lastChild}if(!o.support.tbody){var R=/<tbody/i.test(S),N=!O.indexOf("<table")&&!R?L.firstChild&&L.firstChild.childNodes:Q[1]=="<table>"&&!R?L.childNodes:[];for(var M=N.length-1;M>=0;--M){if(o.nodeName(N[M],"tbody")&&!N[M].childNodes.length){N[M].parentNode.removeChild(N[M])}}}if(!o.support.leadingWhitespace&&/^\s/.test(S)){L.insertBefore(K.createTextNode(S.match(/^\s*/)[0]),L.firstChild)}S=o.makeArray(L.childNodes)}if(S.nodeType){G.push(S)}else{G=o.merge(G,S)}});if(I){for(var J=0;G[J];J++){if(o.nodeName(G[J],"script")&&(!G[J].type||G[J].type.toLowerCase()==="text/javascript")){E.push(G[J].parentNode?G[J].parentNode.removeChild(G[J]):G[J])}else{if(G[J].nodeType===1){G.splice.apply(G,[J+1,0].concat(o.makeArray(G[J].getElementsByTagName("script"))))}I.appendChild(G[J])}}return E}return G},attr:function(J,G,K){if(!J||J.nodeType==3||J.nodeType==8){return g}var H=!o.isXMLDoc(J),L=K!==g;G=H&&o.props[G]||G;if(J.tagName){var F=/href|src|style/.test(G);if(G=="selected"&&J.parentNode){J.parentNode.selectedIndex}if(G in J&&H&&!F){if(L){if(G=="type"&&o.nodeName(J,"input")&&J.parentNode){throw"type property can't be changed"}J[G]=K}if(o.nodeName(J,"form")&&J.getAttributeNode(G)){return J.getAttributeNode(G).nodeValue}if(G=="tabIndex"){var I=J.getAttributeNode("tabIndex");return I&&I.specified?I.value:J.nodeName.match(/(button|input|object|select|textarea)/i)?0:J.nodeName.match(/^(a|area)$/i)&&J.href?0:g}return J[G]}if(!o.support.style&&H&&G=="style"){return o.attr(J.style,"cssText",K)}if(L){J.setAttribute(G,""+K)}var E=!o.support.hrefNormalized&&H&&F?J.getAttribute(G,2):J.getAttribute(G);return E===null?g:E}if(!o.support.opacity&&G=="opacity"){if(L){J.zoom=1;J.filter=(J.filter||"").replace(/alpha\([^)]*\)/,"")+(parseInt(K)+""=="NaN"?"":"alpha(opacity="+K*100+")")}return J.filter&&J.filter.indexOf("opacity=")>=0?(parseFloat(J.filter.match(/opacity=([^)]*)/)[1])/100)+"":""}G=G.replace(/-([a-z])/ig,function(M,N){return N.toUpperCase()});if(L){J[G]=K}return J[G]},trim:function(E){return(E||"").replace(/^\s+|\s+$/g,"")},makeArray:function(G){var E=[];if(G!=null){var F=G.length;if(F==null||typeof G==="string"||o.isFunction(G)||G.setInterval){E[0]=G}else{while(F){E[--F]=G[F]}}}return E},inArray:function(G,H){for(var E=0,F=H.length;E<F;E++){if(H[E]===G){return E}}return -1},merge:function(H,E){var F=0,G,I=H.length;if(!o.support.getAll){while((G=E[F++])!=null){if(G.nodeType!=8){H[I++]=G}}}else{while((G=E[F++])!=null){H[I++]=G}}return H},unique:function(K){var F=[],E={};try{for(var G=0,H=K.length;G<H;G++){var J=o.data(K[G]);if(!E[J]){E[J]=true;F.push(K[G])}}}catch(I){F=K}return F},grep:function(F,J,E){var G=[];for(var H=0,I=F.length;H<I;H++){if(!E!=!J(F[H],H)){G.push(F[H])}}return G},map:function(E,J){var F=[];for(var G=0,H=E.length;G<H;G++){var I=J(E[G],G);if(I!=null){F[F.length]=I}}return F.concat.apply([],F)}});var C=navigator.userAgent.toLowerCase();o.browser={version:(C.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(C),opera:/opera/.test(C),msie:/msie/.test(C)&&!/opera/.test(C),mozilla:/mozilla/.test(C)&&!/(compatible|webkit)/.test(C)};o.each({parent:function(E){return E.parentNode},parents:function(E){return o.dir(E,"parentNode")},next:function(E){return o.nth(E,2,"nextSibling")},prev:function(E){return o.nth(E,2,"previousSibling")},nextAll:function(E){return o.dir(E,"nextSibling")},prevAll:function(E){return o.dir(E,"previousSibling")},siblings:function(E){return o.sibling(E.parentNode.firstChild,E)},children:function(E){return o.sibling(E.firstChild)},contents:function(E){return o.nodeName(E,"iframe")?E.contentDocument||E.contentWindow.document:o.makeArray(E.childNodes)}},function(E,F){o.fn[E]=function(G){var H=o.map(this,F);if(G&&typeof G=="string"){H=o.multiFilter(G,H)}return this.pushStack(o.unique(H),E,G)}});o.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(E,F){o.fn[E]=function(G){var J=[],L=o(G);for(var K=0,H=L.length;K<H;K++){var I=(K>0?this.clone(true):this).get();o.fn[F].apply(o(L[K]),I);J=J.concat(I)}return this.pushStack(J,E,G)}});o.each({removeAttr:function(E){o.attr(this,E,"");if(this.nodeType==1){this.removeAttribute(E)}},addClass:function(E){o.className.add(this,E)},removeClass:function(E){o.className.remove(this,E)},toggleClass:function(F,E){if(typeof E!=="boolean"){E=!o.className.has(this,F)}o.className[E?"add":"remove"](this,F)},remove:function(E){if(!E||o.filter(E,[this]).length){o("*",this).add([this]).each(function(){o.event.remove(this);o.removeData(this)});if(this.parentNode){this.parentNode.removeChild(this)}}},empty:function(){o(this).children().remove();while(this.firstChild){this.removeChild(this.firstChild)}}},function(E,F){o.fn[E]=function(){return this.each(F,arguments)}});function j(E,F){return E[0]&&parseInt(o.curCSS(E[0],F,true),10)||0}var h="jQuery"+e(),v=0,A={};o.extend({cache:{},data:function(F,E,G){F=F==l?A:F;var H=F[h];if(!H){H=F[h]=++v}if(E&&!o.cache[H]){o.cache[H]={}}if(G!==g){o.cache[H][E]=G}return E?o.cache[H][E]:H},removeData:function(F,E){F=F==l?A:F;var H=F[h];if(E){if(o.cache[H]){delete o.cache[H][E];E="";for(E in o.cache[H]){break}if(!E){o.removeData(F)}}}else{try{delete F[h]}catch(G){if(F.removeAttribute){F.removeAttribute(h)}}delete o.cache[H]}},queue:function(F,E,H){if(F){E=(E||"fx")+"queue";var G=o.data(F,E);if(!G||o.isArray(H)){G=o.data(F,E,o.makeArray(H))}else{if(H){G.push(H)}}}return G},dequeue:function(H,G){var E=o.queue(H,G),F=E.shift();if(!G||G==="fx"){F=E[0]}if(F!==g){F.call(H)}}});o.fn.extend({data:function(E,G){var H=E.split(".");H[1]=H[1]?"."+H[1]:"";if(G===g){var F=this.triggerHandler("getData"+H[1]+"!",[H[0]]);if(F===g&&this.length){F=o.data(this[0],E)}return F===g&&H[1]?this.data(H[0]):F}else{return this.trigger("setData"+H[1]+"!",[H[0],G]).each(function(){o.data(this,E,G)})}},removeData:function(E){return this.each(function(){o.removeData(this,E)})},queue:function(E,F){if(typeof E!=="string"){F=E;E="fx"}if(F===g){return o.queue(this[0],E)}return this.each(function(){var G=o.queue(this,E,F);if(E=="fx"&&G.length==1){G[0].call(this)}})},dequeue:function(E){return this.each(function(){o.dequeue(this,E)})}});
+/*
+ * Sizzle CSS Selector Engine - v0.9.3
+ *  Copyright 2009, The Dojo Foundation
+ *  Released under the MIT, BSD, and GPL Licenses.
+ *  More information: http://sizzlejs.com/
+ */
+(function(){var R=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?/g,L=0,H=Object.prototype.toString;var F=function(Y,U,ab,ac){ab=ab||[];U=U||document;if(U.nodeType!==1&&U.nodeType!==9){return[]}if(!Y||typeof Y!=="string"){return ab}var Z=[],W,af,ai,T,ad,V,X=true;R.lastIndex=0;while((W=R.exec(Y))!==null){Z.push(W[1]);if(W[2]){V=RegExp.rightContext;break}}if(Z.length>1&&M.exec(Y)){if(Z.length===2&&I.relative[Z[0]]){af=J(Z[0]+Z[1],U)}else{af=I.relative[Z[0]]?[U]:F(Z.shift(),U);while(Z.length){Y=Z.shift();if(I.relative[Y]){Y+=Z.shift()}af=J(Y,af)}}}else{var ae=ac?{expr:Z.pop(),set:E(ac)}:F.find(Z.pop(),Z.length===1&&U.parentNode?U.parentNode:U,Q(U));af=F.filter(ae.expr,ae.set);if(Z.length>0){ai=E(af)}else{X=false}while(Z.length){var ah=Z.pop(),ag=ah;if(!I.relative[ah]){ah=""}else{ag=Z.pop()}if(ag==null){ag=U}I.relative[ah](ai,ag,Q(U))}}if(!ai){ai=af}if(!ai){throw"Syntax error, unrecognized expression: "+(ah||Y)}if(H.call(ai)==="[object Array]"){if(!X){ab.push.apply(ab,ai)}else{if(U.nodeType===1){for(var aa=0;ai[aa]!=null;aa++){if(ai[aa]&&(ai[aa]===true||ai[aa].nodeType===1&&K(U,ai[aa]))){ab.push(af[aa])}}}else{for(var aa=0;ai[aa]!=null;aa++){if(ai[aa]&&ai[aa].nodeType===1){ab.push(af[aa])}}}}}else{E(ai,ab)}if(V){F(V,U,ab,ac);if(G){hasDuplicate=false;ab.sort(G);if(hasDuplicate){for(var aa=1;aa<ab.length;aa++){if(ab[aa]===ab[aa-1]){ab.splice(aa--,1)}}}}}return ab};F.matches=function(T,U){return F(T,null,null,U)};F.find=function(aa,T,ab){var Z,X;if(!aa){return[]}for(var W=0,V=I.order.length;W<V;W++){var Y=I.order[W],X;if((X=I.match[Y].exec(aa))){var U=RegExp.leftContext;if(U.substr(U.length-1)!=="\\"){X[1]=(X[1]||"").replace(/\\/g,"");Z=I.find[Y](X,T,ab);if(Z!=null){aa=aa.replace(I.match[Y],"");break}}}}if(!Z){Z=T.getElementsByTagName("*")}return{set:Z,expr:aa}};F.filter=function(ad,ac,ag,W){var V=ad,ai=[],aa=ac,Y,T,Z=ac&&ac[0]&&Q(ac[0]);while(ad&&ac.length){for(var ab in I.filter){if((Y=I.match[ab].exec(ad))!=null){var U=I.filter[ab],ah,af;T=false;if(aa==ai){ai=[]}if(I.preFilter[ab]){Y=I.preFilter[ab](Y,aa,ag,ai,W,Z);if(!Y){T=ah=true}else{if(Y===true){continue}}}if(Y){for(var X=0;(af=aa[X])!=null;X++){if(af){ah=U(af,Y,X,aa);var ae=W^!!ah;if(ag&&ah!=null){if(ae){T=true}else{aa[X]=false}}else{if(ae){ai.push(af);T=true}}}}}if(ah!==g){if(!ag){aa=ai}ad=ad.replace(I.match[ab],"");if(!T){return[]}break}}}if(ad==V){if(T==null){throw"Syntax error, unrecognized expression: "+ad}else{break}}V=ad}return aa};var I=F.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF_-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(T){return T.getAttribute("href")}},relative:{"+":function(aa,T,Z){var X=typeof T==="string",ab=X&&!/\W/.test(T),Y=X&&!ab;if(ab&&!Z){T=T.toUpperCase()}for(var W=0,V=aa.length,U;W<V;W++){if((U=aa[W])){while((U=U.previousSibling)&&U.nodeType!==1){}aa[W]=Y||U&&U.nodeName===T?U||false:U===T}}if(Y){F.filter(T,aa,true)}},">":function(Z,U,aa){var X=typeof U==="string";if(X&&!/\W/.test(U)){U=aa?U:U.toUpperCase();for(var V=0,T=Z.length;V<T;V++){var Y=Z[V];if(Y){var W=Y.parentNode;Z[V]=W.nodeName===U?W:false}}}else{for(var V=0,T=Z.length;V<T;V++){var Y=Z[V];if(Y){Z[V]=X?Y.parentNode:Y.parentNode===U}}if(X){F.filter(U,Z,true)}}},"":function(W,U,Y){var V=L++,T=S;if(!U.match(/\W/)){var X=U=Y?U:U.toUpperCase();T=P}T("parentNode",U,V,W,X,Y)},"~":function(W,U,Y){var V=L++,T=S;if(typeof U==="string"&&!U.match(/\W/)){var X=U=Y?U:U.toUpperCase();T=P}T("previousSibling",U,V,W,X,Y)}},find:{ID:function(U,V,W){if(typeof V.getElementById!=="undefined"&&!W){var T=V.getElementById(U[1]);return T?[T]:[]}},NAME:function(V,Y,Z){if(typeof Y.getElementsByName!=="undefined"){var U=[],X=Y.getElementsByName(V[1]);for(var W=0,T=X.length;W<T;W++){if(X[W].getAttribute("name")===V[1]){U.push(X[W])}}return U.length===0?null:U}},TAG:function(T,U){return U.getElementsByTagName(T[1])}},preFilter:{CLASS:function(W,U,V,T,Z,aa){W=" "+W[1].replace(/\\/g,"")+" ";if(aa){return W}for(var X=0,Y;(Y=U[X])!=null;X++){if(Y){if(Z^(Y.className&&(" "+Y.className+" ").indexOf(W)>=0)){if(!V){T.push(Y)}}else{if(V){U[X]=false}}}}return false},ID:function(T){return T[1].replace(/\\/g,"")},TAG:function(U,T){for(var V=0;T[V]===false;V++){}return T[V]&&Q(T[V])?U[1]:U[1].toUpperCase()},CHILD:function(T){if(T[1]=="nth"){var U=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(T[2]=="even"&&"2n"||T[2]=="odd"&&"2n+1"||!/\D/.test(T[2])&&"0n+"+T[2]||T[2]);T[2]=(U[1]+(U[2]||1))-0;T[3]=U[3]-0}T[0]=L++;return T},ATTR:function(X,U,V,T,Y,Z){var W=X[1].replace(/\\/g,"");if(!Z&&I.attrMap[W]){X[1]=I.attrMap[W]}if(X[2]==="~="){X[4]=" "+X[4]+" "}return X},PSEUDO:function(X,U,V,T,Y){if(X[1]==="not"){if(X[3].match(R).length>1||/^\w/.test(X[3])){X[3]=F(X[3],null,null,U)}else{var W=F.filter(X[3],U,V,true^Y);if(!V){T.push.apply(T,W)}return false}}else{if(I.match.POS.test(X[0])||I.match.CHILD.test(X[0])){return true}}return X},POS:function(T){T.unshift(true);return T}},filters:{enabled:function(T){return T.disabled===false&&T.type!=="hidden"},disabled:function(T){return T.disabled===true},checked:function(T){return T.checked===true},selected:function(T){T.parentNode.selectedIndex;return T.selected===true},parent:function(T){return !!T.firstChild},empty:function(T){return !T.firstChild},has:function(V,U,T){return !!F(T[3],V).length},header:function(T){return/h\d/i.test(T.nodeName)},text:function(T){return"text"===T.type},radio:function(T){return"radio"===T.type},checkbox:function(T){return"checkbox"===T.type},file:function(T){return"file"===T.type},password:function(T){return"password"===T.type},submit:function(T){return"submit"===T.type},image:function(T){return"image"===T.type},reset:function(T){return"reset"===T.type},button:function(T){return"button"===T.type||T.nodeName.toUpperCase()==="BUTTON"},input:function(T){return/input|select|textarea|button/i.test(T.nodeName)}},setFilters:{first:function(U,T){return T===0},last:function(V,U,T,W){return U===W.length-1},even:function(U,T){return T%2===0},odd:function(U,T){return T%2===1},lt:function(V,U,T){return U<T[3]-0},gt:function(V,U,T){return U>T[3]-0},nth:function(V,U,T){return T[3]-0==U},eq:function(V,U,T){return T[3]-0==U}},filter:{PSEUDO:function(Z,V,W,aa){var U=V[1],X=I.filters[U];if(X){return X(Z,W,V,aa)}else{if(U==="contains"){return(Z.textContent||Z.innerText||"").indexOf(V[3])>=0}else{if(U==="not"){var Y=V[3];for(var W=0,T=Y.length;W<T;W++){if(Y[W]===Z){return false}}return true}}}},CHILD:function(T,W){var Z=W[1],U=T;switch(Z){case"only":case"first":while(U=U.previousSibling){if(U.nodeType===1){return false}}if(Z=="first"){return true}U=T;case"last":while(U=U.nextSibling){if(U.nodeType===1){return false}}return true;case"nth":var V=W[2],ac=W[3];if(V==1&&ac==0){return true}var Y=W[0],ab=T.parentNode;if(ab&&(ab.sizcache!==Y||!T.nodeIndex)){var X=0;for(U=ab.firstChild;U;U=U.nextSibling){if(U.nodeType===1){U.nodeIndex=++X}}ab.sizcache=Y}var aa=T.nodeIndex-ac;if(V==0){return aa==0}else{return(aa%V==0&&aa/V>=0)}}},ID:function(U,T){return U.nodeType===1&&U.getAttribute("id")===T},TAG:function(U,T){return(T==="*"&&U.nodeType===1)||U.nodeName===T},CLASS:function(U,T){return(" "+(U.className||U.getAttribute("class"))+" ").indexOf(T)>-1},ATTR:function(Y,W){var V=W[1],T=I.attrHandle[V]?I.attrHandle[V](Y):Y[V]!=null?Y[V]:Y.getAttribute(V),Z=T+"",X=W[2],U=W[4];return T==null?X==="!=":X==="="?Z===U:X==="*="?Z.indexOf(U)>=0:X==="~="?(" "+Z+" ").indexOf(U)>=0:!U?Z&&T!==false:X==="!="?Z!=U:X==="^="?Z.indexOf(U)===0:X==="$="?Z.substr(Z.length-U.length)===U:X==="|="?Z===U||Z.substr(0,U.length+1)===U+"-":false},POS:function(X,U,V,Y){var T=U[2],W=I.setFilters[T];if(W){return W(X,V,U,Y)}}}};var M=I.match.POS;for(var O in I.match){I.match[O]=RegExp(I.match[O].source+/(?![^\[]*\])(?![^\(]*\))/.source)}var E=function(U,T){U=Array.prototype.slice.call(U);if(T){T.push.apply(T,U);return T}return U};try{Array.prototype.slice.call(document.documentElement.childNodes)}catch(N){E=function(X,W){var U=W||[];if(H.call(X)==="[object Array]"){Array.prototype.push.apply(U,X)}else{if(typeof X.length==="number"){for(var V=0,T=X.length;V<T;V++){U.push(X[V])}}else{for(var V=0;X[V];V++){U.push(X[V])}}}return U}}var G;if(document.documentElement.compareDocumentPosition){G=function(U,T){var V=U.compareDocumentPosition(T)&4?-1:U===T?0:1;if(V===0){hasDuplicate=true}return V}}else{if("sourceIndex" in document.documentElement){G=function(U,T){var V=U.sourceIndex-T.sourceIndex;if(V===0){hasDuplicate=true}return V}}else{if(document.createRange){G=function(W,U){var V=W.ownerDocument.createRange(),T=U.ownerDocument.createRange();V.selectNode(W);V.collapse(true);T.selectNode(U);T.collapse(true);var X=V.compareBoundaryPoints(Range.START_TO_END,T);if(X===0){hasDuplicate=true}return X}}}}(function(){var U=document.createElement("form"),V="script"+(new Date).getTime();U.innerHTML="<input name='"+V+"'/>";var T=document.documentElement;T.insertBefore(U,T.firstChild);if(!!document.getElementById(V)){I.find.ID=function(X,Y,Z){if(typeof Y.getElementById!=="undefined"&&!Z){var W=Y.getElementById(X[1]);return W?W.id===X[1]||typeof W.getAttributeNode!=="undefined"&&W.getAttributeNode("id").nodeValue===X[1]?[W]:g:[]}};I.filter.ID=function(Y,W){var X=typeof Y.getAttributeNode!=="undefined"&&Y.getAttributeNode("id");return Y.nodeType===1&&X&&X.nodeValue===W}}T.removeChild(U)})();(function(){var T=document.createElement("div");T.appendChild(document.createComment(""));if(T.getElementsByTagName("*").length>0){I.find.TAG=function(U,Y){var X=Y.getElementsByTagName(U[1]);if(U[1]==="*"){var W=[];for(var V=0;X[V];V++){if(X[V].nodeType===1){W.push(X[V])}}X=W}return X}}T.innerHTML="<a href='#'></a>";if(T.firstChild&&typeof T.firstChild.getAttribute!=="undefined"&&T.firstChild.getAttribute("href")!=="#"){I.attrHandle.href=function(U){return U.getAttribute("href",2)}}})();if(document.querySelectorAll){(function(){var T=F,U=document.createElement("div");U.innerHTML="<p class='TEST'></p>";if(U.querySelectorAll&&U.querySelectorAll(".TEST").length===0){return}F=function(Y,X,V,W){X=X||document;if(!W&&X.nodeType===9&&!Q(X)){try{return E(X.querySelectorAll(Y),V)}catch(Z){}}return T(Y,X,V,W)};F.find=T.find;F.filter=T.filter;F.selectors=T.selectors;F.matches=T.matches})()}if(document.getElementsByClassName&&document.documentElement.getElementsByClassName){(function(){var T=document.createElement("div");T.innerHTML="<div class='test e'></div><div class='test'></div>";if(T.getElementsByClassName("e").length===0){return}T.lastChild.className="e";if(T.getElementsByClassName("e").length===1){return}I.order.splice(1,0,"CLASS");I.find.CLASS=function(U,V,W){if(typeof V.getElementsByClassName!=="undefined"&&!W){return V.getElementsByClassName(U[1])}}})()}function P(U,Z,Y,ad,aa,ac){var ab=U=="previousSibling"&&!ac;for(var W=0,V=ad.length;W<V;W++){var T=ad[W];if(T){if(ab&&T.nodeType===1){T.sizcache=Y;T.sizset=W}T=T[U];var X=false;while(T){if(T.sizcache===Y){X=ad[T.sizset];break}if(T.nodeType===1&&!ac){T.sizcache=Y;T.sizset=W}if(T.nodeName===Z){X=T;break}T=T[U]}ad[W]=X}}}function S(U,Z,Y,ad,aa,ac){var ab=U=="previousSibling"&&!ac;for(var W=0,V=ad.length;W<V;W++){var T=ad[W];if(T){if(ab&&T.nodeType===1){T.sizcache=Y;T.sizset=W}T=T[U];var X=false;while(T){if(T.sizcache===Y){X=ad[T.sizset];break}if(T.nodeType===1){if(!ac){T.sizcache=Y;T.sizset=W}if(typeof Z!=="string"){if(T===Z){X=true;break}}else{if(F.filter(Z,[T]).length>0){X=T;break}}}T=T[U]}ad[W]=X}}}var K=document.compareDocumentPosition?function(U,T){return U.compareDocumentPosition(T)&16}:function(U,T){return U!==T&&(U.contains?U.contains(T):true)};var Q=function(T){return T.nodeType===9&&T.documentElement.nodeName!=="HTML"||!!T.ownerDocument&&Q(T.ownerDocument)};var J=function(T,aa){var W=[],X="",Y,V=aa.nodeType?[aa]:aa;while((Y=I.match.PSEUDO.exec(T))){X+=Y[0];T=T.replace(I.match.PSEUDO,"")}T=I.relative[T]?T+"*":T;for(var Z=0,U=V.length;Z<U;Z++){F(T,V[Z],W)}return F.filter(X,W)};o.find=F;o.filter=F.filter;o.expr=F.selectors;o.expr[":"]=o.expr.filters;F.selectors.filters.hidden=function(T){return T.offsetWidth===0||T.offsetHeight===0};F.selectors.filters.visible=function(T){return T.offsetWidth>0||T.offsetHeight>0};F.selectors.filters.animated=function(T){return o.grep(o.timers,function(U){return T===U.elem}).length};o.multiFilter=function(V,T,U){if(U){V=":not("+V+")"}return F.matches(V,T)};o.dir=function(V,U){var T=[],W=V[U];while(W&&W!=document){if(W.nodeType==1){T.push(W)}W=W[U]}return T};o.nth=function(X,T,V,W){T=T||1;var U=0;for(;X;X=X[V]){if(X.nodeType==1&&++U==T){break}}return X};o.sibling=function(V,U){var T=[];for(;V;V=V.nextSibling){if(V.nodeType==1&&V!=U){T.push(V)}}return T};return;l.Sizzle=F})();o.event={add:function(I,F,H,K){if(I.nodeType==3||I.nodeType==8){return}if(I.setInterval&&I!=l){I=l}if(!H.guid){H.guid=this.guid++}if(K!==g){var G=H;H=this.proxy(G);H.data=K}var E=o.data(I,"events")||o.data(I,"events",{}),J=o.data(I,"handle")||o.data(I,"handle",function(){return typeof o!=="undefined"&&!o.event.triggered?o.event.handle.apply(arguments.callee.elem,arguments):g});J.elem=I;o.each(F.split(/\s+/),function(M,N){var O=N.split(".");N=O.shift();H.type=O.slice().sort().join(".");var L=E[N];if(o.event.specialAll[N]){o.event.specialAll[N].setup.call(I,K,O)}if(!L){L=E[N]={};if(!o.event.special[N]||o.event.special[N].setup.call(I,K,O)===false){if(I.addEventListener){I.addEventListener(N,J,false)}else{if(I.attachEvent){I.attachEvent("on"+N,J)}}}}L[H.guid]=H;o.event.global[N]=true});I=null},guid:1,global:{},remove:function(K,H,J){if(K.nodeType==3||K.nodeType==8){return}var G=o.data(K,"events"),F,E;if(G){if(H===g||(typeof H==="string"&&H.charAt(0)==".")){for(var I in G){this.remove(K,I+(H||""))}}else{if(H.type){J=H.handler;H=H.type}o.each(H.split(/\s+/),function(M,O){var Q=O.split(".");O=Q.shift();var N=RegExp("(^|\\.)"+Q.slice().sort().join(".*\\.")+"(\\.|$)");if(G[O]){if(J){delete G[O][J.guid]}else{for(var P in G[O]){if(N.test(G[O][P].type)){delete G[O][P]}}}if(o.event.specialAll[O]){o.event.specialAll[O].teardown.call(K,Q)}for(F in G[O]){break}if(!F){if(!o.event.special[O]||o.event.special[O].teardown.call(K,Q)===false){if(K.removeEventListener){K.removeEventListener(O,o.data(K,"handle"),false)}else{if(K.detachEvent){K.detachEvent("on"+O,o.data(K,"handle"))}}}F=null;delete G[O]}}})}for(F in G){break}if(!F){var L=o.data(K,"handle");if(L){L.elem=null}o.removeData(K,"events");o.removeData(K,"handle")}}},trigger:function(I,K,H,E){var G=I.type||I;if(!E){I=typeof I==="object"?I[h]?I:o.extend(o.Event(G),I):o.Event(G);if(G.indexOf("!")>=0){I.type=G=G.slice(0,-1);I.exclusive=true}if(!H){I.stopPropagation();if(this.global[G]){o.each(o.cache,function(){if(this.events&&this.events[G]){o.event.trigger(I,K,this.handle.elem)}})}}if(!H||H.nodeType==3||H.nodeType==8){return g}I.result=g;I.target=H;K=o.makeArray(K);K.unshift(I)}I.currentTarget=H;var J=o.data(H,"handle");if(J){J.apply(H,K)}if((!H[G]||(o.nodeName(H,"a")&&G=="click"))&&H["on"+G]&&H["on"+G].apply(H,K)===false){I.result=false}if(!E&&H[G]&&!I.isDefaultPrevented()&&!(o.nodeName(H,"a")&&G=="click")){this.triggered=true;try{H[G]()}catch(L){}}this.triggered=false;if(!I.isPropagationStopped()){var F=H.parentNode||H.ownerDocument;if(F){o.event.trigger(I,K,F,true)}}},handle:function(K){var J,E;K=arguments[0]=o.event.fix(K||l.event);K.currentTarget=this;var L=K.type.split(".");K.type=L.shift();J=!L.length&&!K.exclusive;var I=RegExp("(^|\\.)"+L.slice().sort().join(".*\\.")+"(\\.|$)");E=(o.data(this,"events")||{})[K.type];for(var G in E){var H=E[G];if(J||I.test(H.type)){K.handler=H;K.data=H.data;var F=H.apply(this,arguments);if(F!==g){K.result=F;if(F===false){K.preventDefault();K.stopPropagation()}}if(K.isImmediatePropagationStopped()){break}}}},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(H){if(H[h]){return H}var F=H;H=o.Event(F);for(var G=this.props.length,J;G;){J=this.props[--G];H[J]=F[J]}if(!H.target){H.target=H.srcElement||document}if(H.target.nodeType==3){H.target=H.target.parentNode}if(!H.relatedTarget&&H.fromElement){H.relatedTarget=H.fromElement==H.target?H.toElement:H.fromElement}if(H.pageX==null&&H.clientX!=null){var I=document.documentElement,E=document.body;H.pageX=H.clientX+(I&&I.scrollLeft||E&&E.scrollLeft||0)-(I.clientLeft||0);H.pageY=H.clientY+(I&&I.scrollTop||E&&E.scrollTop||0)-(I.clientTop||0)}if(!H.which&&((H.charCode||H.charCode===0)?H.charCode:H.keyCode)){H.which=H.charCode||H.keyCode}if(!H.metaKey&&H.ctrlKey){H.metaKey=H.ctrlKey}if(!H.which&&H.button){H.which=(H.button&1?1:(H.button&2?3:(H.button&4?2:0)))}return H},proxy:function(F,E){E=E||function(){return F.apply(this,arguments)};E.guid=F.guid=F.guid||E.guid||this.guid++;return E},special:{ready:{setup:B,teardown:function(){}}},specialAll:{live:{setup:function(E,F){o.event.add(this,F[0],c)},teardown:function(G){if(G.length){var E=0,F=RegExp("(^|\\.)"+G[0]+"(\\.|$)");o.each((o.data(this,"events").live||{}),function(){if(F.test(this.type)){E++}});if(E<1){o.event.remove(this,G[0],c)}}}}}};o.Event=function(E){if(!this.preventDefault){return new o.Event(E)}if(E&&E.type){this.originalEvent=E;this.type=E.type}else{this.type=E}this.timeStamp=e();this[h]=true};function k(){return false}function u(){return true}o.Event.prototype={preventDefault:function(){this.isDefaultPrevented=u;var E=this.originalEvent;if(!E){return}if(E.preventDefault){E.preventDefault()}E.returnValue=false},stopPropagation:function(){this.isPropagationStopped=u;var E=this.originalEvent;if(!E){return}if(E.stopPropagation){E.stopPropagation()}E.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=u;this.stopPropagation()},isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k};var a=function(F){var E=F.relatedTarget;while(E&&E!=this){try{E=E.parentNode}catch(G){E=this}}if(E!=this){F.type=F.data;o.event.handle.apply(this,arguments)}};o.each({mouseover:"mouseenter",mouseout:"mouseleave"},function(F,E){o.event.special[E]={setup:function(){o.event.add(this,F,a,E)},teardown:function(){o.event.remove(this,F,a)}}});o.fn.extend({bind:function(F,G,E){return F=="unload"?this.one(F,G,E):this.each(function(){o.event.add(this,F,E||G,E&&G)})},one:function(G,H,F){var E=o.event.proxy(F||H,function(I){o(this).unbind(I,E);return(F||H).apply(this,arguments)});return this.each(function(){o.event.add(this,G,E,F&&H)})},unbind:function(F,E){return this.each(function(){o.event.remove(this,F,E)})},trigger:function(E,F){return this.each(function(){o.event.trigger(E,F,this)})},triggerHandler:function(E,G){if(this[0]){var F=o.Event(E);F.preventDefault();F.stopPropagation();o.event.trigger(F,G,this[0]);return F.result}},toggle:function(G){var E=arguments,F=1;while(F<E.length){o.event.proxy(G,E[F++])}return this.click(o.event.proxy(G,function(H){this.lastToggle=(this.lastToggle||0)%F;H.preventDefault();return E[this.lastToggle++].apply(this,arguments)||false}))},hover:function(E,F){return this.mouseenter(E).mouseleave(F)},ready:function(E){B();if(o.isReady){E.call(document,o)}else{o.readyList.push(E)}return this},live:function(G,F){var E=o.event.proxy(F);E.guid+=this.selector+G;o(document).bind(i(G,this.selector),this.selector,E);return this},die:function(F,E){o(document).unbind(i(F,this.selector),E?{guid:E.guid+this.selector+F}:null);return this}});function c(H){var E=RegExp("(^|\\.)"+H.type+"(\\.|$)"),G=true,F=[];o.each(o.data(this,"events").live||[],function(I,J){if(E.test(J.type)){var K=o(H.target).closest(J.data)[0];if(K){F.push({elem:K,fn:J})}}});F.sort(function(J,I){return o.data(J.elem,"closest")-o.data(I.elem,"closest")});o.each(F,function(){if(this.fn.call(this.elem,H,this.fn.data)===false){return(G=false)}});return G}function i(F,E){return["live",F,E.replace(/\./g,"`").replace(/ /g,"|")].join(".")}o.extend({isReady:false,readyList:[],ready:function(){if(!o.isReady){o.isReady=true;if(o.readyList){o.each(o.readyList,function(){this.call(document,o)});o.readyList=null}o(document).triggerHandler("ready")}}});var x=false;function B(){if(x){return}x=true;if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);o.ready()},false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);o.ready()}});if(document.documentElement.doScroll&&l==l.top){(function(){if(o.isReady){return}try{document.documentElement.doScroll("left")}catch(E){setTimeout(arguments.callee,0);return}o.ready()})()}}}o.event.add(l,"load",o.ready)}o.each(("blur,focus,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,change,select,submit,keydown,keypress,keyup,error").split(","),function(F,E){o.fn[E]=function(G){return G?this.bind(E,G):this.trigger(E)}});o(l).bind("unload",function(){for(var E in o.cache){if(E!=1&&o.cache[E].handle){o.event.remove(o.cache[E].handle.elem)}}});(function(){o.support={};var F=document.documentElement,G=document.createElement("script"),K=document.createElement("div"),J="script"+(new Date).getTime();K.style.display="none";K.innerHTML='   <link/><table></table><a href="/a" style="color:red;float:left;opacity:.5;">a</a><select><option>text</option></select><object><param/></object>';var H=K.getElementsByTagName("*"),E=K.getElementsByTagName("a")[0];if(!H||!H.length||!E){return}o.support={leadingWhitespace:K.firstChild.nodeType==3,tbody:!K.getElementsByTagName("tbody").length,objectAll:!!K.getElementsByTagName("object")[0].getElementsByTagName("*").length,htmlSerialize:!!K.getElementsByTagName("link").length,style:/red/.test(E.getAttribute("style")),hrefNormalized:E.getAttribute("href")==="/a",opacity:E.style.opacity==="0.5",cssFloat:!!E.style.cssFloat,scriptEval:false,noCloneEvent:true,boxModel:null};G.type="text/javascript";try{G.appendChild(document.createTextNode("window."+J+"=1;"))}catch(I){}F.insertBefore(G,F.firstChild);if(l[J]){o.support.scriptEval=true;delete l[J]}F.removeChild(G);if(K.attachEvent&&K.fireEvent){K.attachEvent("onclick",function(){o.support.noCloneEvent=false;K.detachEvent("onclick",arguments.callee)});K.cloneNode(true).fireEvent("onclick")}o(function(){var L=document.createElement("div");L.style.width=L.style.paddingLeft="1px";document.body.appendChild(L);o.boxModel=o.support.boxModel=L.offsetWidth===2;document.body.removeChild(L).style.display="none"})})();var w=o.support.cssFloat?"cssFloat":"styleFloat";o.props={"for":"htmlFor","class":"className","float":w,cssFloat:w,styleFloat:w,readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",tabindex:"tabIndex"};o.fn.extend({_load:o.fn.load,load:function(G,J,K){if(typeof G!=="string"){return this._load(G)}var I=G.indexOf(" ");if(I>=0){var E=G.slice(I,G.length);G=G.slice(0,I)}var H="GET";if(J){if(o.isFunction(J)){K=J;J=null}else{if(typeof J==="object"){J=o.param(J);H="POST"}}}var F=this;o.ajax({url:G,type:H,dataType:"html",data:J,complete:function(M,L){if(L=="success"||L=="notmodified"){F.html(E?o("<div/>").append(M.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(E):M.responseText)}if(K){F.each(K,[M.responseText,L,M])}}});return this},serialize:function(){return o.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?o.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password|search/i.test(this.type))}).map(function(E,F){var G=o(this).val();return G==null?null:o.isArray(G)?o.map(G,function(I,H){return{name:F.name,value:I}}):{name:F.name,value:G}}).get()}});o.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(E,F){o.fn[F]=function(G){return this.bind(F,G)}});var r=e();o.extend({get:function(E,G,H,F){if(o.isFunction(G)){H=G;G=null}return o.ajax({type:"GET",url:E,data:G,success:H,dataType:F})},getScript:function(E,F){return o.get(E,null,F,"script")},getJSON:function(E,F,G){return o.get(E,F,G,"json")},post:function(E,G,H,F){if(o.isFunction(G)){H=G;G={}}return o.ajax({type:"POST",url:E,data:G,success:H,dataType:F})},ajaxSetup:function(E){o.extend(o.ajaxSettings,E)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:function(){return l.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest()},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},ajax:function(M){M=o.extend(true,M,o.extend(true,{},o.ajaxSettings,M));var W,F=/=\?(&|$)/g,R,V,G=M.type.toUpperCase();if(M.data&&M.processData&&typeof M.data!=="string"){M.data=o.param(M.data)}if(M.dataType=="jsonp"){if(G=="GET"){if(!M.url.match(F)){M.url+=(M.url.match(/\?/)?"&":"?")+(M.jsonp||"callback")+"=?"}}else{if(!M.data||!M.data.match(F)){M.data=(M.data?M.data+"&":"")+(M.jsonp||"callback")+"=?"}}M.dataType="json"}if(M.dataType=="json"&&(M.data&&M.data.match(F)||M.url.match(F))){W="jsonp"+r++;if(M.data){M.data=(M.data+"").replace(F,"="+W+"$1")}M.url=M.url.replace(F,"="+W+"$1");M.dataType="script";l[W]=function(X){V=X;I();L();l[W]=g;try{delete l[W]}catch(Y){}if(H){H.removeChild(T)}}}if(M.dataType=="script"&&M.cache==null){M.cache=false}if(M.cache===false&&G=="GET"){var E=e();var U=M.url.replace(/(\?|&)_=.*?(&|$)/,"$1_="+E+"$2");M.url=U+((U==M.url)?(M.url.match(/\?/)?"&":"?")+"_="+E:"")}if(M.data&&G=="GET"){M.url+=(M.url.match(/\?/)?"&":"?")+M.data;M.data=null}if(M.global&&!o.active++){o.event.trigger("ajaxStart")}var Q=/^(\w+:)?\/\/([^\/?#]+)/.exec(M.url);if(M.dataType=="script"&&G=="GET"&&Q&&(Q[1]&&Q[1]!=location.protocol||Q[2]!=location.host)){var H=document.getElementsByTagName("head")[0];var T=document.createElement("script");T.src=M.url;if(M.scriptCharset){T.charset=M.scriptCharset}if(!W){var O=false;T.onload=T.onreadystatechange=function(){if(!O&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){O=true;I();L();T.onload=T.onreadystatechange=null;H.removeChild(T)}}}H.appendChild(T);return g}var K=false;var J=M.xhr();if(M.username){J.open(G,M.url,M.async,M.username,M.password)}else{J.open(G,M.url,M.async)}try{if(M.data){J.setRequestHeader("Content-Type",M.contentType)}if(M.ifModified){J.setRequestHeader("If-Modified-Since",o.lastModified[M.url]||"Thu, 01 Jan 1970 00:00:00 GMT")}J.setRequestHeader("X-Requested-With","XMLHttpRequest");J.setRequestHeader("Accept",M.dataType&&M.accepts[M.dataType]?M.accepts[M.dataType]+", */*":M.accepts._default)}catch(S){}if(M.beforeSend&&M.beforeSend(J,M)===false){if(M.global&&!--o.active){o.event.trigger("ajaxStop")}J.abort();return false}if(M.global){o.event.trigger("ajaxSend",[J,M])}var N=function(X){if(J.readyState==0){if(P){clearInterval(P);P=null;if(M.global&&!--o.active){o.event.trigger("ajaxStop")}}}else{if(!K&&J&&(J.readyState==4||X=="timeout")){K=true;if(P){clearInterval(P);P=null}R=X=="timeout"?"timeout":!o.httpSuccess(J)?"error":M.ifModified&&o.httpNotModified(J,M.url)?"notmodified":"success";if(R=="success"){try{V=o.httpData(J,M.dataType,M)}catch(Z){R="parsererror"}}if(R=="success"){var Y;try{Y=J.getResponseHeader("Last-Modified")}catch(Z){}if(M.ifModified&&Y){o.lastModified[M.url]=Y}if(!W){I()}}else{o.handleError(M,J,R)}L();if(X){J.abort()}if(M.async){J=null}}}};if(M.async){var P=setInterval(N,13);if(M.timeout>0){setTimeout(function(){if(J&&!K){N("timeout")}},M.timeout)}}try{J.send(M.data)}catch(S){o.handleError(M,J,null,S)}if(!M.async){N()}function I(){if(M.success){M.success(V,R)}if(M.global){o.event.trigger("ajaxSuccess",[J,M])}}function L(){if(M.complete){M.complete(J,R)}if(M.global){o.event.trigger("ajaxComplete",[J,M])}if(M.global&&!--o.active){o.event.trigger("ajaxStop")}}return J},handleError:function(F,H,E,G){if(F.error){F.error(H,E,G)}if(F.global){o.event.trigger("ajaxError",[H,F,G])}},active:0,httpSuccess:function(F){try{return !F.status&&location.protocol=="file:"||(F.status>=200&&F.status<300)||F.status==304||F.status==1223}catch(E){}return false},httpNotModified:function(G,E){try{var H=G.getResponseHeader("Last-Modified");return G.status==304||H==o.lastModified[E]}catch(F){}return false},httpData:function(J,H,G){var F=J.getResponseHeader("content-type"),E=H=="xml"||!H&&F&&F.indexOf("xml")>=0,I=E?J.responseXML:J.responseText;if(E&&I.documentElement.tagName=="parsererror"){throw"parsererror"}if(G&&G.dataFilter){I=G.dataFilter(I,H)}if(typeof I==="string"){if(H=="script"){o.globalEval(I)}if(H=="json"){I=l["eval"]("("+I+")")}}return I},param:function(E){var G=[];function H(I,J){G[G.length]=encodeURIComponent(I)+"="+encodeURIComponent(J)}if(o.isArray(E)||E.jquery){o.each(E,function(){H(this.name,this.value)})}else{for(var F in E){if(o.isArray(E[F])){o.each(E[F],function(){H(F,this)})}else{H(F,o.isFunction(E[F])?E[F]():E[F])}}}return G.join("&").replace(/%20/g,"+")}});var m={},n,d=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];function t(F,E){var G={};o.each(d.concat.apply([],d.slice(0,E)),function(){G[this]=F});return G}o.fn.extend({show:function(J,L){if(J){return this.animate(t("show",3),J,L)}else{for(var H=0,F=this.length;H<F;H++){var E=o.data(this[H],"olddisplay");this[H].style.display=E||"";if(o.css(this[H],"display")==="none"){var G=this[H].tagName,K;if(m[G]){K=m[G]}else{var I=o("<"+G+" />").appendTo("body");K=I.css("display");if(K==="none"){K="block"}I.remove();m[G]=K}o.data(this[H],"olddisplay",K)}}for(var H=0,F=this.length;H<F;H++){this[H].style.display=o.data(this[H],"olddisplay")||""}return this}},hide:function(H,I){if(H){return this.animate(t("hide",3),H,I)}else{for(var G=0,F=this.length;G<F;G++){var E=o.data(this[G],"olddisplay");if(!E&&E!=="none"){o.data(this[G],"olddisplay",o.css(this[G],"display"))}}for(var G=0,F=this.length;G<F;G++){this[G].style.display="none"}return this}},_toggle:o.fn.toggle,toggle:function(G,F){var E=typeof G==="boolean";return o.isFunction(G)&&o.isFunction(F)?this._toggle.apply(this,arguments):G==null||E?this.each(function(){var H=E?G:o(this).is(":hidden");o(this)[H?"show":"hide"]()}):this.animate(t("toggle",3),G,F)},fadeTo:function(E,G,F){return this.animate({opacity:G},E,F)},animate:function(I,F,H,G){var E=o.speed(F,H,G);return this[E.queue===false?"each":"queue"](function(){var K=o.extend({},E),M,L=this.nodeType==1&&o(this).is(":hidden"),J=this;for(M in I){if(I[M]=="hide"&&L||I[M]=="show"&&!L){return K.complete.call(this)}if((M=="height"||M=="width")&&this.style){K.display=o.css(this,"display");K.overflow=this.style.overflow}}if(K.overflow!=null){this.style.overflow="hidden"}K.curAnim=o.extend({},I);o.each(I,function(O,S){var R=new o.fx(J,K,O);if(/toggle|show|hide/.test(S)){R[S=="toggle"?L?"show":"hide":S](I)}else{var Q=S.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),T=R.cur(true)||0;if(Q){var N=parseFloat(Q[2]),P=Q[3]||"px";if(P!="px"){J.style[O]=(N||1)+P;T=((N||1)/R.cur(true))*T;J.style[O]=T+P}if(Q[1]){N=((Q[1]=="-="?-1:1)*N)+T}R.custom(T,N,P)}else{R.custom(T,S,"")}}});return true})},stop:function(F,E){var G=o.timers;if(F){this.queue([])}this.each(function(){for(var H=G.length-1;H>=0;H--){if(G[H].elem==this){if(E){G[H](true)}G.splice(H,1)}}});if(!E){this.dequeue()}return this}});o.each({slideDown:t("show",1),slideUp:t("hide",1),slideToggle:t("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(E,F){o.fn[E]=function(G,H){return this.animate(F,G,H)}});o.extend({speed:function(G,H,F){var E=typeof G==="object"?G:{complete:F||!F&&H||o.isFunction(G)&&G,duration:G,easing:F&&H||H&&!o.isFunction(H)&&H};E.duration=o.fx.off?0:typeof E.duration==="number"?E.duration:o.fx.speeds[E.duration]||o.fx.speeds._default;E.old=E.complete;E.complete=function(){if(E.queue!==false){o(this).dequeue()}if(o.isFunction(E.old)){E.old.call(this)}};return E},easing:{linear:function(G,H,E,F){return E+F*G},swing:function(G,H,E,F){return((-Math.cos(G*Math.PI)/2)+0.5)*F+E}},timers:[],fx:function(F,E,G){this.options=E;this.elem=F;this.prop=G;if(!E.orig){E.orig={}}}});o.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(o.fx.step[this.prop]||o.fx.step._default)(this);if((this.prop=="height"||this.prop=="width")&&this.elem.style){this.elem.style.display="block"}},cur:function(F){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var E=parseFloat(o.css(this.elem,this.prop,F));return E&&E>-10000?E:parseFloat(o.curCSS(this.elem,this.prop))||0},custom:function(I,H,G){this.startTime=e();this.start=I;this.end=H;this.unit=G||this.unit||"px";this.now=this.start;this.pos=this.state=0;var E=this;function F(J){return E.step(J)}F.elem=this.elem;if(F()&&o.timers.push(F)&&!n){n=setInterval(function(){var K=o.timers;for(var J=0;J<K.length;J++){if(!K[J]()){K.splice(J--,1)}}if(!K.length){clearInterval(n);n=g}},13)}},show:function(){this.options.orig[this.prop]=o.attr(this.elem.style,this.prop);this.options.show=true;this.custom(this.prop=="width"||this.prop=="height"?1:0,this.cur());o(this.elem).show()},hide:function(){this.options.orig[this.prop]=o.attr(this.elem.style,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(H){var G=e();if(H||G>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;var E=true;for(var F in this.options.curAnim){if(this.options.curAnim[F]!==true){E=false}}if(E){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;this.elem.style.display=this.options.display;if(o.css(this.elem,"display")=="none"){this.elem.style.display="block"}}if(this.options.hide){o(this.elem).hide()}if(this.options.hide||this.options.show){for(var I in this.options.curAnim){o.attr(this.elem.style,I,this.options.orig[I])}}this.options.complete.call(this.elem)}return false}else{var J=G-this.startTime;this.state=J/this.options.duration;this.pos=o.easing[this.options.easing||(o.easing.swing?"swing":"linear")](this.state,J,0,1,this.options.duration);this.now=this.start+((this.end-this.start)*this.pos);this.update()}return true}};o.extend(o.fx,{speeds:{slow:600,fast:200,_default:400},step:{opacity:function(E){o.attr(E.elem.style,"opacity",E.now)},_default:function(E){if(E.elem.style&&E.elem.style[E.prop]!=null){E.elem.style[E.prop]=E.now+E.unit}else{E.elem[E.prop]=E.now}}}});if(document.documentElement.getBoundingClientRect){o.fn.offset=function(){if(!this[0]){return{top:0,left:0}}if(this[0]===this[0].ownerDocument.body){return o.offset.bodyOffset(this[0])}var G=this[0].getBoundingClientRect(),J=this[0].ownerDocument,F=J.body,E=J.documentElement,L=E.clientTop||F.clientTop||0,K=E.clientLeft||F.clientLeft||0,I=G.top+(self.pageYOffset||o.boxModel&&E.scrollTop||F.scrollTop)-L,H=G.left+(self.pageXOffset||o.boxModel&&E.scrollLeft||F.scrollLeft)-K;return{top:I,left:H}}}else{o.fn.offset=function(){if(!this[0]){return{top:0,left:0}}if(this[0]===this[0].ownerDocument.body){return o.offset.bodyOffset(this[0])}o.offset.initialized||o.offset.initialize();var J=this[0],G=J.offsetParent,F=J,O=J.ownerDocument,M,H=O.documentElement,K=O.body,L=O.defaultView,E=L.getComputedStyle(J,null),N=J.offsetTop,I=J.offsetLeft;while((J=J.parentNode)&&J!==K&&J!==H){M=L.getComputedStyle(J,null);N-=J.scrollTop,I-=J.scrollLeft;if(J===G){N+=J.offsetTop,I+=J.offsetLeft;if(o.offset.doesNotAddBorder&&!(o.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(J.tagName))){N+=parseInt(M.borderTopWidth,10)||0,I+=parseInt(M.borderLeftWidth,10)||0}F=G,G=J.offsetParent}if(o.offset.subtractsBorderForOverflowNotVisible&&M.overflow!=="visible"){N+=parseInt(M.borderTopWidth,10)||0,I+=parseInt(M.borderLeftWidth,10)||0}E=M}if(E.position==="relative"||E.position==="static"){N+=K.offsetTop,I+=K.offsetLeft}if(E.position==="fixed"){N+=Math.max(H.scrollTop,K.scrollTop),I+=Math.max(H.scrollLeft,K.scrollLeft)}return{top:N,left:I}}}o.offset={initialize:function(){if(this.initialized){return}var L=document.body,F=document.createElement("div"),H,G,N,I,M,E,J=L.style.marginTop,K='<div style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;"><div></div></div><table style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;" cellpadding="0" cellspacing="0"><tr><td></td></tr></table>';M={position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"};for(E in M){F.style[E]=M[E]}F.innerHTML=K;L.insertBefore(F,L.firstChild);H=F.firstChild,G=H.firstChild,I=H.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(G.offsetTop!==5);this.doesAddBorderForTableAndCells=(I.offsetTop===5);H.style.overflow="hidden",H.style.position="relative";this.subtractsBorderForOverflowNotVisible=(G.offsetTop===-5);L.style.marginTop="1px";this.doesNotIncludeMarginInBodyOffset=(L.offsetTop===0);L.style.marginTop=J;L.removeChild(F);this.initialized=true},bodyOffset:function(E){o.offset.initialized||o.offset.initialize();var G=E.offsetTop,F=E.offsetLeft;if(o.offset.doesNotIncludeMarginInBodyOffset){G+=parseInt(o.curCSS(E,"marginTop",true),10)||0,F+=parseInt(o.curCSS(E,"marginLeft",true),10)||0}return{top:G,left:F}}};o.fn.extend({position:function(){var I=0,H=0,F;if(this[0]){var G=this.offsetParent(),J=this.offset(),E=/^body|html$/i.test(G[0].tagName)?{top:0,left:0}:G.offset();J.top-=j(this,"marginTop");J.left-=j(this,"marginLeft");E.top+=j(G,"borderTopWidth");E.left+=j(G,"borderLeftWidth");F={top:J.top-E.top,left:J.left-E.left}}return F},offsetParent:function(){var E=this[0].offsetParent||document.body;while(E&&(!/^body|html$/i.test(E.tagName)&&o.css(E,"position")=="static")){E=E.offsetParent}return o(E)}});o.each(["Left","Top"],function(F,E){var G="scroll"+E;o.fn[G]=function(H){if(!this[0]){return null}return H!==g?this.each(function(){this==l||this==document?l.scrollTo(!F?H:o(l).scrollLeft(),F?H:o(l).scrollTop()):this[G]=H}):this[0]==l||this[0]==document?self[F?"pageYOffset":"pageXOffset"]||o.boxModel&&document.documentElement[G]||document.body[G]:this[0][G]}});o.each(["Height","Width"],function(I,G){var E=I?"Left":"Top",H=I?"Right":"Bottom",F=G.toLowerCase();o.fn["inner"+G]=function(){return this[0]?o.css(this[0],F,false,"padding"):null};o.fn["outer"+G]=function(K){return this[0]?o.css(this[0],F,false,K?"margin":"border"):null};var J=G.toLowerCase();o.fn[J]=function(K){return this[0]==l?document.compatMode=="CSS1Compat"&&document.documentElement["client"+G]||document.body["client"+G]:this[0]==document?Math.max(document.documentElement["client"+G],document.body["scroll"+G],document.documentElement["scroll"+G],document.body["offset"+G],document.documentElement["offset"+G]):K===g?(this.length?o.css(this[0],J):null):this.css(J,typeof K==="string"?K:K+"px")}})})();
\ No newline at end of file
diff --git a/auth/saml/resources/jquery-ui-1.7.2.custom.min.js b/auth/saml/resources/jquery-ui-1.7.2.custom.min.js
new file mode 100755
index 0000000..203df4d
--- /dev/null
+++ b/auth/saml/resources/jquery-ui-1.7.2.custom.min.js
@@ -0,0 +1,22 @@
+/*
+ * jQuery UI 1.7.2
+ *
+ * Copyright (c) 2009 AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT (MIT-LICENSE.txt)
+ * and GPL (GPL-LICENSE.txt) licenses.
+ *
+ * http://docs.jquery.com/UI
+ */
+jQuery.ui||(function(c){var i=c.fn.remove,d=c.browser.mozilla&&(parseFloat(c.browser.version)<1.9);c.ui={version:"1.7.2",plugin:{add:function(k,l,n){var m=c.ui[k].prototype;for(var j in n){m.plugins[j]=m.plugins[j]||[];m.plugins[j].push([l,n[j]])}},call:function(j,l,k){var n=j.plugins[l];if(!n||!j.element[0].parentNode){return}for(var m=0;m<n.length;m++){if(j.options[n[m][0]]){n[m][1].apply(j.element,k)}}}},contains:function(k,j){return document.compareDocumentPosition?k.compareDocumentPosition(j)&16:k!==j&&k.contains(j)},hasScroll:function(m,k){if(c(m).css("overflow")=="hidden"){return false}var j=(k&&k=="left")?"scrollLeft":"scrollTop",l=false;if(m[j]>0){return true}m[j]=1;l=(m[j]>0);m[j]=0;return l},isOverAxis:function(k,j,l){return(k>j)&&(k<(j+l))},isOver:function(o,k,n,m,j,l){return c.ui.isOverAxis(o,n,j)&&c.ui.isOverAxis(k,m,l)},keyCode:{BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}};if(d){var f=c.attr,e=c.fn.removeAttr,h="http://www.w3.org/2005/07/aaa",a=/^aria-/,b=/^wairole:/;c.attr=function(k,j,l){var m=l!==undefined;return(j=="role"?(m?f.call(this,k,j,"wairole:"+l):(f.apply(this,arguments)||"").replace(b,"")):(a.test(j)?(m?k.setAttributeNS(h,j.replace(a,"aaa:"),l):f.call(this,k,j.replace(a,"aaa:"))):f.apply(this,arguments)))};c.fn.removeAttr=function(j){return(a.test(j)?this.each(function(){this.removeAttributeNS(h,j.replace(a,""))}):e.call(this,j))}}c.fn.extend({remove:function(){c("*",this).add(this).each(function(){c(this).triggerHandler("remove")});return i.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false})},scrollParent:function(){var j;if((c.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){j=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(c.curCSS(this,"position",1))&&(/(auto|scroll)/).test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0)}else{j=this.parents().filter(function(){return(/(auto|scroll)/).test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!j.length?c(document):j}});c.extend(c.expr[":"],{data:function(l,k,j){return !!c.data(l,j[3])},focusable:function(k){var l=k.nodeName.toLowerCase(),j=c.attr(k,"tabindex");return(/input|select|textarea|button|object/.test(l)?!k.disabled:"a"==l||"area"==l?k.href||!isNaN(j):!isNaN(j))&&!c(k)["area"==l?"parents":"closest"](":hidden").length},tabbable:function(k){var j=c.attr(k,"tabindex");return(isNaN(j)||j>=0)&&c(k).is(":focusable")}});function g(m,n,o,l){function k(q){var p=c[m][n][q]||[];return(typeof p=="string"?p.split(/,?\s+/):p)}var j=k("getter");if(l.length==1&&typeof l[0]=="string"){j=j.concat(k("getterSetter"))}return(c.inArray(o,j)!=-1)}c.widget=function(k,j){var l=k.split(".")[0];k=k.split(".")[1];c.fn[k]=function(p){var n=(typeof p=="string"),o=Array.prototype.slice.call(arguments,1);if(n&&p.substring(0,1)=="_"){return this}if(n&&g(l,k,p,o)){var m=c.data(this[0],k);return(m?m[p].apply(m,o):undefined)}return this.each(function(){var q=c.data(this,k);(!q&&!n&&c.data(this,k,new c[l][k](this,p))._init());(q&&n&&c.isFunction(q[p])&&q[p].apply(q,o))})};c[l]=c[l]||{};c[l][k]=function(o,n){var m=this;this.namespace=l;this.widgetName=k;this.widgetEventPrefix=c[l][k].eventPrefix||k;this.widgetBaseClass=l+"-"+k;this.options=c.extend({},c.widget.defaults,c[l][k].defaults,c.metadata&&c.metadata.get(o)[k],n);this.element=c(o).bind("setData."+k,function(q,p,r){if(q.target==o){return m._setData(p,r)}}).bind("getData."+k,function(q,p){if(q.target==o){return m._getData(p)}}).bind("remove",function(){return m.destroy()})};c[l][k].prototype=c.extend({},c.widget.prototype,j);c[l][k].getterSetter="option"};c.widget.prototype={_init:function(){},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled")},option:function(l,m){var k=l,j=this;if(typeof l=="string"){if(m===undefined){return this._getData(l)}k={};k[l]=m}c.each(k,function(n,o){j._setData(n,o)})},_getData:function(j){return this.options[j]},_setData:function(j,k){this.options[j]=k;if(j=="disabled"){this.element[k?"addClass":"removeClass"](this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",k)}},enable:function(){this._setData("disabled",false)},disable:function(){this._setData("disabled",true)},_trigger:function(l,m,n){var p=this.options[l],j=(l==this.widgetEventPrefix?l:this.widgetEventPrefix+l);m=c.Event(m);m.type=j;if(m.originalEvent){for(var k=c.event.props.length,o;k;){o=c.event.props[--k];m[o]=m.originalEvent[o]}}this.element.trigger(m,n);return !(c.isFunction(p)&&p.call(this.element[0],m,n)===false||m.isDefaultPrevented())}};c.widget.defaults={disabled:false};c.ui.mouse={_mouseInit:function(){var j=this;this.element.bind("mousedown."+this.widgetName,function(k){return j._mouseDown(k)}).bind("click."+this.widgetName,function(k){if(j._preventClickEvent){j._preventClickEvent=false;k.stopImmediatePropagation();return false}});if(c.browser.msie){this._mouseUnselectable=this.element.attr("unselectable");this.element.attr("unselectable","on")}this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);(c.browser.msie&&this.element.attr("unselectable",this._mouseUnselectable))},_mouseDown:function(l){l.originalEvent=l.originalEvent||{};if(l.originalEvent.mouseHandled){return}(this._mouseStarted&&this._mouseUp(l));this._mouseDownEvent=l;var k=this,m=(l.which==1),j=(typeof this.options.cancel=="string"?c(l.target).parents().add(l.target).filter(this.options.cancel).length:false);if(!m||j||!this._mouseCapture(l)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){k.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(l)&&this._mouseDelayMet(l)){this._mouseStarted=(this._mouseStart(l)!==false);if(!this._mouseStarted){l.preventDefault();return true}}this._mouseMoveDelegate=function(n){return k._mouseMove(n)};this._mouseUpDelegate=function(n){return k._mouseUp(n)};c(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);(c.browser.safari||l.preventDefault());l.originalEvent.mouseHandled=true;return true},_mouseMove:function(j){if(c.browser.msie&&!j.button){return this._mouseUp(j)}if(this._mouseStarted){this._mouseDrag(j);return j.preventDefault()}if(this._mouseDistanceMet(j)&&this._mouseDelayMet(j)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,j)!==false);(this._mouseStarted?this._mouseDrag(j):this._mouseUp(j))}return !this._mouseStarted},_mouseUp:function(j){c(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=(j.target==this._mouseDownEvent.target);this._mouseStop(j)}return false},_mouseDistanceMet:function(j){return(Math.max(Math.abs(this._mouseDownEvent.pageX-j.pageX),Math.abs(this._mouseDownEvent.pageY-j.pageY))>=this.options.distance)},_mouseDelayMet:function(j){return this.mouseDelayMet},_mouseStart:function(j){},_mouseDrag:function(j){},_mouseStop:function(j){},_mouseCapture:function(j){return true}};c.ui.mouse.defaults={cancel:null,distance:1,delay:0}})(jQuery);;/*
+ * jQuery UI Tabs 1.7.2
+ *
+ * Copyright (c) 2009 AUTHORS.txt (http://jqueryui.com/about)
+ * Dual licensed under the MIT (MIT-LICENSE.txt)
+ * and GPL (GPL-LICENSE.txt) licenses.
+ *
+ * http://docs.jquery.com/UI/Tabs
+ *
+ * Depends:
+ *	ui.core.js
+ */
+(function(a){a.widget("ui.tabs",{_init:function(){if(this.options.deselectable!==undefined){this.options.collapsible=this.options.deselectable}this._tabify(true)},_setData:function(b,c){if(b=="selected"){if(this.options.collapsible&&c==this.options.selected){return}this.select(c)}else{this.options[b]=c;if(b=="deselectable"){this.options.collapsible=c}this._tabify()}},_tabId:function(b){return b.title&&b.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,"")||this.options.idPrefix+a.data(b)},_sanitizeSelector:function(b){return b.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+a.data(this.list[0]));return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(c,b){return{tab:c,panel:b,index:this.anchors.index(c)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(n){this.list=this.element.children("ul:first");this.lis=a("li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return a("a",this)[0]});this.panels=a([]);var p=this,d=this.options;var c=/^#.+/;this.anchors.each(function(r,o){var q=a(o).attr("href");var s=q.split("#")[0],u;if(s&&(s===location.toString().split("#")[0]||(u=a("base")[0])&&s===u.href)){q=o.hash;o.href=q}if(c.test(q)){p.panels=p.panels.add(p._sanitizeSelector(q))}else{if(q!="#"){a.data(o,"href.tabs",q);a.data(o,"load.tabs",q.replace(/#.*$/,""));var w=p._tabId(o);o.href="#"+w;var v=a("#"+w);if(!v.length){v=a(d.panelTemplate).attr("id",w).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(p.panels[r-1]||p.list);v.data("destroy.tabs",true)}p.panels=p.panels.add(v)}else{d.disabled.push(r)}}});if(n){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(d.selected===undefined){if(location.hash){this.anchors.each(function(q,o){if(o.hash==location.hash){d.selected=q;return false}})}if(typeof d.selected!="number"&&d.cookie){d.selected=parseInt(p._cookie(),10)}if(typeof d.selected!="number"&&this.lis.filter(".ui-tabs-selected").length){d.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}d.selected=d.selected||0}else{if(d.selected===null){d.selected=-1}}d.selected=((d.selected>=0&&this.anchors[d.selected])||d.selected<0)?d.selected:0;d.disabled=a.unique(d.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(q,o){return p.lis.index(q)}))).sort();if(a.inArray(d.selected,d.disabled)!=-1){d.disabled.splice(a.inArray(d.selected,d.disabled),1)}this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(d.selected>=0&&this.anchors.length){this.panels.eq(d.selected).removeClass("ui-tabs-hide");this.lis.eq(d.selected).addClass("ui-tabs-selected ui-state-active");p.element.queue("tabs",function(){p._trigger("show",null,p._ui(p.anchors[d.selected],p.panels[d.selected]))});this.load(d.selected)}a(window).bind("unload",function(){p.lis.add(p.anchors).unbind(".tabs");p.lis=p.anchors=p.panels=null})}else{d.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}this.element[d.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");if(d.cookie){this._cookie(d.selected,d.cookie)}for(var g=0,m;(m=this.lis[g]);g++){a(m)[a.inArray(g,d.disabled)!=-1&&!a(m).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled")}if(d.cache===false){this.anchors.removeData("cache.tabs")}this.lis.add(this.anchors).unbind(".tabs");if(d.event!="mouseover"){var f=function(o,i){if(i.is(":not(.ui-state-disabled)")){i.addClass("ui-state-"+o)}};var j=function(o,i){i.removeClass("ui-state-"+o)};this.lis.bind("mouseover.tabs",function(){f("hover",a(this))});this.lis.bind("mouseout.tabs",function(){j("hover",a(this))});this.anchors.bind("focus.tabs",function(){f("focus",a(this).closest("li"))});this.anchors.bind("blur.tabs",function(){j("focus",a(this).closest("li"))})}var b,h;if(d.fx){if(a.isArray(d.fx)){b=d.fx[0];h=d.fx[1]}else{b=h=d.fx}}function e(i,o){i.css({display:""});if(a.browser.msie&&o.opacity){i[0].style.removeAttribute("filter")}}var k=h?function(i,o){a(i).closest("li").removeClass("ui-state-default").addClass("ui-tabs-selected ui-state-active");o.hide().removeClass("ui-tabs-hide").animate(h,h.duration||"normal",function(){e(o,h);p._trigger("show",null,p._ui(i,o[0]))})}:function(i,o){a(i).closest("li").removeClass("ui-state-default").addClass("ui-tabs-selected ui-state-active");o.removeClass("ui-tabs-hide");p._trigger("show",null,p._ui(i,o[0]))};var l=b?function(o,i){i.animate(b,b.duration||"normal",function(){p.lis.removeClass("ui-tabs-selected ui-state-active").addClass("ui-state-default");i.addClass("ui-tabs-hide");e(i,b);p.element.dequeue("tabs")})}:function(o,i,q){p.lis.removeClass("ui-tabs-selected ui-state-active").addClass("ui-state-default");i.addClass("ui-tabs-hide");p.element.dequeue("tabs")};this.anchors.bind(d.event+".tabs",function(){var o=this,r=a(this).closest("li"),i=p.panels.filter(":not(.ui-tabs-hide)"),q=a(p._sanitizeSelector(this.hash));if((r.hasClass("ui-tabs-selected")&&!d.collapsible)||r.hasClass("ui-state-disabled")||r.hasClass("ui-state-processing")||p._trigger("select",null,p._ui(this,q[0]))===false){this.blur();return false}d.selected=p.anchors.index(this);p.abort();if(d.collapsible){if(r.hasClass("ui-tabs-selected")){d.selected=-1;if(d.cookie){p._cookie(d.selected,d.cookie)}p.element.queue("tabs",function(){l(o,i)}).dequeue("tabs");this.blur();return false}else{if(!i.length){if(d.cookie){p._cookie(d.selected,d.cookie)}p.element.queue("tabs",function(){k(o,q)});p.load(p.anchors.index(this));this.blur();return false}}}if(d.cookie){p._cookie(d.selected,d.cookie)}if(q.length){if(i.length){p.element.queue("tabs",function(){l(o,i)})}p.element.queue("tabs",function(){k(o,q)});p.load(p.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}if(a.browser.msie){this.blur()}});this.anchors.bind("click.tabs",function(){return false})},destroy:function(){var b=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var c=a.data(this,"href.tabs");if(c){this.href=c}var d=a(this).unbind(".tabs");a.each(["href","load","cache"],function(e,f){d.removeData(f+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){if(a.data(this,"destroy.tabs")){a(this).remove()}else{a(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}});if(b.cookie){this._cookie(null,b.cookie)}},add:function(e,d,c){if(c===undefined){c=this.anchors.length}var b=this,g=this.options,i=a(g.tabTemplate.replace(/#\{href\}/g,e).replace(/#\{label\}/g,d)),h=!e.indexOf("#")?e.replace("#",""):this._tabId(a("a",i)[0]);i.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var f=a("#"+h);if(!f.length){f=a(g.panelTemplate).attr("id",h).data("destroy.tabs",true)}f.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(c>=this.lis.length){i.appendTo(this.list);f.appendTo(this.list[0].parentNode)}else{i.insertBefore(this.lis[c]);f.insertBefore(this.panels[c])}g.disabled=a.map(g.disabled,function(k,j){return k>=c?++k:k});this._tabify();if(this.anchors.length==1){i.addClass("ui-tabs-selected ui-state-active");f.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){b._trigger("show",null,b._ui(b.anchors[0],b.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[c],this.panels[c]))},remove:function(b){var d=this.options,e=this.lis.eq(b).remove(),c=this.panels.eq(b).remove();if(e.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(b+(b+1<this.anchors.length?1:-1))}d.disabled=a.map(a.grep(d.disabled,function(g,f){return g!=b}),function(g,f){return g>=b?--g:g});this._tabify();this._trigger("remove",null,this._ui(e.find("a")[0],c[0]))},enable:function(b){var c=this.options;if(a.inArray(b,c.disabled)==-1){return}this.lis.eq(b).removeClass("ui-state-disabled");c.disabled=a.grep(c.disabled,function(e,d){return e!=b});this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b]))},disable:function(c){var b=this,d=this.options;if(c!=d.selected){this.lis.eq(c).addClass("ui-state-disabled");d.disabled.push(c);d.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[c],this.panels[c]))}},select:function(b){if(typeof b=="string"){b=this.anchors.index(this.anchors.filter("[href$="+b+"]"))}else{if(b===null){b=-1}}if(b==-1&&this.options.collapsible){b=this.options.selected}this.anchors.eq(b).trigger(this.options.event+".tabs")},load:function(e){var c=this,g=this.options,b=this.anchors.eq(e)[0],d=a.data(b,"load.tabs");this.abort();if(!d||this.element.queue("tabs").length!==0&&a.data(b,"cache.tabs")){this.element.dequeue("tabs");return}this.lis.eq(e).addClass("ui-state-processing");if(g.spinner){var f=a("span",b);f.data("label.tabs",f.html()).html(g.spinner)}this.xhr=a.ajax(a.extend({},g.ajaxOptions,{url:d,success:function(i,h){a(c._sanitizeSelector(b.hash)).html(i);c._cleanup();if(g.cache){a.data(b,"cache.tabs",true)}c._trigger("load",null,c._ui(c.anchors[e],c.panels[e]));try{g.ajaxOptions.success(i,h)}catch(j){}c.element.dequeue("tabs")}}))},abort:function(){this.element.queue([]);this.panels.stop(false,true);if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup()},url:function(c,b){this.anchors.eq(c).removeData("cache.tabs").data("load.tabs",b)},length:function(){return this.anchors.length}});a.extend(a.ui.tabs,{version:"1.7.2",getter:"length",defaults:{ajaxOptions:null,cache:false,cookie:null,collapsible:false,disabled:[],event:"click",fx:null,idPrefix:"ui-tabs-",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>",tabTemplate:'<li><a href="#{href}"><span>#{label}</span></a></li>'}});a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(d,f){var b=this,g=this.options;var c=b._rotate||(b._rotate=function(h){clearTimeout(b.rotation);b.rotation=setTimeout(function(){var i=g.selected;b.select(++i<b.anchors.length?i:0)},d);if(h){h.stopPropagation()}});var e=b._unrotate||(b._unrotate=!f?function(h){if(h.clientX){b.rotate(null)}}:function(h){t=g.selected;c()});if(d){this.element.bind("tabsshow",c);this.anchors.bind(g.event+".tabs",e);c()}else{clearTimeout(b.rotation);this.element.unbind("tabsshow",c);this.anchors.unbind(g.event+".tabs",e);delete this._rotate;delete this._unrotate}}})})(jQuery);;
\ No newline at end of file
diff --git a/auth/saml/resources/moodle_saml.css b/auth/saml/resources/moodle_saml.css
new file mode 100755
index 0000000..353766c
--- /dev/null
+++ b/auth/saml/resources/moodle_saml.css
@@ -0,0 +1,7 @@
+td.center { text-align:center;}
+td.left { text-align:left; }
+td.right { text-align:right; }
+table.center {margin-left:auto;margin-right:auto;}
+
+div#tabdiv ul li { list-style-type:none !important;}
+
diff --git a/auth/saml/resources/moodle_saml.js b/auth/saml/resources/moodle_saml.js
new file mode 100755
index 0000000..aac86be
--- /dev/null
+++ b/auth/saml/resources/moodle_saml.js
@@ -0,0 +1,70 @@
+var printf = function(string){
+    if (arguments.length <2) { return string; }
+        for (var i=1; i<arguments.length; i++)
+        { string = string.replace(/%d/, arguments[i]); }
+        return string;
+}
+
+function addNewField(area,field, type) {
+    var field_area = document.getElementById(area);
+    var total = document.getElementById('new_' + type + 's_total');
+    var count = parseInt(total.value) + 1;
+    var field_name = "new_" + type;
+
+    var select = document.getElementById('new' + type + '_select_0');
+    var new_select = select.cloneNode(true);
+    
+    total.value = count;
+
+
+    if (document.createElement) {
+        var tr = document.createElement("tr");
+        if (type === 'course') {
+            for ($i = 0; $i < 3; $i++) {
+                var td$i = document.createElement("td");
+                var input$i = document.createElement("input");
+                tr.appendChild(td$i);
+                input$i.name = field_name + count + "[]";
+                switch ($i) {
+                    case 0:
+                        new_select.name = field_name + count + "[]";
+                        new_select.id = 'new' + type + '_select_' + count;
+                        td$i.style.paddingLeft = "38px";
+                        td$i.colSpan = "2";
+                        td$i.appendChild(new_select);
+                        break;
+                    default:
+                        if ($i == 1) {
+                            input$i.id = 'new' + type + "_saml_id_" + count;
+                        } else {
+                            input$i.id = 'new' + type + "_saml_period_" + count;
+                        }
+                        td$i.appendChild(input$i);
+                        break;
+                }
+            }
+        }
+        if (type === 'role') {
+            for ($i = 0; $i < 2; $i++) {
+                var td$i = document.createElement("td");
+                var input$i = document.createElement("input");
+                tr.appendChild(td$i);
+                input$i.name = field_name + count + "[]";
+                switch ($i) {
+                    case 0:
+                        new_select.name = field_name + count + "[]";
+                        new_select.id = 'new' + type + '_select_' + count;
+                        td$i.style.paddingLeft = "38px";
+                        td$i.colSpan = "2";
+                        td$i.appendChild(new_select);
+                        break;
+                    default:
+                        input$i.id = 'new' + type + "_saml_id_" + count;
+                        td$i.appendChild(input$i);
+                        break;
+                }
+            }
+        }
+        field_area.appendChild(tr);
+    }
+}
diff --git a/auth/saml/resources/ui.core.css b/auth/saml/resources/ui.core.css
new file mode 100755
index 0000000..d832ad7
--- /dev/null
+++ b/auth/saml/resources/ui.core.css
@@ -0,0 +1,37 @@
+/*
+* jQuery UI CSS Framework
+* Copyright (c) 2009 AUTHORS.txt (http://ui.jquery.com/about)
+* Dual licensed under the MIT (MIT-LICENSE.txt) and GPL (GPL-LICENSE.txt) licenses.
+*/
+
+/* Layout helpers
+----------------------------------*/
+.ui-helper-hidden { display: none; }
+.ui-helper-hidden-accessible { position: absolute; left: -99999999px; }
+.ui-helper-reset { margin: 0; padding: 0; border: 0; outline: 0; line-height: 1.3; text-decoration: none; font-size: 100%; list-style: none; }
+.ui-helper-clearfix:after { content: "."; display: block; height: 0; clear: both; visibility: hidden; }
+.ui-helper-clearfix { display: inline-block; }
+/* required comment for clearfix to work in Opera \*/
+* html .ui-helper-clearfix { height:1%; }
+.ui-helper-clearfix { display:block; }
+/* end clearfix */
+.ui-helper-zfix { width: 100%; height: 100%; top: 0; left: 0; position: absolute; opacity: 0; filter:Alpha(Opacity=0); }
+
+
+/* Interaction Cues
+----------------------------------*/
+.ui-state-disabled { cursor: default !important; }
+
+
+/* Icons
+----------------------------------*/
+
+/* states and images */
+.ui-icon { display: block; text-indent: -99999px; overflow: hidden; background-repeat: no-repeat; }
+
+
+/* Misc visuals
+----------------------------------*/
+
+/* Overlays */
+.ui-widget-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
\ No newline at end of file
diff --git a/auth/saml/resources/ui.tabs.css b/auth/saml/resources/ui.tabs.css
new file mode 100755
index 0000000..3ca6b9a
--- /dev/null
+++ b/auth/saml/resources/ui.tabs.css
@@ -0,0 +1,11 @@
+/* Tabs
+----------------------------------*/
+.ui-tabs { padding: .2em; zoom: 1; }
+.ui-tabs .ui-tabs-nav { list-style: none; position: relative; padding: .2em .2em 0; }
+.ui-tabs .ui-tabs-nav li { position: relative; float: left; border-bottom-width: 0 !important; margin: 0 .2em -1px 0; padding: 0; }
+.ui-tabs .ui-tabs-nav li a { float: left; text-decoration: none; padding: .5em 1em; }
+.ui-tabs .ui-tabs-nav li.ui-tabs-selected { padding-bottom: 1px; border-bottom-width: 0; }
+.ui-tabs .ui-tabs-nav li.ui-tabs-selected a, .ui-tabs .ui-tabs-nav li.ui-state-disabled a, .ui-tabs .ui-tabs-nav li.ui-state-processing a { cursor: text; }
+.ui-tabs .ui-tabs-nav li a, .ui-tabs.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-selected a { cursor: pointer; } /* first selector in group seems obsolete, but required to overcome bug in Opera applying cursor: text overall if defined elsewhere... */
+.ui-tabs .ui-tabs-panel { padding: 1em 1.4em; display: block; border-width: 0; background: none; }
+.ui-tabs .ui-tabs-hide { display: none !important; }
diff --git a/auth/saml/resources/ui.theme.css b/auth/saml/resources/ui.theme.css
new file mode 100755
index 0000000..c0cd08f
--- /dev/null
+++ b/auth/saml/resources/ui.theme.css
@@ -0,0 +1,243 @@
+
+
+/*
+* jQuery UI CSS Framework
+* Copyright (c) 2009 AUTHORS.txt (http://ui.jquery.com/about)
+* Dual licensed under the MIT (MIT-LICENSE.txt) and GPL (GPL-LICENSE.txt) licenses.
+* To view and modify this theme, visit http://ui.jquery.com/themeroller/?tr=&ffDefault=Verdana,Arial,sans-serif&fwDefault=normal&fsDefault=1.1em&cornerRadius=4px&bgColorHeader=cccccc&bgTextureHeader=03_highlight_soft.png&bgImgOpacityHeader=75&borderColorHeader=aaaaaa&fcHeader=222222&iconColorHeader=222222&bgColorContent=ffffff&bgTextureContent=01_flat.png&bgImgOpacityContent=75&borderColorContent=aaaaaa&fcContent=222222&iconColorContent=222222&bgColorDefault=e6e6e6&bgTextureDefault=02_glass.png&bgImgOpacityDefault=75&borderColorDefault=d3d3d3&fcDefault=555555&iconColorDefault=888888&bgColorHover=dadada&bgTextureHover=02_glass.png&bgImgOpacityHover=75&borderColorHover=999999&fcHover=212121&iconColorHover=454545&bgColorActive=ffffff&bgTextureActive=02_glass.png&bgImgOpacityActive=65&borderColorActive=aaaaaa&fcActive=212121&iconColorActive=454545&bgColorHighlight=fbf9ee&bgTextureHighlight=02_glass.png&bgImgOpacityHighlight=55&borderColorHighlight=fcefa1&fcHighlight=363636&iconColorHighlight=2e83ff&bgColorError=fef1ec&bgTextureError=02_glass.png&bgImgOpacityError=95&borderColorError=cd0a0a&fcError=cd0a0a&iconColorError=cd0a0a&bgColorOverlay=aaaaaa&bgTextureOverlay=01_flat.png&bgImgOpacityOverlay=0&opacityOverlay=30&bgColorShadow=aaaaaa&bgTextureShadow=01_flat.png&bgImgOpacityShadow=0&opacityShadow=30&thicknessShadow=8px&offsetTopShadow=-8px&offsetLeftShadow=-8px&cornerRadiusShadow=8px
+*/
+
+
+/* Component containers
+----------------------------------*/
+/* .ui-widget { font-family: Verdana,Arial,sans-serif; font-size: 1.1em; } */
+.ui-widget input, .ui-widget select, .ui-widget textarea, .ui-widget button { font-family: Verdana,Arial,sans-serif; font-size: 1em; }
+.ui-widget-header { border: 1px solid #aaaaaa; background: #cccccc url(images/ui-bg_highlight-soft_75_cccccc_1x100.png) 50% 50% repeat-x; color: #222222; font-weight: bold; }
+.ui-widget-header a { color: #222222; }
+.ui-widget-content { border: 1px solid #aaaaaa; background: #ffffff url(images/ui-bg_flat_75_ffffff_40x100.png) 50% 50% repeat-x; color: #222222; }
+.ui-widget-content a { color: #222222; }
+
+/* Interaction states
+----------------------------------*/
+.ui-state-default, .ui-widget-content .ui-state-default { border: 1px solid #d3d3d3; background: #e6e6e6 url(images/ui-bg_glass_75_e6e6e6_1x400.png) 50% 50% repeat-x; font-weight: normal; color: #555555; outline: none; }
+.ui-state-default a { color: #555555; text-decoration: none; outline: none; }
+.ui-state-hover, .ui-widget-content .ui-state-hover, .ui-state-focus, .ui-widget-content .ui-state-focus { border: 1px solid #999999; background: #dadada url(images/ui-bg_glass_75_dadada_1x400.png) 50% 50% repeat-x; font-weight: normal; color: #212121; outline: none; }
+.ui-state-hover a { color: #212121; text-decoration: none; outline: none; }
+.ui-state-active, .ui-widget-content .ui-state-active { border: 1px solid #aaaaaa; background: #ffffff url(images/ui-bg_glass_65_ffffff_1x400.png) 50% 50% repeat-x; font-weight: normal; color: #212121; outline: none; }
+.ui-state-active a { color: #212121; outline: none; text-decoration: none; }
+
+/* Interaction Cues
+----------------------------------*/
+.ui-state-highlight, .ui-widget-content .ui-state-highlight {border: 1px solid #fcefa1; background: #fbf9ee url(images/ui-bg_glass_55_fbf9ee_1x400.png) 50% 50% repeat-x; color: #363636; }
+.ui-state-error, .ui-widget-content .ui-state-error {border: 1px solid #cd0a0a; background: #fef1ec url(images/ui-bg_glass_95_fef1ec_1x400.png) 50% 50% repeat-x; color: #cd0a0a; }
+.ui-state-error-text, .ui-widget-content .ui-state-error-text { color: #cd0a0a; }
+.ui-state-disabled, .ui-widget-content .ui-state-disabled { opacity: .35; filter:Alpha(Opacity=35); background-image: none; }
+.ui-priority-primary, .ui-widget-content .ui-priority-primary { font-weight: bold; }
+.ui-priority-secondary, .ui-widget-content .ui-priority-secondary { opacity: .7; filter:Alpha(Opacity=70); font-weight: normal; }
+
+/* Icons
+----------------------------------*/
+
+/* states and images */
+.ui-icon { width: 16px; height: 16px; background-image: url(images/ui-icons_222222_256x240.png); }
+.ui-widget-content .ui-icon {background-image: url(images/ui-icons_222222_256x240.png); }
+.ui-widget-header .ui-icon {background-image: url(images/ui-icons_222222_256x240.png); }
+.ui-state-default .ui-icon { background-image: url(images/ui-icons_888888_256x240.png); }
+.ui-state-hover .ui-icon, .ui-state-focus .ui-icon {background-image: url(images/ui-icons_454545_256x240.png); }
+.ui-state-active .ui-icon {background-image: url(images/ui-icons_454545_256x240.png); }
+.ui-state-highlight .ui-icon {background-image: url(images/ui-icons_2e83ff_256x240.png); }
+.ui-state-error .ui-icon, .ui-state-error-text .ui-icon {background-image: url(images/ui-icons_cd0a0a_256x240.png); }
+
+/* positioning */
+.ui-icon-carat-1-n { background-position: 0 0; }
+.ui-icon-carat-1-ne { background-position: -16px 0; }
+.ui-icon-carat-1-e { background-position: -32px 0; }
+.ui-icon-carat-1-se { background-position: -48px 0; }
+.ui-icon-carat-1-s { background-position: -64px 0; }
+.ui-icon-carat-1-sw { background-position: -80px 0; }
+.ui-icon-carat-1-w { background-position: -96px 0; }
+.ui-icon-carat-1-nw { background-position: -112px 0; }
+.ui-icon-carat-2-n-s { background-position: -128px 0; }
+.ui-icon-carat-2-e-w { background-position: -144px 0; }
+.ui-icon-triangle-1-n { background-position: 0 -16px; }
+.ui-icon-triangle-1-ne { background-position: -16px -16px; }
+.ui-icon-triangle-1-e { background-position: -32px -16px; }
+.ui-icon-triangle-1-se { background-position: -48px -16px; }
+.ui-icon-triangle-1-s { background-position: -64px -16px; }
+.ui-icon-triangle-1-sw { background-position: -80px -16px; }
+.ui-icon-triangle-1-w { background-position: -96px -16px; }
+.ui-icon-triangle-1-nw { background-position: -112px -16px; }
+.ui-icon-triangle-2-n-s { background-position: -128px -16px; }
+.ui-icon-triangle-2-e-w { background-position: -144px -16px; }
+.ui-icon-arrow-1-n { background-position: 0 -32px; }
+.ui-icon-arrow-1-ne { background-position: -16px -32px; }
+.ui-icon-arrow-1-e { background-position: -32px -32px; }
+.ui-icon-arrow-1-se { background-position: -48px -32px; }
+.ui-icon-arrow-1-s { background-position: -64px -32px; }
+.ui-icon-arrow-1-sw { background-position: -80px -32px; }
+.ui-icon-arrow-1-w { background-position: -96px -32px; }
+.ui-icon-arrow-1-nw { background-position: -112px -32px; }
+.ui-icon-arrow-2-n-s { background-position: -128px -32px; }
+.ui-icon-arrow-2-ne-sw { background-position: -144px -32px; }
+.ui-icon-arrow-2-e-w { background-position: -160px -32px; }
+.ui-icon-arrow-2-se-nw { background-position: -176px -32px; }
+.ui-icon-arrowstop-1-n { background-position: -192px -32px; }
+.ui-icon-arrowstop-1-e { background-position: -208px -32px; }
+.ui-icon-arrowstop-1-s { background-position: -224px -32px; }
+.ui-icon-arrowstop-1-w { background-position: -240px -32px; }
+.ui-icon-arrowthick-1-n { background-position: 0 -48px; }
+.ui-icon-arrowthick-1-ne { background-position: -16px -48px; }
+.ui-icon-arrowthick-1-e { background-position: -32px -48px; }
+.ui-icon-arrowthick-1-se { background-position: -48px -48px; }
+.ui-icon-arrowthick-1-s { background-position: -64px -48px; }
+.ui-icon-arrowthick-1-sw { background-position: -80px -48px; }
+.ui-icon-arrowthick-1-w { background-position: -96px -48px; }
+.ui-icon-arrowthick-1-nw { background-position: -112px -48px; }
+.ui-icon-arrowthick-2-n-s { background-position: -128px -48px; }
+.ui-icon-arrowthick-2-ne-sw { background-position: -144px -48px; }
+.ui-icon-arrowthick-2-e-w { background-position: -160px -48px; }
+.ui-icon-arrowthick-2-se-nw { background-position: -176px -48px; }
+.ui-icon-arrowthickstop-1-n { background-position: -192px -48px; }
+.ui-icon-arrowthickstop-1-e { background-position: -208px -48px; }
+.ui-icon-arrowthickstop-1-s { background-position: -224px -48px; }
+.ui-icon-arrowthickstop-1-w { background-position: -240px -48px; }
+.ui-icon-arrowreturnthick-1-w { background-position: 0 -64px; }
+.ui-icon-arrowreturnthick-1-n { background-position: -16px -64px; }
+.ui-icon-arrowreturnthick-1-e { background-position: -32px -64px; }
+.ui-icon-arrowreturnthick-1-s { background-position: -48px -64px; }
+.ui-icon-arrowreturn-1-w { background-position: -64px -64px; }
+.ui-icon-arrowreturn-1-n { background-position: -80px -64px; }
+.ui-icon-arrowreturn-1-e { background-position: -96px -64px; }
+.ui-icon-arrowreturn-1-s { background-position: -112px -64px; }
+.ui-icon-arrowrefresh-1-w { background-position: -128px -64px; }
+.ui-icon-arrowrefresh-1-n { background-position: -144px -64px; }
+.ui-icon-arrowrefresh-1-e { background-position: -160px -64px; }
+.ui-icon-arrowrefresh-1-s { background-position: -176px -64px; }
+.ui-icon-arrow-4 { background-position: 0 -80px; }
+.ui-icon-arrow-4-diag { background-position: -16px -80px; }
+.ui-icon-extlink { background-position: -32px -80px; }
+.ui-icon-newwin { background-position: -48px -80px; }
+.ui-icon-refresh { background-position: -64px -80px; }
+.ui-icon-shuffle { background-position: -80px -80px; }
+.ui-icon-transfer-e-w { background-position: -96px -80px; }
+.ui-icon-transferthick-e-w { background-position: -112px -80px; }
+.ui-icon-folder-collapsed { background-position: 0 -96px; }
+.ui-icon-folder-open { background-position: -16px -96px; }
+.ui-icon-document { background-position: -32px -96px; }
+.ui-icon-document-b { background-position: -48px -96px; }
+.ui-icon-note { background-position: -64px -96px; }
+.ui-icon-mail-closed { background-position: -80px -96px; }
+.ui-icon-mail-open { background-position: -96px -96px; }
+.ui-icon-suitcase { background-position: -112px -96px; }
+.ui-icon-comment { background-position: -128px -96px; }
+.ui-icon-person { background-position: -144px -96px; }
+.ui-icon-print { background-position: -160px -96px; }
+.ui-icon-trash { background-position: -176px -96px; }
+.ui-icon-locked { background-position: -192px -96px; }
+.ui-icon-unlocked { background-position: -208px -96px; }
+.ui-icon-bookmark { background-position: -224px -96px; }
+.ui-icon-tag { background-position: -240px -96px; }
+.ui-icon-home { background-position: 0 -112px; }
+.ui-icon-flag { background-position: -16px -112px; }
+.ui-icon-calendar { background-position: -32px -112px; }
+.ui-icon-cart { background-position: -48px -112px; }
+.ui-icon-pencil { background-position: -64px -112px; }
+.ui-icon-clock { background-position: -80px -112px; }
+.ui-icon-disk { background-position: -96px -112px; }
+.ui-icon-calculator { background-position: -112px -112px; }
+.ui-icon-zoomin { background-position: -128px -112px; }
+.ui-icon-zoomout { background-position: -144px -112px; }
+.ui-icon-search { background-position: -160px -112px; }
+.ui-icon-wrench { background-position: -176px -112px; }
+.ui-icon-gear { background-position: -192px -112px; }
+.ui-icon-heart { background-position: -208px -112px; }
+.ui-icon-star { background-position: -224px -112px; }
+.ui-icon-link { background-position: -240px -112px; }
+.ui-icon-cancel { background-position: 0 -128px; }
+.ui-icon-plus { background-position: -16px -128px; }
+.ui-icon-plusthick { background-position: -32px -128px; }
+.ui-icon-minus { background-position: -48px -128px; }
+.ui-icon-minusthick { background-position: -64px -128px; }
+.ui-icon-close { background-position: -80px -128px; }
+.ui-icon-closethick { background-position: -96px -128px; }
+.ui-icon-key { background-position: -112px -128px; }
+.ui-icon-lightbulb { background-position: -128px -128px; }
+.ui-icon-scissors { background-position: -144px -128px; }
+.ui-icon-clipboard { background-position: -160px -128px; }
+.ui-icon-copy { background-position: -176px -128px; }
+.ui-icon-contact { background-position: -192px -128px; }
+.ui-icon-image { background-position: -208px -128px; }
+.ui-icon-video { background-position: -224px -128px; }
+.ui-icon-script { background-position: -240px -128px; }
+.ui-icon-alert { background-position: 0 -144px; }
+.ui-icon-info { background-position: -16px -144px; }
+.ui-icon-notice { background-position: -32px -144px; }
+.ui-icon-help { background-position: -48px -144px; }
+.ui-icon-check { background-position: -64px -144px; }
+.ui-icon-bullet { background-position: -80px -144px; }
+.ui-icon-radio-off { background-position: -96px -144px; }
+.ui-icon-radio-on { background-position: -112px -144px; }
+.ui-icon-pin-w { background-position: -128px -144px; }
+.ui-icon-pin-s { background-position: -144px -144px; }
+.ui-icon-play { background-position: 0 -160px; }
+.ui-icon-pause { background-position: -16px -160px; }
+.ui-icon-seek-next { background-position: -32px -160px; }
+.ui-icon-seek-prev { background-position: -48px -160px; }
+.ui-icon-seek-end { background-position: -64px -160px; }
+.ui-icon-seek-first { background-position: -80px -160px; }
+.ui-icon-stop { background-position: -96px -160px; }
+.ui-icon-eject { background-position: -112px -160px; }
+.ui-icon-volume-off { background-position: -128px -160px; }
+.ui-icon-volume-on { background-position: -144px -160px; }
+.ui-icon-power { background-position: 0 -176px; }
+.ui-icon-signal-diag { background-position: -16px -176px; }
+.ui-icon-signal { background-position: -32px -176px; }
+.ui-icon-battery-0 { background-position: -48px -176px; }
+.ui-icon-battery-1 { background-position: -64px -176px; }
+.ui-icon-battery-2 { background-position: -80px -176px; }
+.ui-icon-battery-3 { background-position: -96px -176px; }
+.ui-icon-circle-plus { background-position: 0 -192px; }
+.ui-icon-circle-minus { background-position: -16px -192px; }
+.ui-icon-circle-close { background-position: -32px -192px; }
+.ui-icon-circle-triangle-e { background-position: -48px -192px; }
+.ui-icon-circle-triangle-s { background-position: -64px -192px; }
+.ui-icon-circle-triangle-w { background-position: -80px -192px; }
+.ui-icon-circle-triangle-n { background-position: -96px -192px; }
+.ui-icon-circle-arrow-e { background-position: -112px -192px; }
+.ui-icon-circle-arrow-s { background-position: -128px -192px; }
+.ui-icon-circle-arrow-w { background-position: -144px -192px; }
+.ui-icon-circle-arrow-n { background-position: -160px -192px; }
+.ui-icon-circle-zoomin { background-position: -176px -192px; }
+.ui-icon-circle-zoomout { background-position: -192px -192px; }
+.ui-icon-circle-check { background-position: -208px -192px; }
+.ui-icon-circlesmall-plus { background-position: 0 -208px; }
+.ui-icon-circlesmall-minus { background-position: -16px -208px; }
+.ui-icon-circlesmall-close { background-position: -32px -208px; }
+.ui-icon-squaresmall-plus { background-position: -48px -208px; }
+.ui-icon-squaresmall-minus { background-position: -64px -208px; }
+.ui-icon-squaresmall-close { background-position: -80px -208px; }
+.ui-icon-grip-dotted-vertical { background-position: 0 -224px; }
+.ui-icon-grip-dotted-horizontal { background-position: -16px -224px; }
+.ui-icon-grip-solid-vertical { background-position: -32px -224px; }
+.ui-icon-grip-solid-horizontal { background-position: -48px -224px; }
+.ui-icon-gripsmall-diagonal-se { background-position: -64px -224px; }
+.ui-icon-grip-diagonal-se { background-position: -80px -224px; }
+
+
+/* Misc visuals
+----------------------------------*/
+
+/* Corner radius */
+.ui-corner-tl { -moz-border-radius-topleft: 4px; -webkit-border-top-left-radius: 4px; }
+.ui-corner-tr { -moz-border-radius-topright: 4px; -webkit-border-top-right-radius: 4px; }
+.ui-corner-bl { -moz-border-radius-bottomleft: 4px; -webkit-border-bottom-left-radius: 4px; }
+.ui-corner-br { -moz-border-radius-bottomright: 4px; -webkit-border-bottom-right-radius: 4px; }
+.ui-corner-top { -moz-border-radius-topleft: 4px; -webkit-border-top-left-radius: 4px; -moz-border-radius-topright: 4px; -webkit-border-top-right-radius: 4px; }
+.ui-corner-bottom { -moz-border-radius-bottomleft: 4px; -webkit-border-bottom-left-radius: 4px; -moz-border-radius-bottomright: 4px; -webkit-border-bottom-right-radius: 4px; }
+.ui-corner-right {  -moz-border-radius-topright: 4px; -webkit-border-top-right-radius: 4px; -moz-border-radius-bottomright: 4px; -webkit-border-bottom-right-radius: 4px; }
+.ui-corner-left { -moz-border-radius-topleft: 4px; -webkit-border-top-left-radius: 4px; -moz-border-radius-bottomleft: 4px; -webkit-border-bottom-left-radius: 4px; }
+.ui-corner-all { -moz-border-radius: 4px; -webkit-border-radius: 4px; }
+
+/* Overlays */
+.ui-widget-overlay { background: #aaaaaa url(images/ui-bg_flat_0_aaaaaa_40x100.png) 50% 50% repeat-x; opacity: .30;filter:Alpha(Opacity=30); }
+.ui-widget-shadow { margin: -8px 0 0 -8px; padding: 8px; background: #aaaaaa url(images/ui-bg_flat_0_aaaaaa_40x100.png) 50% 50% repeat-x; opacity: .30;filter:Alpha(Opacity=30); -moz-border-radius: 8px; -webkit-border-radius: 8px; }
\ No newline at end of file
diff --git a/auth/saml/roles.php b/auth/saml/roles.php
new file mode 100755
index 0000000..9cae022
--- /dev/null
+++ b/auth/saml/roles.php
@@ -0,0 +1,170 @@
+<?php
+
+function get_moodle_roles() {
+    $moodle_roles = array();
+    foreach (get_all_roles() as $role) {
+        $moodle_roles[] = $role->shortname;
+    }
+    return $moodle_roles;
+}
+
+function get_role_mapping(&$DB, &$err) {
+    $role_mapping = array();
+    $rs = $DB->get_records_select('role_mapping', '', null, '', '*', 0, 0);
+
+    if ($rs === false) {
+        $err['role_mapping_db'][] = get_string("auth_saml_error_executing_role_mapping_query", "auth_saml");
+    } else {
+        foreach ($rs as $role){
+            $role = array_change_key_case((array)$role,CASE_LOWER);
+            $role_mapping[$role['saml_role']] = $role['lms_role'];
+        }
+		unset($rs);
+		unset($saml_roles);
+    }
+    return $role_mapping;
+}
+
+
+function get_role_mapping_for_sync(&$err, $config) {
+
+    $role_mapping = array();
+    if($config->supportcourses == 'external') {
+        require_once ("DBNewConnection.php"); 
+        $DB_mapping = DBNewConnection($config->externalrolemappingdsn);
+        $rs = false;
+        if($DB_mapping) {
+            $DB_mapping->SetFetchMode(ADODB_FETCH_ASSOC);
+            $rs = $DB_mapping->Execute($config->externalrolemappingsql);
+            if($rs !==false) {
+                $saml_roles = $rs->GetAll();
+            }
+            $DB_mapping->Disconnect();
+        }
+    }
+    else {
+        global $DB;
+
+        $rs = $DB->get_records_select('role_mapping', '', null, '', '*', 0, 0);
+
+        if($rs !==false) {
+            $saml_roles = $rs;
+        }
+
+    }
+    if ($rs === false) {
+        $err['role_mapping_db'][] = get_string("auth_saml_error_executing_role_mapping_query", "auth_saml");
+    } else {
+
+        foreach ($saml_roles as $role){
+            $role = array_change_key_case((array)$role,CASE_LOWER);
+            if(empty($role['lms_role']) || empty($role['saml_role'])) {
+                $err['role_mapping_db'][] = "<p>" . get_string("auth_saml_error_attribute_role_mapping", "auth_saml") . "</p><p>saml_role: " . $role['saml_role'] . " lms_role: " . $role['lms_role'] . "</p>";
+            }
+            else {
+                if(isset($role_mapping[$role['saml_role']])) {
+                    $err['role_mapping_db'][] = get_string('auth_saml_duplicated_saml_data', "auth_saml").' saml_role:'.$role['saml_role'];
+                }
+                else {
+                    $role_mapping[$role['saml_role']] = $role['lms_role'];
+                }
+            }
+        }
+		unset($rs);
+		unset($saml_roles);
+    }
+    return $role_mapping;
+}
+
+
+function print_role_mapping_options($role_mapping, $config, $err) {
+    
+    if(isset($err['role_mapping_db'])) {
+        foreach ($err['role_mapping_db'] as $value) {
+            echo '<tr><td colspan="4" style="color: red;text-align:center">';
+            echo $value;
+            echo '</td></tr>';
+        }
+    }
+
+    if (array_key_exists('role_mapping', $err)) {
+        echo '<tr><td colspan="4" style="color: red;text-align:center">';
+        if (!empty($err['role_mapping']['saml'])) {
+            echo "<p>" . get_string("auth_saml_duplicated_saml_data", "auth_saml") . implode(', ', $err['role_mapping']['saml']) . "</p>";
+        }
+        if (!empty($err['role_mapping']['lms'])) {
+            echo get_string("auth_saml_duplicated_lms_data", "auth_saml") . implode(', ', $err['role_mapping']['lms']);
+        }	
+        echo '</td></tr>';
+    }
+
+    if (array_key_exists('missed_role_mapping', $err)) {
+        echo '<tr><td colspan="4" style="color: red;text-align:center">';
+        echo get_string("auth_saml_missed_data", "auth_saml") . implode(', ', array_unique($err['missed_role_mapping']));
+        echo '</td></tr>';
+    }
+
+    echo '<tr><td></td><td>Moodle Role</td><td>SAML Role</td></tr>';
+
+    //if this is a GET (no errors) only read the values from the database
+
+    $new_roles_total = optional_param('new_roles_total', FALSE, PARAM_INT);
+    $read_from_db_only = ($new_roles_total === FALSE);
+
+    //existing roles
+    $moodle_roles = get_moodle_roles();
+    foreach ($role_mapping as $saml_role => $mrole) {
+            $role_param = optional_param_array('role_' . $saml_role, array(), PARAM_ALPHANUMEXT);
+
+
+        	echo '<tr '.((isset($err['role_mapping']['lms']) && in_array($role_param[0], $err['role_mapping']['lms']))
+                || (isset($err['role_mapping']['saml']) && in_array($role_param[1], $err['role_mapping']['saml']))
+                || (isset($err['missed_role_mapping']) && array_key_exists($saml_role, $err['missed_role_mapping'])) ? 'style="background:red;"' : '').'>';
+            echo '<td><input style="margin-right: 20px;" type="checkbox" name="role_mapping_id[]" value="' . $saml_role . '">';
+            echo '<input type="hidden" name="update_roles_id[]" value="' . $saml_role . '"></td>';
+            echo '<td><select name="role_'. $saml_role .'[]" >';
+            foreach ($moodle_roles as $mrole2) {
+                echo '<option value="'. $mrole2 .'" '.((!$read_from_db_only && $role_param[0] == $mrole2) || ($read_from_db_only && $mrole2 == $mrole) ? 'selected="selected"' : '') .' >' . $mrole2 . '</option>';
+            }
+            echo '</select></td>';
+            $role_name = ($read_from_db_only ? $saml_role : $role_param[1]);
+            echo '<td><input type="text" name="role_'. $saml_role .'[]" value="' . $role_name . '" /></td>';
+		    echo '<td></td>';
+        	echo '</tr>';
+    }
+
+    //New roles
+    echo '<tr><td colspan="4"><hr /></td></tr>';
+    $i = 0;
+    if ($read_from_db_only) {
+
+        //we have a POST request
+        while ($i <= $new_roles_total) {
+            $new_role_param = optional_param_array('new_role_' . $i, array(), PARAM_ALPHANUMEXT);
+            if (!empty($new_role_param)) {
+
+	        echo '<tr '.(empty($new_role_param[1])? 'style="display:none;"': ((isset($err['role_mapping']['lms']) && in_array($new_role_param[0], $err['role_mapping']['lms'])) || (isset($err['role_mapping']['saml']) && in_array($new_role_param[1], $err['role_mapping']['saml'])) ? 'style="background:red;"' : '')) .'>';
+                echo '<td colspan="2" style="padding-left: 38px;"><select id="newrole_select_'. $i.'" name="new_role' . $i . '[]">';
+                foreach ($moodle_roles as $mrole) {
+                    $is_selected = $new_role_param[0] === $mrole; 
+                    echo '<option value="'. $mrole .'" ' . ($is_selected ? 'selected="selected"' : '') . ' >' . $mrole . '</option>';
+                }
+                echo '</select>';
+                echo '<td><input id="newrole_saml_id_'.$i.'" type="text" name="new_role' . $i . '[]" value="' . $new_role_param[1] . '" /></td>';
+	        echo '<td></td>';
+	        echo '</tr>';
+            }
+            $i++;
+        }
+    }
+
+    echo '<tr><td colspan="2" style="padding-left: 39px;"><select id="newrole_select_'.$i.'" name="new_role' . $i . '[]">';
+    foreach ($moodle_roles as $mrole) {
+        echo '<option value="' . $mrole . '"  >' . $mrole . '</option>';
+    }
+    echo '</select>';
+    echo '<input id="new_roles_total" type="hidden" name="new_roles_total" value="' . $i . '" /></td>';
+    echo '<td><input id="newrole_saml_id_'.$i.'" type="text" name="new_role' . $i . '[]" value="" />';
+    echo '<input type="button" name="new" value="+" onclick="addNewField(\'newroles\',\'new_role\',\'role\')" /></td></tr>';
+    echo '<td></td>';
+}
diff --git a/auth/saml/saml_config.php b/auth/saml/saml_config.php
new file mode 100755
index 0000000..8551fe3
--- /dev/null
+++ b/auth/saml/saml_config.php
@@ -0,0 +1 @@
+{"samllib":"\/var\/www\/apps\/moodle31\/simplesamlphp\/lib","sp_source":"default-sp","dosinglelogout":"on"}
diff --git a/auth/saml/utils.php b/auth/saml/utils.php
new file mode 100755
index 0000000..d97cbcb
--- /dev/null
+++ b/auth/saml/utils.php
@@ -0,0 +1,22 @@
+<?php
+
+/**
+ * Get the absolute path to the SAML hook file.
+ * 
+ * @global stdClass $CFG
+ * @param string $path
+ *   The path to the SAML hook file, either absolute or relative to the 
+ *   directory root.
+ * @return string
+ *   The absolute path to the hook file.
+ */
+function resolve_samlhookfile($path) {
+    global $CFG;
+
+    if (strpos($path, '/') !== 0 && strpos($path, '\\') !== 0) {
+        // This is a relative path because it doesn't with an / or an \.
+        $path = $CFG->dirroot . DIRECTORY_SEPARATOR . $path;
+    }
+
+    return $path;
+}
diff --git a/auth/saml/version.php b/auth/saml/version.php
new file mode 100755
index 0000000..cff60bc
--- /dev/null
+++ b/auth/saml/version.php
@@ -0,0 +1,7 @@
+<?php
+
+$plugin->version = 2017011901;
+$plugin->requires = 2012062500;
+$plugin->release = 'auth/saml version of 19-01-2017';
+$plugin->maturity = MATURITY_BETA;
+$plugin->component = 'auth_saml';
-- 
1.8.3.1

