From 7806ba6a8bc00aa58c489bf67373b5849f6b3d68 Mon Sep 17 00:00:00 2001
From: Nadav Kavalerchik <nadavkav@gmail.com>
Date: Mon, 16 Oct 2017 10:27:29 +0300
Subject: [PATCH 79/95] theme/fordson (patch) wip - customize course teacher
 dashboard

---
 theme/fordson/classes/output/core_renderer.php | 121 ++++++++++++--------
 theme/fordson/lang/en/theme_fordson.php        |   5 +-
 theme/fordson/templates/teacherdash.mustache   | 150 ++++++++++++++-----------
 3 files changed, 159 insertions(+), 117 deletions(-)

diff --git a/theme/fordson/classes/output/core_renderer.php b/theme/fordson/classes/output/core_renderer.php
index 4986eba..3018628 100755
--- a/theme/fordson/classes/output/core_renderer.php
+++ b/theme/fordson/classes/output/core_renderer.php
@@ -62,7 +62,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
     public function full_header() {
 
         global $PAGE, $COURSE;
-        
+
         $html = html_writer::start_tag('header', array('id' => 'page-header', 'class' => 'row'));
         $html .= html_writer::start_div('col-xs-12 p-a-1');
         $html .= html_writer::start_div('card');
@@ -105,7 +105,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
     public function headerimage() {
         global $CFG, $COURSE, $PAGE, $OUTPUT;
                 // Get course overview files.
-        
+
         if (empty($CFG->courseoverviewfileslimit)) {
             return '';
         }
@@ -182,7 +182,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $html .= html_writer::end_div();
 
         return $html;
-        
+
     }
 
 
@@ -234,9 +234,9 @@ class core_renderer extends \theme_boost\output\core_renderer {
             $branchlabel = $branchtitle;
             $branchurl   = new moodle_url('/my/index.php');
             $branchsort  = 10000;
- 
+
             $branch = $menu->add($branchlabel, $branchurl, $branchtitle, $branchsort);
-            
+
             if ($courses = enrol_get_my_courses(NULL, 'fullname ASC')) {
                 foreach ($courses as $course) {
                     if ($course->visible){
@@ -282,7 +282,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
 
         return $content;
     }
-        
+
 
     protected function render_thiscourse_menu(custom_menu $menu) {
         global $CFG;
@@ -310,7 +310,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
 
                 foreach ($data as $modname => $modfullname) {
                     if ($modname === 'resources') {
-                        
+
                         $branch->add($modfullname, new moodle_url('/course/resources.php', array('id' => $PAGE->course->id)));
                     } else {
 
@@ -318,7 +318,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
                                 array('id' => $PAGE->course->id)));
                     }
                 }
-                
+
         }
 
         return $this->render_thiscourse_menu($menu);
@@ -392,7 +392,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $hasslideicon   = (empty($PAGE->theme->settings->slideicon && isloggedin() && !isguestuser())) ? false : $PAGE->theme->settings->slideicon;
         $slideiconbuttonurl   = 'data-toggle="collapse" data-target="#collapseExample';
         $slideiconbuttontext   = (empty($PAGE->theme->settings->slideiconbuttontext)) ? false : $PAGE->theme->settings->slideiconbuttontext;
-        
+
         $hasnav1icon    = (empty($PAGE->theme->settings->nav1icon && isloggedin() && !isguestuser())) ? false : $PAGE->theme->settings->nav1icon;
         $hasnav2icon     = (empty($PAGE->theme->settings->nav2icon && isloggedin() && !isguestuser())) ? false : $PAGE->theme->settings->nav2icon;
         $hasnav3icon  = (empty($PAGE->theme->settings->nav3icon && isloggedin() && !isguestuser())) ? false : $PAGE->theme->settings->nav3icon;
@@ -401,7 +401,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $hasnav6icon      = (empty($PAGE->theme->settings->nav6icon && isloggedin() && !isguestuser())) ? false : $PAGE->theme->settings->nav6icon;
         $hasnav7icon        = (empty($PAGE->theme->settings->nav7icon && isloggedin() && !isguestuser())) ? false : $PAGE->theme->settings->nav7icon;
         $hasnav8icon   = (empty($PAGE->theme->settings->nav8icon && isloggedin() && !isguestuser())) ? false : $PAGE->theme->settings->nav8icon;
-        
+
         $nav1buttonurl   = (empty($PAGE->theme->settings->nav1buttonurl)) ? false : $PAGE->theme->settings->nav1buttonurl;
         $nav2buttonurl   = (empty($PAGE->theme->settings->nav2buttonurl)) ? false : $PAGE->theme->settings->nav2buttonurl;
         $nav3buttonurl   = (empty($PAGE->theme->settings->nav3buttonurl)) ? false : $PAGE->theme->settings->nav3buttonurl;
@@ -410,7 +410,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $nav6buttonurl   = (empty($PAGE->theme->settings->nav6buttonurl)) ? false : $PAGE->theme->settings->nav6buttonurl;
         $nav7buttonurl   = (empty($PAGE->theme->settings->nav7buttonurl)) ? false : $PAGE->theme->settings->nav7buttonurl;
         $nav8buttonurl   = (empty($PAGE->theme->settings->nav8buttonurl)) ? false : $PAGE->theme->settings->nav8buttonurl;
-        
+
         $nav1buttontext   = (empty($PAGE->theme->settings->nav1buttontext)) ? false : format_text($PAGE->theme->settings->nav1buttontext);
         $nav2buttontext   = (empty($PAGE->theme->settings->nav2buttontext)) ? false : format_text($PAGE->theme->settings->nav2buttontext);
         $nav3buttontext   = (empty($PAGE->theme->settings->nav3buttontext)) ? false : format_text($PAGE->theme->settings->nav3buttontext);
@@ -419,7 +419,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $nav6buttontext   = (empty($PAGE->theme->settings->nav6buttontext)) ? false : format_text($PAGE->theme->settings->nav6buttontext);
         $nav7buttontext   = (empty($PAGE->theme->settings->nav7buttontext)) ? false : format_text($PAGE->theme->settings->nav7buttontext);
         $nav8buttontext   = (empty($PAGE->theme->settings->nav8buttontext)) ? false : format_text($PAGE->theme->settings->nav8buttontext);
-        
+
         $fptextbox  = (empty($PAGE->theme->settings->fptextbox && isloggedin())) ? false : format_text($PAGE->theme->settings->fptextbox);
         $fptextboxlogout  = (empty($PAGE->theme->settings->fptextboxlogout && !isloggedin())) ? false : format_text($PAGE->theme->settings->fptextboxlogout);
         $slidetextbox  = (empty($PAGE->theme->settings->slidetextbox && isloggedin())) ? false : format_text($PAGE->theme->settings->slidetextbox);
@@ -431,7 +431,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $marketing1buttonurl  = (empty($PAGE->theme->settings->marketing1buttonurl)) ? false : $PAGE->theme->settings->marketing1buttonurl;
         $marketing1target  = (empty($PAGE->theme->settings->marketing1target)) ? false : $PAGE->theme->settings->marketing1target;
         $marketing1image = (empty($PAGE->theme->settings->marketing1image)) ? false : 'marketing1image';
-        
+
         $hasmarketing2  = (empty($PAGE->theme->settings->marketing2 && $PAGE->theme->settings->togglemarketing == 1)) ? false : format_text($PAGE->theme->settings->marketing2);
         $marketing2content  = (empty($PAGE->theme->settings->marketing2content)) ? false : format_text($PAGE->theme->settings->marketing2content);
         $marketing2buttontext  = (empty($PAGE->theme->settings->marketing2buttontext)) ? false : format_text($PAGE->theme->settings->marketing2buttontext);
@@ -451,7 +451,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $marketing4buttontext  = (empty($PAGE->theme->settings->marketing4buttontext)) ? false : format_text($PAGE->theme->settings->marketing4buttontext);
         $marketing4buttonurl  = (empty($PAGE->theme->settings->marketing4buttonurl)) ? false : $PAGE->theme->settings->marketing4buttonurl;
         $marketing4target  = (empty($PAGE->theme->settings->marketing4target)) ? false : $PAGE->theme->settings->marketing4target;
-        $marketing4image = (empty($PAGE->theme->settings->marketing4image)) ? false : 'marketing4image'; 
+        $marketing4image = (empty($PAGE->theme->settings->marketing4image)) ? false : 'marketing4image';
 
         $hasmarketing5  = (empty($PAGE->theme->settings->marketing5 && $PAGE->theme->settings->togglemarketing == 1)) ? false : format_text($PAGE->theme->settings->marketing5);
         $marketing5content  = (empty($PAGE->theme->settings->marketing5content)) ? false : format_text($PAGE->theme->settings->marketing5content);
@@ -467,7 +467,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $marketing6target  = (empty($PAGE->theme->settings->marketing6target)) ? false : $PAGE->theme->settings->marketing6target;
         $marketing6image = (empty($PAGE->theme->settings->marketing6image)) ? false : 'marketing6image';
 
-        
+
         $fp_wonderboxcontext = [
 
             'hasfptextbox' => (!empty($PAGE->theme->settings->fptextbox && isloggedin())),
@@ -514,8 +514,8 @@ class core_renderer extends \theme_boost\output\core_renderer {
             ),
 
         ];
-    
-        
+
+
         return $this->render_from_template('theme_fordson/fpwonderbox', $fp_wonderboxcontext);
 
     }
@@ -529,7 +529,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $marketing1buttonurl  = (empty($PAGE->theme->settings->marketing1buttonurl)) ? false : $PAGE->theme->settings->marketing1buttonurl;
         $marketing1target  = (empty($PAGE->theme->settings->marketing1target)) ? false : $PAGE->theme->settings->marketing1target;
         $marketing1image = (empty($PAGE->theme->settings->marketing1image)) ? false : 'marketing1image';
-        
+
         $hasmarketing2  = (empty($PAGE->theme->settings->marketing2 && $PAGE->theme->settings->togglemarketing == 2)) ? false : format_text($PAGE->theme->settings->marketing2);
         $marketing2content  = (empty($PAGE->theme->settings->marketing2content)) ? false : format_text($PAGE->theme->settings->marketing2content);
         $marketing2buttontext  = (empty($PAGE->theme->settings->marketing2buttontext)) ? false : format_text($PAGE->theme->settings->marketing2buttontext);
@@ -549,7 +549,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $marketing4buttontext  = (empty($PAGE->theme->settings->marketing4buttontext)) ? false : format_text($PAGE->theme->settings->marketing4buttontext);
         $marketing4buttonurl  = (empty($PAGE->theme->settings->marketing4buttonurl)) ? false : $PAGE->theme->settings->marketing4buttonurl;
         $marketing4target  = (empty($PAGE->theme->settings->marketing4target)) ? false : $PAGE->theme->settings->marketing4target;
-        $marketing4image = (empty($PAGE->theme->settings->marketing4image)) ? false : 'marketing4image'; 
+        $marketing4image = (empty($PAGE->theme->settings->marketing4image)) ? false : 'marketing4image';
 
         $hasmarketing5  = (empty($PAGE->theme->settings->marketing5 && $PAGE->theme->settings->togglemarketing == 2)) ? false : format_text($PAGE->theme->settings->marketing5);
         $marketing5content  = (empty($PAGE->theme->settings->marketing5content)) ? false : format_text($PAGE->theme->settings->marketing5content);
@@ -603,7 +603,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $slide3 = (empty($PAGE->theme->settings->slide3title)) ? false : format_text($PAGE->theme->settings->slide3title);
         $slide3content = (empty($PAGE->theme->settings->slide3content)) ? false : format_text($PAGE->theme->settings->slide3content);
         $showtext3 = (empty($PAGE->theme->settings->slide3title)) ? false : format_text($PAGE->theme->settings->slide3title);
-        
+
         $fp_slideshow = [
 
             'hasfpslideshow' => $slideshowon,
@@ -650,14 +650,14 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $haseditcog = $PAGE->theme->settings->courseeditingcog;
         $editcog = html_writer::div($this->context_header_settings_menu(), 'pull-xs-right context-header-settings-menu');
         $thiscourse = $this->thiscourse_menu();
-        $showincourseonly = isset($COURSE->id) && $COURSE->id > 1 && $PAGE->theme->settings->coursemanagementtoggle && isloggedin() && !isguestuser(); 
+        $showincourseonly = isset($COURSE->id) && $COURSE->id > 1 && $PAGE->theme->settings->coursemanagementtoggle && isloggedin() && !isguestuser();
         $globalhaseasyenrollment = enrol_get_plugin('easy');
         $coursehaseasyenrollment = '';
         if($globalhaseasyenrollment) {
             $coursehaseasyenrollment = $DB->record_exists('enrol', array('courseid' => $COURSE->id, 'enrol' => 'easy'));
             $easyenrollinstance = $DB->get_record('enrol', array('courseid' => $COURSE->id, 'enrol' => 'easy'));
         }
-        
+
         //link catagories
         $haspermission = has_capability('enrol/category:config', $context) && $PAGE->theme->settings->coursemanagementtoggle && isset($COURSE->id) && $COURSE->id > 1;
         $userlinks = get_string('userlinks', 'theme_fordson');
@@ -666,11 +666,13 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $qbankdesc = get_string('qbank_desc', 'theme_fordson');
         $badges = get_string('badges', 'theme_fordson');
         $badgesdesc = get_string('badges_desc', 'theme_fordson');
+        $grades = get_string('grades', 'theme_fordson');
+        $gradesdesc = get_string('grades_desc', 'theme_fordson');
         $coursemanage = get_string('coursemanage', 'theme_fordson');
         $coursemanagedesc = get_string('coursemanage_desc', 'theme_fordson');
         $coursemanagementmessage = (empty($PAGE->theme->settings->coursemanagementtextbox)) ? false : format_text($PAGE->theme->settings->coursemanagementtextbox);
         $studentdashboardtextbox = (empty($PAGE->theme->settings->studentdashboardtextbox)) ? false : format_text($PAGE->theme->settings->studentdashboardtextbox);
-        
+
         //user links
         if($coursehaseasyenrollment && isset($COURSE->id) && $COURSE->id > 1){
             $easycodetitle = get_string('header_coursecodes', 'enrol_easy');
@@ -686,9 +688,15 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $activitycompletionlink = new moodle_url('/report/progress/index.php', array('course' => $PAGE->course->id));
         $grouptitle = get_string('groups', 'group');
         $grouplink = new moodle_url('/group/index.php', array('id' => $PAGE->course->id));
+        $managemodulegroupstitle = get_string('editgroups', 'report_editgroups');
+        $managemodulegroupslink = new moodle_url('/report/editgroups/index.php', array('id' => $PAGE->course->id));
+        $managemoduledatestitle = get_string('editdates', 'report_editdates');
+        $managemoduledateslink = new moodle_url('/report/editdates/index.php', array('id' => $PAGE->course->id));
         $enrolmethodtitle = get_string('enrolmentinstances', 'enrol');
         $enrolmethodlink = new moodle_url('/enrol/instances.php', array('id' => $PAGE->course->id));
-        
+        $permissionstitle = get_string('permissions', 'role');
+        $permissionslink = new moodle_url('/admin/roles/permissions.php', array('contextid' => $context->id));
+
         //user reports
         $logstitle = get_string('logs', 'moodle');
         $logslink = new moodle_url('/report/log/index.php', array('id' => $PAGE->course->id));
@@ -708,7 +716,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $qimportlink = new moodle_url('/question/import.php', array('courseid' => $PAGE->course->id));
         $qexporttitle = get_string('export', 'question');
         $qexportlink = new moodle_url('/question/export.php', array('courseid' => $PAGE->course->id));
-        
+
         //manage course
         $courseadmintitle = get_string('courseadministration', 'moodle');
         $courseadminlink = new moodle_url('/course/admin.php', array('courseid' => $PAGE->course->id));
@@ -724,13 +732,13 @@ class core_renderer extends \theme_boost\output\core_renderer {
         $courseimportlink = new moodle_url('/backup/import.php', array('id' => $PAGE->course->id));
         $courseedittitle = get_string('editcoursesettings', 'moodle');
         $courseeditlink = new moodle_url('/course/edit.php', array('id' => $PAGE->course->id));
-        
+
         //badges
         $badgemanagetitle = get_string('managebadges', 'badges');
         $badgemanagelink = new moodle_url('/badges/index.php?type=2', array('id' => $PAGE->course->id));
         $badgeaddtitle = get_string('newbadge', 'badges');
         $badgeaddlink = new moodle_url('/badges/newbadge.php?type=2', array('id' => $PAGE->course->id));
-        
+
         //misc
         $recyclebintitle = get_string('pluginname', 'tool_recyclebin');
         $recyclebinlink = new moodle_url('/admin/tool/recyclebin/index.php', array('contextid' => $PAGE->context->id));
@@ -752,7 +760,7 @@ class core_renderer extends \theme_boost\output\core_renderer {
             ];
             $progresschart = $this->render_from_template('block_myoverview/progress-chart', $progresschartcontext);
             $gradeslinkstudent = new moodle_url('/grade/report/user/index.php', array('id' => $PAGE->course->id));
-            
+
 
             $hascourseinfogroup = array (
                 'title' => get_string('courseinfo', 'theme_fordson'),
@@ -823,11 +831,12 @@ class core_renderer extends \theme_boost\output\core_renderer {
             //permissionchecks for teacher access
             $hasquestionpermission = has_capability('moodle/question:add', $context);
             $hasbadgepermission = has_capability('moodle/badges:awardbadge', $context);
+            $hasgradepermission = has_capability('moodle/course:viewhiddenactivities', $context);
             $hascoursepermission = has_capability('moodle/backup:backupcourse', $context);
             $hasuserpermission = has_capability('moodle/course:viewhiddenactivities', $context);
             $hasgradebookshow = $PAGE->course->showgrades == 1 && $PAGE->theme->settings->showstudentgrades == 1;
             $hascompletionshow = $PAGE->course->enablecompletion == 1 && $PAGE->theme->settings->showstudentgrades == 1;
-            
+
 
         //send to template
         $dashlinks = [
@@ -846,6 +855,8 @@ class core_renderer extends \theme_boost\output\core_renderer {
         'qbankdesc' => $qbankdesc,
         'badgestitle' => $badges,
         'badgesdesc' => $badgesdesc,
+        'gradestitle' => $grades,
+        'gradesdesc' => $gradesdesc,
         'coursemanagetitle' => $coursemanage,
         'coursemanagedesc' => $coursemanagedesc,
         'coursemanagementmessage' =>$coursemanagementmessage,
@@ -861,7 +872,12 @@ class core_renderer extends \theme_boost\output\core_renderer {
         'mygradestext' => $mygradestext,
         'studentdashboardtextbox' => $studentdashboardtextbox,
         'hasteacherdash' => $hasteacherdash,
-        'teacherdash' =>array('hasquestionpermission' => $hasquestionpermission, 'hasbadgepermission' => $hasbadgepermission, 'hascoursepermission' => $hascoursepermission, 'hasuserpermission' => $hasuserpermission),
+        'teacherdash' =>array(
+            'hasquestionpermission' => $hasquestionpermission,
+            'hasbadgepermission' => $hasbadgepermission,
+            'hasgradepermission' => $hasgradepermission,
+            'hascoursepermission' => $hascoursepermission,
+            'hasuserpermission' => $hasuserpermission),
         'hasstudentdash' => $hasstudentdash,
         'hasgradebookshow' => $hasgradebookshow,
         'hascompletionshow' => $hascompletionshow,
@@ -869,31 +885,38 @@ class core_renderer extends \theme_boost\output\core_renderer {
         'studentcoursemanage' => $studentcoursemanage,
 
         'dashlinks' => array(
-                array('hasuserlinks' => $gradestitle, 'title' => $gradestitle, 'url' => $gradeslink),
+                //array('hasuserlinks' => $gradestitle, 'title' => $gradestitle, 'url' => $gradeslink),
                 array('hasuserlinks' => $enroltitle, 'title' => $enroltitle, 'url' => $enrollink),
                 array('hasuserlinks' => $participantstitle, 'title' => $participantstitle, 'url' => $participantslink),
-                array('hasuserlinks' => $activitycompletiontitle, 'title' => $activitycompletiontitle, 'url' => $activitycompletionlink),
+                //array('hasuserlinks' => $activitycompletiontitle, 'title' => $activitycompletiontitle, 'url' => $activitycompletionlink),
                 array('hasuserlinks' => $grouptitle, 'title' => $grouptitle, 'url' => $grouplink),
-                array('hasuserlinks' => $enrolmethodtitle, 'title' => $enrolmethodtitle, 'url' => $enrolmethodlink),
-                array('hasuserlinks' => $logstitle, 'title' => $logstitle, 'url' => $logslink),
-                array('hasuserlinks' => $livelogstitle, 'title' => $livelogstitle, 'url' => $livelogslink),
-                array('hasuserlinks' => $participationtitle, 'title' => $participationtitle, 'url' => $participationlink),
-                array('hasuserlinks' => $activitytitle, 'title' => $activitytitle, 'url' => $activitylink),
+                array('hasuserlinks' => $managemodulegroupstitle, 'title' => $managemodulegroupstitle, 'url' => $managemodulegroupslink),
+                //array('hasuserlinks' => $enrolmethodtitle, 'title' => $enrolmethodtitle, 'url' => $enrolmethodlink),
+                //array('hasuserlinks' => $logstitle, 'title' => $logstitle, 'url' => $logslink),
+                //array('hasuserlinks' => $livelogstitle, 'title' => $livelogstitle, 'url' => $livelogslink),
+                //array('hasuserlinks' => $participationtitle, 'title' => $participationtitle, 'url' => $participationlink),
+                //array('hasuserlinks' => $activitytitle, 'title' => $activitytitle, 'url' => $activitylink),
                 array('hasqbanklinks' => $qbanktitle, 'title' => $qbanktitle, 'url' => $qbanklink),
                 array('hasqbanklinks' => $qcattitle, 'title' => $qcattitle, 'url' => $qcatlink),
                 array('hasqbanklinks' => $qimporttitle, 'title' => $qimporttitle, 'url' => $qimportlink),
                 array('hasqbanklinks' => $qexporttitle, 'title' => $qexporttitle, 'url' => $qexportlink),
+                array('hascoursemanagelinks' => $managemoduledatestitle, 'title' => $managemoduledatestitle, 'url' => $managemoduledateslink),
                 array('hascoursemanagelinks' => $courseedittitle, 'title' => $courseedittitle, 'url' => $courseeditlink),
-                array('hascoursemanagelinks' => $coursecompletiontitle, 'title' => $coursecompletiontitle, 'url' => $coursecompletionlink),
-                array('hascoursemanagelinks' => $courseadmintitle, 'title' => $courseadmintitle, 'url' => $courseadminlink),
-                array('hascoursemanagelinks' => $courseresettitle, 'title' => $courseresettitle, 'url' => $courseresetlink),
-                array('hascoursemanagelinks' => $coursebackuptitle, 'title' => $coursebackuptitle, 'url' => $coursebackuplink),
-                array('hascoursemanagelinks' => $courserestoretitle, 'title' => $courserestoretitle, 'url' => $courserestorelink),
-                array('hascoursemanagelinks' => $courseimporttitle, 'title' => $courseimporttitle, 'url' => $courseimportlink),
-                array('hascoursemanagelinks' => $recyclebintitle, 'title' => $recyclebintitle, 'url' => $recyclebinlink),
-                array('hascoursemanagelinks' => $filtertitle, 'title' => $filtertitle, 'url' => $filterlink),
-                array('hasbadgelinks' => $badgemanagetitle, 'title' => $badgemanagetitle, 'url' => $badgemanagelink),
-                array('hasbadgelinks' => $badgeaddtitle, 'title' => $badgeaddtitle, 'url' => $badgeaddlink),
+                array('hascoursemanagelinks' => $enrolmethodtitle, 'title' => $enrolmethodtitle, 'url' => $enrolmethodlink),
+                array('hascoursemanagelinks' => $permissionstitle, 'title' => $permissionstitle, 'url' => $permissionslink),
+                // todo: reports
+//                array('hascoursemanagelinks' => $coursecompletiontitle, 'title' => $coursecompletiontitle, 'url' => $coursecompletionlink),
+//                array('hascoursemanagelinks' => $courseadmintitle, 'title' => $courseadmintitle, 'url' => $courseadminlink),
+//                array('hascoursemanagelinks' => $courseresettitle, 'title' => $courseresettitle, 'url' => $courseresetlink),
+//                array('hascoursemanagelinks' => $coursebackuptitle, 'title' => $coursebackuptitle, 'url' => $coursebackuplink),
+//                array('hascoursemanagelinks' => $courserestoretitle, 'title' => $courserestoretitle, 'url' => $courserestorelink),
+//                array('hascoursemanagelinks' => $courseimporttitle, 'title' => $courseimporttitle, 'url' => $courseimportlink),
+//                array('hascoursemanagelinks' => $recyclebintitle, 'title' => $recyclebintitle, 'url' => $recyclebinlink),
+//                array('hascoursemanagelinks' => $filtertitle, 'title' => $filtertitle, 'url' => $filterlink),
+                //array('hasbadgelinks' => $badgemanagetitle, 'title' => $badgemanagetitle, 'url' => $badgemanagelink),
+                //array('hasbadgelinks' => $badgeaddtitle, 'title' => $badgeaddtitle, 'url' => $badgeaddlink),
+                array('hasgradelinks' => $gradestitle, 'title' => $gradestitle, 'url' => $gradeslink),
+                array('hasgradelinks' => $activitycompletiontitle, 'title' => $activitycompletiontitle, 'url' => $activitycompletionlink),
             ),
         ];
 
@@ -901,9 +924,9 @@ class core_renderer extends \theme_boost\output\core_renderer {
         if ($globalhaseasyenrollment && $coursehaseasyenrollment) {
             $dashlinks['dashlinks'][] = array('haseasyenrollment' => $coursehaseasyenrollment, 'title' => $easycodetitle, 'url' => $easycodelink);
 
-        } 
+        }
             return $this->render_from_template('theme_fordson/teacherdash', $dashlinks );
-        
+
     }
 
     public function footnote() {
diff --git a/theme/fordson/lang/en/theme_fordson.php b/theme/fordson/lang/en/theme_fordson.php
index 7c50420..51472dd 100755
--- a/theme/fordson/lang/en/theme_fordson.php
+++ b/theme/fordson/lang/en/theme_fordson.php
@@ -246,6 +246,8 @@ $string['qbank'] = 'Question Bank';
 $string['qbank_desc'] = 'Create and organize quiz questions';
 $string['badges'] = 'Badges';
 $string['badges_desc'] = 'Award your students';
+$string['grades'] = 'Grades';
+$string['grades_desc'] = 'Grades and activity completion';
 $string['coursemanage'] = 'Course Settings';
 $string['coursemanage_desc'] = 'Manage your entire course';
 $string['coursemanagementbutton'] = 'Course Management';
@@ -463,4 +465,5 @@ $string['nosyllabus'] = 'No syllabus for this course (Please ask the teacher to
 $string['syllabus'] = 'Syllabus';
 $string['mytimetable'] = 'My Timetable';
 $string['noclasses'] = 'No information available, please ask your teachers for updates.';
-$string['teachers'] = 'Teachers';
\ No newline at end of file
+$string['teachers'] = 'Teachers';
+$string['mycoursesfilter_settings'] = 'My courses filter';
\ No newline at end of file
diff --git a/theme/fordson/templates/teacherdash.mustache b/theme/fordson/templates/teacherdash.mustache
index 1a770a5..925bd0d 100755
--- a/theme/fordson/templates/teacherdash.mustache
+++ b/theme/fordson/templates/teacherdash.mustache
@@ -5,7 +5,7 @@
     <div class="editcogbutton">{{{editcog}}}</div>
     {{/haseditcog}}
 
-    {{#hasteacherdash}} 
+    {{#hasteacherdash}}
     <div class="teacherdashbutton"><a role="button" data-toggle="collapse" href="#teacherdashslider" aria-expanded="false" aria-controls="teacherdashslider">{{{togglebutton}}}</a></div>
     {{/hasteacherdash}}
 
@@ -32,83 +32,99 @@
     <div class="row">
 
         <div class="col-md-3 activities">
-        <div class="dashtitle">
-            <h3 class="card-title"><i class="fa fa-check-square-o dashicon"></i>{{{activitylinkstitle}}}</h3>
-            <p>{{{activitylinkstitle_desc}}}</p>   
-        </div>
-        <div class="list-group">
-        {{{thiscourse}}}
-        </div>
+            <div class="dashtitle">
+                <h3 class="card-title"><i class="fa fa-check-square-o dashicon"></i>{{{activitylinkstitle}}}</h3>
+                <p>{{{activitylinkstitle_desc}}}</p>
+            </div>
+            <div class="list-group">
+            {{{thiscourse}}}
+            </div>
         </div>
 
         <div class="col-md-3 questionlinks">
-        {{#hasquestionpermission}}
-        <div class="dashtitle">
-            <h3><i class="fa fa-question-circle dashicon"></i>{{{qbanktitle}}}</h3>
-            <p>{{{qbankdesc}}}</p>
-        </div>
-        <div class="list-group">
-            {{#dashlinks}}
-            {{#hasqbanklinks}}
-                <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
-            {{/hasqbanklinks}}
-            {{/dashlinks}}
-        </div>
-        {{/hasquestionpermission}}
-        {{#hasbadgepermission}}
-        <div class="dashtitle">
-            <h3><i class="fa fa-trophy dashicon"></i>{{{badgestitle}}}</h3>
-            <p>{{{badgesdesc}}}</p>
-        </div>
-        <div class="list-group">
-            {{#dashlinks}}
-            {{#hasbadgelinks}}
-                <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
-            {{/hasbadgelinks}}
-            {{/dashlinks}}
-        </div>
-        {{/hasbadgepermission}}
+            {{#hasquestionpermission}}
+            <div class="dashtitle">
+                <h3><i class="fa fa-question-circle dashicon"></i>{{{qbanktitle}}}</h3>
+                <p>{{{qbankdesc}}}</p>
+            </div>
+            <div class="list-group">
+                {{#dashlinks}}
+                {{#hasqbanklinks}}
+                    <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
+                {{/hasqbanklinks}}
+                {{/dashlinks}}
+            </div>
+            {{/hasquestionpermission}}
+            <!--
+            {{#hasbadgepermission}}
+            <div class="dashtitle">
+                <h3><i class="fa fa-trophy dashicon"></i>{{{badgestitle}}}</h3>
+                <p>{{{badgesdesc}}}</p>
+            </div>
+            <div class="list-group">
+                {{#dashlinks}}
+                {{#hasbadgelinks}}
+                    <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
+                {{/hasbadgelinks}}
+                {{/dashlinks}}
+            </div>
+            {{/hasbadgepermission}}
+            -->
         </div>
 
         {{#hascoursepermission}}
         <div class="col-md-3 coursemanagelinks">
-        <div class="dashtitle">
-            <h3><i class="fa fa-cogs dashicon"></i>{{{coursemanagetitle}}}</h3>
-            <p>{{{coursemanagedesc}}}</p>
-        </div>
-        <div class="list-group">
-            {{#dashlinks}}
-            {{#hascoursemanagelinks}}
-                <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
-            {{/hascoursemanagelinks}}
-            {{/dashlinks}}
-        </div>
+            <div class="dashtitle">
+                <h3><i class="fa fa-cogs dashicon"></i>{{{coursemanagetitle}}}</h3>
+                <p>{{{coursemanagedesc}}}</p>
+            </div>
+            <div class="list-group">
+                {{#dashlinks}}
+                {{#hascoursemanagelinks}}
+                    <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
+                {{/hascoursemanagelinks}}
+                {{/dashlinks}}
+            </div>
         </div>
         {{/hascoursepermission}}
 
         {{#hasuserpermission}}
         <div class="col-md-3 userlinks">
-        <div class="dashtitle">
-            <h3><i class="fa fa-users dashicon"></i>{{{userlinkstitle}}}</h3>
-            <p>{{{userlinksdesc}}}</p>
-        </div>
-        <div class="list-group">
-
-            {{#haspermission}}
-            {{#dashlinks}}
-            {{#haseasyenrollment}}
-                <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
-            {{/haseasyenrollment}}
-            {{/dashlinks}}
-            {{/haspermission}}
-            {{#dashlinks}}
-            {{#hasuserlinks}}
-                <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
-            {{/hasuserlinks}}
-            {{/dashlinks}}
-        </div>
+            <div class="dashtitle">
+                <h3><i class="fa fa-users dashicon"></i>{{{userlinkstitle}}}</h3>
+                <p>{{{userlinksdesc}}}</p>
+            </div>
+            <div class="list-group">
+                {{#haspermission}}
+                {{#dashlinks}}
+                {{#haseasyenrollment}}
+                    <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
+                {{/haseasyenrollment}}
+                {{/dashlinks}}
+                {{/haspermission}}
+                {{#dashlinks}}
+                {{#hasuserlinks}}
+                    <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
+                {{/hasuserlinks}}
+                {{/dashlinks}}
+            </div>
         </div>
         {{/hasuserpermission}}
+        {{#hasgradepermission}}
+        <div class="col-md-3 gradelinks">
+            <div class="dashtitle">
+                <h3><i class="fa fa-trophy dashicon"></i>{{{gradestitle}}}</h3>
+                <p>{{{gradesdesc}}}</p>
+            </div>
+            <div class="list-group">
+                {{#dashlinks}}
+                    {{#hasgradelinks}}
+                        <a href="{{{url}}}" class="list-group-item">{{{title}}}</a>
+                    {{/hasgradelinks}}
+                {{/dashlinks}}
+            </div>
+        </div>
+        {{/hasgradepermission}}
 
     </div>
     </div>
@@ -125,7 +141,7 @@
 <div class="container-fluid">
 
     <div class="row">
-    
+
         {{#studentdashboardtextbox}}
         <div class="col-md-6">
             <div class="studentdashboardtextbox">{{{studentdashboardtextbox}}}</div>
@@ -153,7 +169,7 @@
         </div>
         {{/studentcourseadminlink}}
 
-        
+
 
     </div>
 
@@ -208,7 +224,7 @@
 
         <div class="col-md-3 activitylinks">
             <div class="dashtitle">
-                <h3><i class="fa fa-check-square-o dashicon"></i>{{{activitylinkstitle}}}</h3>     
+                <h3><i class="fa fa-check-square-o dashicon"></i>{{{activitylinkstitle}}}</h3>
             </div>
             <div class="list-group">
                 {{{thiscourse}}}
-- 
1.8.3.1

